{"version":3,"file":"44.lVPvJVm3.js","sources":["../../../../../../src/routes/(wallet)/lock/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { browserSvelte } from '$lib/common/environment';\n\timport { goto } from '$app/navigation';\n\timport {\n\t\tsetMiscStore,\n\t\tyakklCurrentlySelectedStore,\n\t\tyakklSettingsStore\n\t} from '$lib/common/stores';\n\timport { PATH_LOGOUT } from '$lib/common/constants';\n\n\timport type { Settings, YakklCurrentlySelected } from '$lib/common/interfaces';\n\timport { setIconLock } from '$lib/utilities';\n\timport { setLocks } from '$lib/common/locks';\n\t// import { removeTimers } from '$lib/common/timers';\n\t// import { removeListeners } from '$lib/common/listeners';\n\t// import { timerManager } from '$lib/managers/TimerManager';\n\timport { log } from '$lib/common/logger-wrapper';\n\t// import { resetTokenDataStoreValues } from '$lib/common/resetTokenDataStoreValues';\n\n\t// Reactive State\n\tlet yakklCurrentlySelected: YakklCurrentlySelected | null = $state(null);\n\tlet yakklSettings: Settings | null = $state(null);\n\n\t$effect(() => {\n\t\tyakklCurrentlySelected = $yakklCurrentlySelectedStore;\n\t});\n\t$effect(() => {\n\t\tyakklSettings = $yakklSettingsStore;\n\t});\n\n\tlet isUpdating = false;\n\n\tasync function update() {\n\t\tif (isUpdating) return;\n\t\tisUpdating = true;\n\n\t\ttry {\n\t\t\tif (browserSvelte) {\n\t\t\t\t// Update lock icon\n\t\t\t\tawait setIconLock();\n\t\t\t\tawait setLocks(true);\n\n\t\t\t\tsetMiscStore('');\n\n\t\t\t\t// For security reasons, we force a logout. If the customer wants to continue, they must log in again.\n\t\t\t\tgoto(PATH_LOGOUT);\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tlog.error('Locking error:', e, e?.stack);\n\t\t\tif (browserSvelte) {\n\t\t\t\ttry {\n\t\t\t\t\tgoto(PATH_LOGOUT);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tlog.error('Navigation to logout failed:', false, error);\n\t\t\t\t}\n\t\t\t}\n\t\t} finally {\n\t\t\tisUpdating = false; // Release the lock\n\t\t}\n\t}\n\n\t(async () => {\n\t\tif (typeof browserSvelte !== 'undefined' && browserSvelte) {\n\t\t\tawait update();\n\t\t}\n\t})();\n</script>\n"],"names":["yakklCurrentlySelected","$.tag","$.state","yakklSettings","$.user_effect","set","$yakklCurrentlySelectedStore","$yakklSettingsStore","isUpdating","update","browserSvelte","setIconLock","setLocks","setMiscStore","goto","PATH_LOGOUT","e","log","error","stack","$.strict_equals"],"mappings":"qxCAoBK,IAAAA,uBAAAC,IAAAC,MAA+D,MAAI,0BACnE,IAAAC,cAAAF,IAAAC,MAAwC,MAAI,iBAEhDE,YAAc,KACbC,IAAAL,uBAAyBM,+BAAA,QAE1BF,YAAc,KACbC,IAAAF,cAAgBI,sBAAA,YAGbC,WAAa,qBAEFC,SACV,GAAAD,WAAA,OACSA,WAAA,KAET,OACCE,cAAe,OAEZC,oBACAC,SAAS,MAEfC,aAAa,IAGbC,KAAKC,YACN,CACD,OAASC,GACRC,IAAIC,MAAM,iBAAkBF,EAAGA,GAAA,UAAA,EAAAA,EAAGG,UAC9BT,cAAe,CACd,IACHI,KAAKC,YACN,OAASG,OACJD,IAAAC,MAAM,+BAAgC,MAAOA,MAClD,CACD,EACC,QACYV,WAAA,KACd,CACD,CAEa,WACD,GAAAY,qBAAAV,cAAkB,oBAAeA,cAAe,OACpDD,QACP,CACD,EAJa"}