import{K as create_text,V as block,aF as EACH_IS_CONTROLLED,y as set_hydrate_node,M as hydrating,q as get_first_child,z as hydrate_next,g as get,k as derived_safe_equal,X as read_hydration_instruction,P as HYDRATION_START_ELSE,Y as remove_nodes,x as set_hydrating,A as hydrate_node,B as HYDRATION_END,Z as resume_effect,L as branch,_ as pause_effect,aG as INERT,I as array_from,a8 as queue_micro_task,O as active_effect,aH as EACH_ITEM_REACTIVE,aI as internal_set,aJ as EACH_INDEX_REACTIVE,m as mutable_source,af as source,aK as is_array,aL as EACH_IS_ANIMATED,aM as pause_children,E as clear_text_content,aN as run_out_transitions,a4 as destroy_effect,aO as EACH_ITEM_IMMUTABLE,v as get_next_sibling}from"./BaS8d5lg.js";function index(_,i){return i}function pause_effects(state,items,controlled_anchor,items_map){var transitions=[];var length=items.length;for(var i=0;i<length;i++){pause_children(items[i].e,transitions,true)}var is_controlled=length>0&&transitions.length===0&&controlled_anchor!==null;if(is_controlled){var parent_node=controlled_anchor.parentNode;clear_text_content(parent_node);parent_node.append(controlled_anchor);items_map.clear();link(state,items[0].prev,items[length-1].next)}run_out_transitions(transitions,()=>{for(var i2=0;i2<length;i2++){var item=items[i2];if(!is_controlled){items_map.delete(item.k);link(state,item.prev,item.next)}destroy_effect(item.e,!is_controlled)}})}function each(node,flags,get_collection,get_key,render_fn,fallback_fn=null){var anchor=node;var state={flags:flags,items:new Map,first:null};var is_controlled=(flags&EACH_IS_CONTROLLED)!==0;if(is_controlled){var parent_node=node;anchor=hydrating?set_hydrate_node(get_first_child(parent_node)):parent_node.appendChild(create_text())}if(hydrating){hydrate_next()}var fallback=null;var was_empty=false;var each_array=derived_safe_equal(()=>{var collection=get_collection();return is_array(collection)?collection:collection==null?[]:array_from(collection)});block(()=>{var array=get(each_array);var length=array.length;if(was_empty&&length===0){return}was_empty=length===0;let mismatch=false;if(hydrating){var is_else=read_hydration_instruction(anchor)===HYDRATION_START_ELSE;if(is_else!==(length===0)){anchor=remove_nodes();set_hydrate_node(anchor);set_hydrating(false);mismatch=true}}if(hydrating){var prev=null;var item;for(var i=0;i<length;i++){if(hydrate_node.nodeType===8&&hydrate_node.data===HYDRATION_END){anchor=hydrate_node;mismatch=true;set_hydrating(false);break}var value=array[i];var key=get_key(value,i);item=create_item(hydrate_node,state,prev,null,value,key,i,render_fn,flags,get_collection);state.items.set(key,item);prev=item}if(length>0){set_hydrate_node(remove_nodes())}}if(!hydrating){reconcile(array,state,anchor,render_fn,flags,get_key,get_collection)}if(fallback_fn!==null){if(length===0){if(fallback){resume_effect(fallback)}else{fallback=branch(()=>fallback_fn(anchor))}}else if(fallback!==null){pause_effect(fallback,()=>{fallback=null})}}if(mismatch){set_hydrating(true)}get(each_array)});if(hydrating){anchor=hydrate_node}}function reconcile(array,state,anchor,render_fn,flags,get_key,get_collection){var _a,_b,_c,_d;var is_animated=(flags&EACH_IS_ANIMATED)!==0;var should_update=(flags&(EACH_ITEM_REACTIVE|EACH_INDEX_REACTIVE))!==0;var length=array.length;var items=state.items;var first=state.first;var current=first;var seen;var prev=null;var to_animate;var matched=[];var stashed=[];var value;var key;var item;var i;if(is_animated){for(i=0;i<length;i+=1){value=array[i];key=get_key(value,i);item=items.get(key);if(item!==void 0){(_a=item.a)==null?void 0:_a.measure();(to_animate??(to_animate=new Set)).add(item)}}}for(i=0;i<length;i+=1){value=array[i];key=get_key(value,i);item=items.get(key);if(item===void 0){var child_anchor=current?current.e.nodes_start:anchor;prev=create_item(child_anchor,state,prev,prev===null?state.first:prev.next,value,key,i,render_fn,flags,get_collection);items.set(key,prev);matched=[];stashed=[];current=prev.next;continue}if(should_update){update_item(item,value,i,flags)}if((item.e.f&INERT)!==0){resume_effect(item.e);if(is_animated){(_b=item.a)==null?void 0:_b.unfix();(to_animate??(to_animate=new Set)).delete(item)}}if(item!==current){if(seen!==void 0&&seen.has(item)){if(matched.length<stashed.length){var start=stashed[0];var j;prev=start.prev;var a=matched[0];var b=matched[matched.length-1];for(j=0;j<matched.length;j+=1){move(matched[j],start,anchor)}for(j=0;j<stashed.length;j+=1){seen.delete(stashed[j])}link(state,a.prev,b.next);link(state,prev,a);link(state,b,start);current=start;prev=b;i-=1;matched=[];stashed=[]}else{seen.delete(item);move(item,current,anchor);link(state,item.prev,item.next);link(state,item,prev===null?state.first:prev.next);link(state,prev,item);prev=item}continue}matched=[];stashed=[];while(current!==null&&current.k!==key){if((current.e.f&INERT)===0){(seen??(seen=new Set)).add(current)}stashed.push(current);current=current.next}if(current===null){continue}item=current}matched.push(item);prev=item;current=item.next}if(current!==null||seen!==void 0){var to_destroy=seen===void 0?[]:array_from(seen);while(current!==null){if((current.e.f&INERT)===0){to_destroy.push(current)}current=current.next}var destroy_length=to_destroy.length;if(destroy_length>0){var controlled_anchor=(flags&EACH_IS_CONTROLLED)!==0&&length===0?anchor:null;if(is_animated){for(i=0;i<destroy_length;i+=1){(_c=to_destroy[i].a)==null?void 0:_c.measure()}for(i=0;i<destroy_length;i+=1){(_d=to_destroy[i].a)==null?void 0:_d.fix()}}pause_effects(state,to_destroy,controlled_anchor,items)}}if(is_animated){queue_micro_task(()=>{var _a2;if(to_animate===void 0)return;for(item of to_animate){(_a2=item.a)==null?void 0:_a2.apply()}})}active_effect.first=state.first&&state.first.e;active_effect.last=prev&&prev.e}function update_item(item,value,index2,type){if((type&EACH_ITEM_REACTIVE)!==0){internal_set(item.v,value)}if((type&EACH_INDEX_REACTIVE)!==0){internal_set(item.i,index2)}else{item.i=index2}}function create_item(anchor,state,prev,next,value,key,index2,render_fn,flags,get_collection){var reactive=(flags&EACH_ITEM_REACTIVE)!==0;var mutable=(flags&EACH_ITEM_IMMUTABLE)===0;var v=reactive?mutable?mutable_source(value,false,false):source(value):value;var i=(flags&EACH_INDEX_REACTIVE)===0?index2:source(index2);if(reactive){v.trace=()=>{var collection_index=typeof i==="number"?index2:i.v;get_collection()[collection_index]}}var item={i:i,v:v,k:key,a:null,e:null,prev:prev,next:next};try{item.e=branch(()=>render_fn(anchor,v,i,get_collection),hydrating);item.e.prev=prev&&prev.e;item.e.next=next&&next.e;if(prev===null){state.first=item}else{prev.next=item;prev.e.next=item.e}if(next!==null){next.prev=item;next.e.prev=item.e}return item}finally{}}function move(item,next,anchor){var end=item.next?item.next.e.nodes_start:anchor;var dest=next?next.e.nodes_start:anchor;var node=item.e.nodes_start;while(node!==end){var next_node=get_next_sibling(node);dest.before(node);node=next_node}}function link(state,prev,next){if(prev===null){state.first=next}else{prev.next=next;prev.e.next=next&&next.e}if(next!==null){next.prev=prev;next.e.prev=prev&&prev.e}}export{each as e,index as i};
//# sourceMappingURL=DraJ8LN-.js.map
