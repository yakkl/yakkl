var __defProp=Object.defineProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value:value}):obj[key]=value;var __publicField=(obj,key,value)=>__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);import{c as check_target,l as legacy_api}from"./BXFaAXnq.js";import{p as push,a as pop,F as FILENAME,c as child,s as sibling,r as reset,t as template_effect,aC as tag_proxy,ae as proxy,h as tag,ay as user_effect,e as set,g as get,ak as update,f as first_child,u as user_derived,i as state,b as strict_equals,j as next}from"./BaS8d5lg.js";import{a as add_locations}from"./3AhEABF_.js";import{s as set_text}from"./Cmwrv3PW.js";import{c as create_ownership_validator}from"./COgMMZ9C.js";import{i as if_block}from"./Q1yPWpQ-.js";import{f as from_html,a as append}from"./Cm3jf07C.js";import{w as wrap_snippet}from"./d5hrMixo.js";import{d as delegate,b as apply}from"./DiU70Is3.js";import{s as set_style}from"./D1JcdFy3.js";import{p as prop}from"./BYboeQtC.js";import{a as store_get,s as setup_stores}from"./CViNpZsE.js";import{v as validate_store}from"./Dv9a3G0k.js";import{c as createForm}from"./CEKklR__.js";import"./Doq7snb5.js";import{c as create$3,a as create$6}from"./B4Ku5_Cd.js";import{M as Modal}from"./UU1vCwIM.js";import{L as Login}from"./BjtG3ltR.js";import{c as checkRegistrationStatus,i as isUserLoggedIn,R as RegistrationPrompt}from"./BkHOZpS2.js";import{v as getProfile,g as getSettings,x as isEncryptedData,z as decryptData,ab as dateString,S as PromoClassificationType,A as AccessSourceType,n as PlanType,R as encryptData,am as setProfileStorage,u as setSettingsStorage,b8 as FOUNDING_MEMBER_DEADLINE,b9 as EARLY_ADOPTER_DEADLINES,E as getContextTypeStore,H as yakklMiscStore}from"./Cb2naUpm.js";import{l as log}from"./WDN37msH.js";import{E as ErrorNoAction}from"./2Ogrppv5.js";import{C as Confirmation}from"./BWiVuumU.js";import{s as safeLogout}from"./COpD6KvM.js";import{c as canUpgrade}from"./BgnL0Zd7.js";import"./CgCfpVku.js";import{a as authStore,i as isAuthenticated}from"./DmxAnVWO.js";import{a as AuthLoading,A as AuthError}from"./CN9x-apg.js";import{c as closeModal}from"./CZPMS86D.js";Notification[FILENAME]="src/lib/components/Notification.svelte";function handleClose(_,show,onClose){show(false);setTimeout(()=>{onClose()()},10)}var root_1=add_locations(from_html(`<div class="p-6"><div class="flex items-center mb-4"><div class="flex-shrink-0"><svg class="w-6 h-6 text-gray-400" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"></path></svg></div> <div class="ml-3"><p class="text-sm text-gray-500"> </p></div></div> <div class="mt-4 flex justify-end"><button type="button" class="rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Close</button></div></div>`),Notification[FILENAME],[[18,1,[[19,2,[[20,3,[[21,4,[[28,5]]]]],[33,3,[[34,4]]]]],[37,2,[[38,3]]]]]]);function Notification($$anchor,$$props){check_target(new.target);push($$props,true,Notification);var $$ownership_validator=create_ownership_validator($$props);let show=prop($$props,"show",15,false),title=prop($$props,"title",3,"Notification"),message=prop($$props,"message",3,""),onClose=prop($$props,"onClose",3,()=>safeLogout());{$$ownership_validator.binding("show",Modal,show);Modal($$anchor,{get title(){return title()},get show(){return show()},set show($$value){show($$value)},children:wrap_snippet(Notification,($$anchor2,$$slotProps)=>{var div=root_1();var div_1=child(div);var div_2=sibling(child(div_1),2);var p=child(div_2);var text=child(p,true);reset(p);reset(div_2);reset(div_1);var div_3=sibling(div_1,2);var button=child(div_3);button.__click=[handleClose,show,onClose];reset(div_3);reset(div);template_effect(()=>set_text(text,message()));append($$anchor2,div)}),$$slots:{default:true}})}return pop({...legacy_api()})}delegate(["click"]);const _UpgradeManager=class _UpgradeManager{constructor(){__publicField(this,"messagePort",null);__publicField(this,"upgradeTimeout",3e4);__publicField(this,"maxRetries",3);__publicField(this,"currentUpgradeId",null);__publicField(this,"messageHandlers",new Map);this.initializeMessagePort()}static getInstance(){if(!_UpgradeManager.instance){_UpgradeManager.instance=new _UpgradeManager}return _UpgradeManager.instance}initializeMessagePort(){}async processUpgrade(request){try{this.currentUpgradeId=`upgrade-${Date.now()}`;this.sendMessage({type:"UPGRADE_STARTED"});const profile=await getProfile();const settings=await getSettings();if(!profile||!settings){throw new Error("Profile or settings not found")}this.sendMessage({type:"UPGRADE_PROGRESS",progress:25,status:"Preparing upgrade data..."});const response=await this.makeApiCall(request);if(!response.success){throw new Error(response.error||"Upgrade failed")}this.sendMessage({type:"UPGRADE_PROGRESS",progress:75,status:"Updating local data..."});if(isEncryptedData(profile.data)){const decryptedData=await decryptData(profile.data,request.encryptionKey);decryptedData.registered={...decryptedData.registered,plan:{type:PlanType.YAKKL_PRO,source:AccessSourceType.SUBSCRIBED,promo:PromoClassificationType.NONE,trialEndDate:"",upgradeDate:""},key:response.customerId||`PRO-${dateString()}`,updateDate:dateString()};profile.data=await encryptData(decryptedData,request.encryptionKey)}settings.plan={type:PlanType.YAKKL_PRO,source:AccessSourceType.SUBSCRIBED,promo:PromoClassificationType.NONE,trialEndDate:"",upgradeDate:""};settings.upgradeDate=dateString();settings.updateDate=dateString();await setProfileStorage(profile);await setSettingsStorage(settings);this.sendMessage({type:"UPGRADE_COMPLETED",data:{success:true,customerId:response.customerId,upgradeDate:dateString()}})}catch(error){log.error("Error in upgrade process:",false,error);this.sendMessage({type:"UPGRADE_ERROR",error:error instanceof Error?error.message:"An error occurred during upgrade"})}}async makeApiCall(request){let retries=0;while(retries<this.maxRetries){try{const controller=new AbortController;const timeoutId=setTimeout(()=>controller.abort(),this.upgradeTimeout);const response=await fetch("https://api.yakkl.com/wallet/upgrade",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(request),signal:controller.signal});clearTimeout(timeoutId);if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`)}const data=await response.json();return{success:true,customerId:data.customerId,upgradeDate:data.upgradeDate}}catch(error){retries++;if(retries===this.maxRetries){throw error}await new Promise(resolve=>setTimeout(resolve,Math.pow(2,retries)*1e3))}}throw new Error("Max retries exceeded")}sendMessage(message){this.messageHandlers.forEach(handler=>handler(message))}registerMessageHandler(handler){const id=Math.random().toString(36).substr(2,9);this.messageHandlers.set(id,handler);return()=>this.messageHandlers.delete(id)}cancelUpgrade(){if(this.currentUpgradeId){this.sendMessage({type:"CANCEL_UPGRADE"});this.currentUpgradeId=null}}};__publicField(_UpgradeManager,"instance");let UpgradeManager=_UpgradeManager;function getAvailableMemberUpgradePlanLevel(now=new Date){try{if(now<new Date(FOUNDING_MEMBER_DEADLINE)){return"founding_member"}for(const offer of EARLY_ADOPTER_DEADLINES){if(now<new Date(offer.date)){return"early_adopter"}}return"yakkl_pro"}catch(error){log.warn("Error determining available member upgrade plan level:",false,error);return"yakkl_pro"}}Upgrade[FILENAME]="src/lib/components/Upgrade.svelte";var root_2=add_locations(from_html(`<div class="p-6"><p class="text-center mb-4 text-gray-600">Please login to upgrade your account</p> <!></div>`),Upgrade[FILENAME],[[350,2,[[351,3]]]]);var root_6=add_locations(from_html(`<div class="flex flex-col items-center justify-center space-y-4"><div class="w-full max-w-md"><div class="relative pt-1"><div class="flex mb-2 items-center justify-between"><div><span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-indigo-600 bg-indigo-200"> </span></div> <div class="text-right"><span class="text-xs font-semibold inline-block text-indigo-600"> </span></div></div> <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-indigo-200"><div class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-indigo-500 transition-all duration-500"></div></div></div></div></div>`),Upgrade[FILENAME],[[417,3,[[418,4,[[419,5,[[420,6,[[421,7,[[422,8]]],[428,7,[[429,8]]]]],[434,6,[[435,7]]]]]]]]]]);var on_click=(_,showLoginModal)=>set(showLoginModal,true);var root_8=add_locations(from_html(`<div class="text-center py-8"><p class="text-gray-600 mb-4">Please login to upgrade your account</p> <button class="px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">Login to Continue</button></div>`),Upgrade[FILENAME],[[563,4,[[564,5],[565,5]]]]);var root_10=add_locations(from_html(`<div class="pt-5"><div class="flex justify-end space-x-4"><button type="button" class="rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">Cancel</button> <button type="button" class="rounded-md border border-transparent bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"> </button></div></div>`),Upgrade[FILENAME],[[573,4,[[574,5,[[575,6],[582,6]]]]]]);var root_7=add_locations(from_html(`<div class="bg-gray-50 p-4 rounded-lg"><h4 class="font-medium text-gray-900">Pro Features</h4> <ul class="mt-2 space-y-2 text-sm text-gray-600"><li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Automatic price updates with full analytics</li> <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Participate in early access to new features and products</li> <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Reduced swap fees for DeFi platforms</li> <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Advanced market analytics and charting</li> <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Full Emergency Kit for wallet recovery</li> <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Unlimited accounts</li> <li class="flex items-center"><svg class="h-5 w-5 text-green-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Advanced security features and more...</li></ul></div> <!>`,1),Upgrade[FILENAME],[[444,3,[[445,4],[446,4,[[447,5,[[448,6,[[454,7]]]]],[463,5,[[464,6,[[470,7]]]]],[479,5,[[480,6,[[486,7]]]]],[495,5,[[496,6,[[502,7]]]]],[511,5,[[512,6,[[518,7]]]]],[527,5,[[528,6,[[534,7]]]]],[543,5,[[544,6,[[550,7]]]]]]]]]]);var root_3=add_locations(from_html(`<div class="space-y-6 p-6"><div class="text-center"><h3 class="text-lg font-medium text-gray-900"> </h3> <p class="mt-2 text-sm text-gray-500">Unlock advanced features and enhanced security for your crypto assets.</p></div> <!> <!></div>`),Upgrade[FILENAME],[[399,1,[[400,2,[[401,3],[404,3]]]]]]);var root=add_locations(from_html(`<!> <!> <!> <!> <!> <!>`,1),Upgrade[FILENAME],[]);function Upgrade($$anchor,$$props){var _a,_b,_c;check_target(new.target);push($$props,true,Upgrade);var $$ownership_validator=create_ownership_validator($$props);const[$$stores,$$cleanup]=setup_stores();const $isAuthenticated=()=>(validate_store(isAuthenticated,"isAuthenticated"),store_get(isAuthenticated,"$isAuthenticated",$$stores));const $yakklMiscStore=()=>(validate_store(yakklMiscStore,"yakklMiscStore"),store_get(yakklMiscStore,"$yakklMiscStore",$$stores));let show=prop($$props,"show",15,false);prop($$props,"onComplete",11,()=>{});let onClose=prop($$props,"onClose",11,()=>{safeLogout()}),onCancel=prop($$props,"onCancel",11,()=>{show(false),set(showConfirmation,false),set(showNotification,false),set(showError,false)}),useAuthStore=prop($$props,"useAuthStore",3,false);const contextType=tag_proxy(proxy(getContextTypeStore()),"contextType");const isSidepanel=tag(user_derived(()=>{var _a2;return strict_equals(contextType,"sidepanel")||(((_a2=contextType==null?void 0:contextType.includes)==null?void 0:_a2.call(contextType,"sidepanel"))??false)}),"isSidepanel");let showError=tag(state(false),"showError");let errorMessage=tag(state(""),"errorMessage");let isUpgrading=tag(state(false),"isUpgrading");let isProUser=tag(state(false),"isProUser");let showConfirmation=tag(state(false),"showConfirmation");let showNotification=tag(state(false),"showNotification");let showRegistrationPrompt=tag(state(false),"showRegistrationPrompt");let showLoginModal=tag(state(false),"showLoginModal");let progress=tag(state(0),"progress");let statusMessage=tag(state(""),"statusMessage");let isInitializing=tag(state(false),"isInitializing");let retryCount=tag(state(0),"retryCount");const maxRetries=3;let formValues={userName:"",password:"",email:""};let isLoggedIn=tag(state(false),"isLoggedIn");let registrationStatus=tag(state(null),"registrationStatus");let planLevelAvailable=tag_proxy(proxy(((_c=(_b=(_a=getAvailableMemberUpgradePlanLevel())==null?void 0:_a.toString())==null?void 0:_b.toUpperCase())==null?void 0:_c.replace("_"," "))??"YAKKL PRO"),"planLevelAvailable");const upgradeManager=UpgradeManager.getInstance();let unregisterHandler=null;user_effect(()=>{if(show()){set(isInitializing,true);if(useAuthStore()){authStore.initialize().then(()=>{initializeUpgradeFlow()}).catch(error=>{log.error("Failed to initialize auth store:",false,error);initializeUpgradeFlow()}).finally(()=>{set(isInitializing,false)})}else{initializeUpgradeFlow().finally(()=>{set(isInitializing,false)})}}});user_effect(()=>{if(!show()&&get(isSidepanel)){closeModal()}});user_effect(()=>{unregisterHandler=upgradeManager.registerMessageHandler(handleUpgradeMessage);return()=>{if(unregisterHandler){unregisterHandler()}}});function handleUpgradeMessage(message){switch(message.type){case"UPGRADE_STARTED":set(isUpgrading,true);set(progress,0);set(statusMessage,"Starting upgrade process...");break;case"UPGRADE_PROGRESS":set(progress,message.progress,true);set(statusMessage,message.status,true);break;case"UPGRADE_COMPLETED":set(isUpgrading,false);show(false);set(showNotification,true);break;case"UPGRADE_ERROR":set(isUpgrading,false);set(errorMessage,message.error,true);set(showError,true);break}}function handleSidepanelClose(){show(false);closeModal();if(!get(isSidepanel)){onClose()()}}function handleSidepanelCancel(){show(false);closeModal();set(showConfirmation,false);set(showNotification,false);set(showError,false);if(!get(isSidepanel)){onCancel()()}}function handleNotificationClose(){set(showNotification,false);closeModal();setTimeout(()=>{if(!get(isSidepanel)){onClose()()}},50)}async function initializeUpgradeFlow(){try{set(retryCount,0);set(registrationStatus,await checkRegistrationStatus(),true);if(!get(registrationStatus).isRegistered){set(showRegistrationPrompt,true);return}set(isLoggedIn,useAuthStore()?$isAuthenticated():isUserLoggedIn($yakklMiscStore()),true);if(!get(isLoggedIn)){set(showLoginModal,true);return}await checkProLevelStatus()}catch(error){update(retryCount);log.error("Error initializing upgrade flow:",false,error);if(error instanceof Error){set(errorMessage,`Initialization failed: ${error.message}`)}else{set(errorMessage,"Failed to initialize upgrade process")}if(get(retryCount)<maxRetries){set(errorMessage,get(errorMessage)+` (Attempt ${get(retryCount)}/${maxRetries})`)}set(showError,true)}}async function handleInitRetry(){if(get(retryCount)<maxRetries){set(showError,false);set(errorMessage,"");set(isInitializing,true);try{await initializeUpgradeFlow()}finally{set(isInitializing,false)}}}function handleInitDismiss(){set(showError,false);set(errorMessage,"");set(retryCount,0);if(get(isSidepanel)){closeModal()}}async function checkProLevelStatus(){try{const upgradeAllowed=await canUpgrade();set(isProUser,!upgradeAllowed);if(!upgradeAllowed){set(showError,true)}}catch(error){log.error("Error checking upgrade eligibility:",false,error)}}createForm({initialValues:formValues,validationSchema:create$3().shape({userName:create$6().required("Member username is required"),password:create$6().required("Password is required"),email:create$6().email("Must be a valid email.").required("Email is required.")}),onSubmit:async values=>{formValues=values;set(showConfirmation,true)}});function handleLoginSuccess(profile,digest,_isMinimal,jwtToken){var _a2;set(isLoggedIn,true);set(showLoginModal,false);if(jwtToken){log.debug("JWT token received in upgrade flow",false,{hasToken:true,username:profile.userName})}if(profile){formValues.userName=profile.userName;if((_a2=profile.data)==null?void 0:_a2.email){if(isEncryptedData(profile.data)){decryptData(profile.data,digest).then(profileData=>{const data=profileData;formValues.email=data.email}).catch(error=>{log.warn("Error decrypting profile data:",false,error);formValues.email=""})}else{formValues.email=profile.data.email}}}checkProLevelStatus()}function handleLoginError(error){set(errorMessage,strict_equals(typeof error,"string")?error:"Authentication failed",true);set(showError,true);if(get(isSidepanel)){setTimeout(()=>{closeModal()},2e3)}}async function onProcessUpgrade(){try{const profile=await getProfile();if(!profile){log.warn("Profile not found",false,"Upgrade");set(errorMessage,"Profile not found");set(showError,true);return}formValues={userName:"",password:"",email:""};if(isEncryptedData(profile.data)){const profileData=await decryptData(profile.data,$yakklMiscStore());formValues.userName=profile.userName;formValues.email=profileData.email}else{formValues.userName=profile.userName;formValues.email=profile.data.email}set(showConfirmation,true)}catch(error){log.warn("Error in onProcessUpgrade:",false,error);set(errorMessage,error instanceof Error?error.message:"An error occurred during upgrade",true);set(showError,true)}}async function processUpgrade(){var _a2,_b2,_c2,_d;try{const analyticsData={utm_source:"wallet",utm_campaign:"yakkl_pro_upgrade",user_location:navigator.language,upgrade_date:dateString(),current_version:((_a2=await getSettings())==null?void 0:_a2.version)??"unknown",platform:((_b2=navigator==null?void 0:navigator.userAgentData)==null?void 0:_b2.platform)??(navigator==null?void 0:navigator.platform)??"unknown",user_agent:(navigator==null?void 0:navigator.userAgent)??"unknown"};const planLevel=((_c2=planLevelAvailable==null?void 0:planLevelAvailable.replace(" ","_ "))==null?void 0:_c2.toLowerCase())??"yakkl_pro";analyticsData.utm_campaign=planLevel.includes("_upgrade")?planLevel:planLevel+"_upgrade";await upgradeManager.processUpgrade({userName:formValues.userName,email:formValues.email,analytics:analyticsData,profileId:((_d=await getSettings())==null?void 0:_d.id)??"",encryptionKey:$yakklMiscStore()})}catch(error){log.error("Error in upgrade process:",false,error);set(errorMessage,error instanceof Error?error.message:"An error occurred during upgrade",true);set(showError,true)}}function onConfirm(){processUpgrade()}function getCurrentContext(){if(strict_equals(typeof window,"undefined",false)){const pathIncludes=window.location.pathname.includes("sidepanel");return pathIncludes?"sidepanel":"wallet"}return"wallet"}user_effect(()=>{if(useAuthStore()){set(isLoggedIn,$isAuthenticated(),true)}else{set(isLoggedIn,isUserLoggedIn($yakklMiscStore()),true)}});var fragment=root();var node=first_child(fragment);const expression=user_derived(getCurrentContext);RegistrationPrompt(node,{get context(){return get(expression)},get openWallet(){return $$props.openWallet},onCancel:()=>{set(showRegistrationPrompt,false);show(false);if(get(isSidepanel)){closeModal()}},get show(){return get(showRegistrationPrompt)},set show($$value){set(showRegistrationPrompt,$$value,true)}});var node_1=sibling(node,2);{var consequent=$$anchor2=>{Modal($$anchor2,{title:"Login Required",className:"z-[701] text-base-content",get show(){return get(showLoginModal)},set show($$value){set(showLoginModal,$$value,true)},children:wrap_snippet(Upgrade,($$anchor3,$$slotProps)=>{var div=root_2();var node_2=sibling(child(div),2);const expression_1=user_derived(()=>!useAuthStore());Login(node_2,{onSuccess:handleLoginSuccess,onError:handleLoginError,onCancel:()=>{set(showLoginModal,false);show(false);if(get(isSidepanel)){closeModal()}},loginButtonText:"Login to Upgrade",cancelButtonText:"Cancel",get useAuthStore(){return useAuthStore()},get generateJWT(){return get(expression_1)},inputTextClass:"text-base-content",inputBgClass:"bg-base-100"});reset(div);append($$anchor3,div)}),$$slots:{default:true}})};if_block(node_1,$$render=>{if(get(showLoginModal))$$render(consequent)})}var node_3=sibling(node_1,2);const expression_2=user_derived(()=>planLevelAvailable.toUpperCase());const expression_3=user_derived(()=>get(isSidepanel)?handleSidepanelCancel:onCancel());ErrorNoAction(node_3,{get value(){return`You are already using a ${get(expression_2)??""} level plan`},title:"Congratulations!",get onClose(){return get(expression_3)},get show(){return get(showError)},set show($$value){set(showError,$$value,true)}});var node_4=sibling(node_3,2);const expression_4=user_derived(()=>planLevelAvailable.toUpperCase());const expression_5=user_derived(()=>planLevelAvailable.toUpperCase());const expression_6=user_derived(()=>get(isSidepanel)?handleSidepanelCancel:onCancel());Confirmation(node_4,{get title(){return`Upgrading to ${get(expression_4)??""}!`},get message(){return`Are you sure you want to upgrade to ${get(expression_5)??""}?`},onConfirm:onConfirm,get onCancel(){return get(expression_6)},get show(){return get(showConfirmation)},set show($$value){set(showConfirmation,$$value,true)}});var node_5=sibling(node_4,2);const expression_7=user_derived(()=>planLevelAvailable.toUpperCase());const expression_8=user_derived(()=>planLevelAvailable.toUpperCase());const expression_9=user_derived(()=>planLevelAvailable.toUpperCase());const expression_10=user_derived(()=>get(isSidepanel)?handleNotificationClose:onClose());Notification(node_5,{get title(){return`Upgraded to ${get(expression_7)??""}!`},get message(){return`You are now using the ${get(expression_8)??""} plan. You can now access all the features of the ${get(expression_9)??""} plan.`},get onClose(){return get(expression_10)},get show(){return get(showNotification)},set show($$value){set(showNotification,$$value,true)}});var node_6=sibling(node_5,2);const expression_11=user_derived(()=>planLevelAvailable.toUpperCase());const expression_12=user_derived(()=>get(isSidepanel)?handleSidepanelClose:onClose());{$$ownership_validator.binding("show",Modal,show);Modal(node_6,{get title(){return`Upgrade to ${get(expression_11)??""}`},get onClose(){return get(expression_12)},get show(){return show()},set show($$value){show($$value)},children:wrap_snippet(Upgrade,($$anchor2,$$slotProps)=>{var div_1=root_3();var div_2=child(div_1);var h3=child(div_2);var text=child(h3);reset(h3);next(2);reset(div_2);var node_7=sibling(div_2,2);{var consequent_1=$$anchor3=>{AuthLoading($$anchor3,{message:"Initializing upgrade process...",variant:"spinner",size:"md",className:"py-8"})};var alternate=($$anchor3,$$elseif)=>{{var consequent_2=$$anchor4=>{var div_3=root_6();var div_4=child(div_3);var div_5=child(div_4);var div_6=child(div_5);var div_7=child(div_6);var span=child(div_7);var text_1=child(span,true);reset(span);reset(div_7);var div_8=sibling(div_7,2);var span_1=child(div_8);var text_2=child(span_1);reset(span_1);reset(div_8);reset(div_6);var div_9=sibling(div_6,2);var div_10=child(div_9);reset(div_9);reset(div_5);reset(div_4);reset(div_3);template_effect(()=>{set_text(text_1,get(statusMessage));set_text(text_2,`${get(progress)??""}%`);set_style(div_10,`width: ${get(progress)??""}%`)});append($$anchor4,div_3)};var alternate_1=$$anchor4=>{var fragment_3=root_7();var node_8=sibling(first_child(fragment_3),2);{var consequent_3=$$anchor5=>{var div_11=root_8();var button=sibling(child(div_11),2);button.__click=[on_click,showLoginModal];reset(div_11);append($$anchor5,div_11)};var alternate_2=($$anchor5,$$elseif2)=>{{var consequent_4=$$anchor6=>{var div_12=root_10();var div_13=child(div_12);var button_1=child(div_13);button_1.__click=function(...$$args){apply(()=>get(isSidepanel)?handleSidepanelCancel:onCancel(),this,$$args,Upgrade,[578,16])};var button_2=sibling(button_1,2);button_2.__click=onProcessUpgrade;var text_3=child(button_2,true);reset(button_2);reset(div_13);reset(div_12);template_effect(()=>{button_2.disabled=get(isUpgrading);set_text(text_3,get(isUpgrading)?"Upgrading...":"Upgrade to Pro Level")});append($$anchor6,div_12)};if_block($$anchor5,$$render=>{if(get(isLoggedIn))$$render(consequent_4)},$$elseif2)}};if_block(node_8,$$render=>{if(!get(isLoggedIn)&&!get(showLoginModal)&&!get(showRegistrationPrompt))$$render(consequent_3);else $$render(alternate_2,false)})}append($$anchor4,fragment_3)};if_block($$anchor3,$$render=>{if(get(isUpgrading))$$render(consequent_2);else $$render(alternate_1,false)},$$elseif)}};if_block(node_7,$$render=>{if(get(isInitializing))$$render(consequent_1);else $$render(alternate,false)})}var node_9=sibling(node_7,2);const expression_13=user_derived(()=>get(showError)?get(errorMessage):null);const expression_14=user_derived(()=>get(retryCount)<maxRetries&&!get(isUpgrading)&&!get(isInitializing)?handleInitRetry:void 0);const expression_15=user_derived(()=>!get(isUpgrading)&&!get(isInitializing)?handleInitDismiss:void 0);AuthError(node_9,{get error(){return get(expression_13)},get onRetry(){return get(expression_14)},get onDismiss(){return get(expression_15)}});reset(div_1);template_effect($0=>set_text(text,`YAKKL Smart Wallet - ${$0??""}`),[()=>planLevelAvailable.toUpperCase()]);append($$anchor2,div_1)}),$$slots:{default:true}})}append($$anchor,fragment);var $$pop=pop({...legacy_api()});$$cleanup();return $$pop}delegate(["click"]);export{Upgrade as U};
//# sourceMappingURL=CIbUU8ai.js.map
