var __defProp=Object.defineProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value:value}):obj[key]=value;var __publicField=(obj,key,value)=>__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);import{w as writable}from"./B2gA1VsD.js";import{UnifiedTimerManager}from"./z-nmOEXa.js";class CountdownTimer{constructor(id,duration,onTick,onComplete){__publicField(this,"id");__publicField(this,"duration");__publicField(this,"remaining");__publicField(this,"startTime",0);__publicField(this,"pausedTime",0);__publicField(this,"isRunning",false);__publicField(this,"isPaused",false);__publicField(this,"onTick");__publicField(this,"onComplete");__publicField(this,"timerManager");__publicField(this,"store");this.id=`countdown-${id}`;this.duration=duration;this.remaining=duration;this.onTick=onTick;this.onComplete=onComplete;this.timerManager=UnifiedTimerManager.getInstance();this.store=writable({remaining:duration,isRunning:false,isPaused:false,progress:0})}start(){if(this.isRunning&&!this.isPaused)return;if(this.isPaused){this.startTime=Date.now()-(this.duration-this.remaining);this.isPaused=false}else{this.startTime=Date.now();this.remaining=this.duration}this.isRunning=true;this.updateStore();this.timerManager.addInterval(this.id,()=>this.tick(),100);this.timerManager.startInterval(this.id)}tick(){if(!this.isRunning||this.isPaused)return;const elapsed=Date.now()-this.startTime;this.remaining=Math.max(0,this.duration-elapsed);(this.duration-this.remaining)/this.duration*100;this.updateStore();if(this.onTick){this.onTick(Math.ceil(this.remaining/1e3))}if(this.remaining<=0){this.complete()}}complete(){this.stop();if(this.onComplete){this.onComplete()}}pause(){if(!this.isRunning||this.isPaused)return;this.isPaused=true;this.pausedTime=Date.now();this.timerManager.stopInterval(this.id);this.updateStore()}resume(){if(!this.isPaused)return;this.start()}stop(){this.isRunning=false;this.isPaused=false;this.remaining=this.duration;this.timerManager.stopInterval(this.id);this.timerManager.removeInterval(this.id);this.updateStore()}reset(){this.stop();this.remaining=this.duration;this.updateStore()}getRemainingSeconds(){return Math.ceil(this.remaining/1e3)}getRemainingTime(){const totalSeconds=this.getRemainingSeconds();return{minutes:Math.floor(totalSeconds/60),seconds:totalSeconds%60}}getProgress(){return(this.duration-this.remaining)/this.duration*100}updateStore(){this.store.set({remaining:this.remaining,isRunning:this.isRunning,isPaused:this.isPaused,progress:this.getProgress()})}destroy(){this.stop()}}function createCountdownTimer(id,durationInSeconds,onTick,onComplete){return new CountdownTimer(id,durationInSeconds*1e3,onTick,onComplete)}export{CountdownTimer as C,createCountdownTimer as c};
//# sourceMappingURL=Ch-onVly.js.map
