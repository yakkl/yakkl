{"version":3,"file":"BkHOZpS2.js","sources":["../../../../../../src/lib/components/RegistrationPrompt.svelte","../../../../../../src/lib/common/auth-utils.ts"],"sourcesContent":["<script lang=\"ts\">\n\timport Modal from './Modal.svelte';\n\timport { browser_ext } from '$lib/common/environment';\n\n\tinterface Props {\n\t\tshow: boolean;\n\t\ttitle?: string;\n\t\tmessage?: string;\n\t\tcontext?: 'sidepanel' | 'wallet' | 'popup';\n\t\topenWallet?: () => void;\n\t\tonConfirm?: () => void;\n\t\tonCancel?: () => void;\n\t}\n\n\tlet {\n\t\tshow = $bindable(false),\n\t\ttitle = 'Registration Required',\n\t\tmessage = 'You need to register your YAKKL wallet before proceeding.',\n\t\tcontext = 'wallet',\n\t\topenWallet,\n\t\tonConfirm,\n\t\tonCancel\n\t}: Props = $props();\n\n\tfunction handleConfirm() {\n\t\tif (onConfirm) {\n\t\t\tonConfirm();\n\t\t} else if (context === 'sidepanel' && openWallet) {\n\t\t\topenWallet();\n\t\t} else if (context === 'sidepanel') {\n\t\t\tbrowser_ext.runtime.sendMessage({ type: 'popout' });\n\t\t}\n\t\tshow = false;\n\t}\n\n\tfunction handleCancel() {\n\t\tif (onCancel) onCancel();\n\t\tshow = false;\n\t}\n</script>\n\n<Modal bind:show {title} className=\"z-[700]\">\n\t<div class=\"p-6 space-y-4\">\n\t\t<p class=\"text-base\">{message}</p>\n\t\t<p class=\"text-sm text-gray-600\">\n\t\t\t{#if context === 'sidepanel'}\n\t\t\t\tWould you like to open the wallet to complete registration?\n\t\t\t{:else}\n\t\t\t\tPlease complete the registration process to continue.\n\t\t\t{/if}\n\t\t</p>\n\n\t\t<div class=\"flex justify-end gap-4 mt-6\">\n\t\t\t<button\n\t\t\t\tonclick={handleCancel}\n\t\t\t\tclass=\"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300\"\n\t\t\t>\n\t\t\t\tCancel\n\t\t\t</button>\n\t\t\t<button\n\t\t\t\tonclick={handleConfirm}\n\t\t\t\tclass=\"px-6 py-2 text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition-colors\"\n\t\t\t>\n\t\t\t\t{context === 'sidepanel' ? 'Open Wallet' : 'Continue'}\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</Modal>\n","import { getSettings } from '$lib/common/stores';\nimport type { Settings } from '$lib/common/interfaces';\n\nexport interface RegistrationStatus {\n\tisRegistered: boolean;\n\thasAgreedToTerms: boolean;\n\tisInitialized: boolean;\n\trequiresAction: 'terms' | 'register' | 'login' | null;\n}\n\nexport async function checkRegistrationStatus(): Promise<RegistrationStatus> {\n\ttry {\n\t\tconst settings = await getSettings();\n\n\t\tconst hasAgreedToTerms = settings?.legal?.termsAgreed ?? false;\n\t\tconst isInitialized = settings?.init ?? false;\n\n\t\tlet requiresAction: RegistrationStatus['requiresAction'] = null;\n\n\t\tif (!hasAgreedToTerms) {\n\t\t\trequiresAction = 'terms';\n\t\t} else if (!isInitialized) {\n\t\t\trequiresAction = 'register';\n\t\t} else {\n\t\t\trequiresAction = 'login';\n\t\t}\n\n\t\treturn {\n\t\t\tisRegistered: hasAgreedToTerms && isInitialized,\n\t\t\thasAgreedToTerms,\n\t\t\tisInitialized,\n\t\t\trequiresAction\n\t\t};\n\t} catch (error) {\n\t\tconsole.error('Error checking registration status:', error);\n\t\treturn {\n\t\t\tisRegistered: false,\n\t\t\thasAgreedToTerms: false,\n\t\t\tisInitialized: false,\n\t\t\trequiresAction: 'terms'\n\t\t};\n\t}\n}\n\nexport function isUserLoggedIn(miscStore: string | null): boolean {\n\treturn !!miscStore && miscStore.length > 0;\n}\n"],"names":["handleConfirm","_","$$props","context","show","onConfirm","$.strict_equals","openWallet","browser_ext","runtime","sendMessage","type","handleCancel","__1","$.prop","title","message","consequent","$$render","alternate","$.set_text","text_3","async","checkRegistrationStatus","settings","getSettings","hasAgreedToTerms","_a","legal","termsAgreed","isInitialized","init","requiresAction","isRegistered","error","console","isUserLoggedIn","miscStore","length"],"mappings":"6wBAwBUA,cAAgBC,EAAAC,QAAAC,QAAAC,MACT,GAAAF,QAAAG,UAAA,oBAEf,SAAAC,cAAWH,UAAY,cAA2BD,QAAAK,WAAA,qBAElD,MAAAD,GAAAA,cAAWH,UAAY,aAAa,CACnCK,YAAYC,QAAQC,aAAcC,KAAM,UACzC,CACAP,KAAO,MACR,UAESQ,aAAeC,IAAAX,QAAAE,6CAEvBA,KAAO,MACR,ooBAvBC,IAAAA,KAAAU,KAAAZ,QAAA,OAAA,GAAiB,OACjBa,MAAQD,KAAAZ,QAAA,QAAA,EAAA,yBACRc,QAAUF,KAAAZ,QAAA,UAAA,EAAA,6DACVC,QAAUW,KAAAZ,QAAA,UAAA,EAAA,koBA2BJ,GAAAI,cAAAH,UAAY,sBAAWc,iBAAAC,SAAAC,UAAA,qFASlBP,aAAYV,QAAAE,uDAMZJ,cAAaE,QAAAC,QAAAC,mHAjBFY,WAoBnBI,SAAAC,OAAAf,cAAAH,UAAY,aAAc,cAAgB,iHCrD/CmB,eAAsBC,iCACjB,IACG,MAAAC,eAAiBC,cAEjB,MAAAC,mBAAmBC,GAAAH,UAAA,UAAA,EAAAA,SAAUI,QAAV,UAAA,EAAAD,GAAiBE,cAAe,MACnD,MAAAC,eAAgBN,+BAAUO,OAAQ,MAExC,IAAIC,eAAuD,KAE3D,IAAKN,iBAAkB,CACLM,eAAA,OAAA,MAAA,IACNF,cAAe,CACTE,eAAA,UAAA,KACX,CACWA,eAAA,OAAA,CAGX,MAAA,CACNC,aAAcP,kBAAoBI,cAClCJ,kCACAI,4BACAE,qCAEOE,OACAC,QAAAD,MAAM,sCAAuCA,OAC9C,MAAA,CACND,aAAc,MACdP,iBAAkB,MAClBI,cAAe,MACfE,eAAgB,QACjB,CAEF,CAEO,SAASI,eAAeC,WAC9B,QAASA,WAAaA,UAAUC,OAAS,CAC1C"}