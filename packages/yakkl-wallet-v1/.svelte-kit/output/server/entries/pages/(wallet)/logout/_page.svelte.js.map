{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../src/lib/managers/ErrorHandler.ts","../../../../../../../src/routes/(wallet)/logout/+page.svelte"],"sourcesContent":["import { log } from '$lib/common/logger-wrapper';\n\n// Check if we're in browser environment without using SvelteKit imports\nconst isBrowser = typeof window !== 'undefined';\n\ninterface ExtendedPerformance extends Performance {\n\tmemory?: {\n\t\tusedJSHeapSize: number;\n\t\tjsHeapSizeLimit: number;\n\t\ttotalJSHeapSize: number;\n\t};\n}\n\ninterface GlobalError {\n\tmessage?: string;\n\tsource?: string;\n\tlineno?: number;\n\tcolno?: number;\n\terror?: Error;\n\ttimestamp: string;\n\ttype: 'error' | 'unhandledrejection' | 'event';\n}\n\ninterface MemorySnapshot {\n\ttime: number;\n\tmemory?: number;\n\tnodes: number;\n\teventListeners: number;\n\tlocation: string;\n}\n\ninterface StateSnapshot {\n\ttimestamp: number;\n\troute: string;\n\tactiveModals: Array<{\n\t\tid: string;\n\t\tclass: string;\n\t\tvisible: boolean;\n\t}>;\n\tcomponentStack: string[];\n\teventQueue: string[];\n\tlastActions: Array<{ time: number; action: string }>;\n\tmemoryUsage: any;\n}\n\ninterface ComponentError {\n\tcomponent: string;\n\terror: any;\n\tprops?: any;\n\tstate?: any;\n}\n\nconst MEMORY_THRESHOLDS = {\n\theap: 100 * 1024 * 1024, // 100MB\n\tnodes: 5000, // Max DOM nodes\n\teventListeners: 1000 // Max event listeners\n};\n\nexport class ErrorHandler {\n\tprivate static instance: ErrorHandler | null = null;\n\tprivate memorySnapshots: MemorySnapshot[] = [];\n\tprivate stateSnapshots: StateSnapshot[] = [];\n\tprivate lastActions: Array<{ time: number; action: string }> = [];\n\tprivate lastComponentErrors: ComponentError[] = [];\n\tprivate mountTime: number = Date.now();\n\tprivate lastLocation: string = '';\n\tprivate resourceCheckInterval: number | null = null;\n\tprivate memoryCheckInterval: number | null = null;\n\tprivate isInitialized: boolean = false;\n\tprivate isClosing: boolean = false;\n\tprivate readonly MAX_ACTION_HISTORY = 50;\n\n\tprivate constructor() {\n\t\tif (!isBrowser) return;\n\t\tsetTimeout(() => {\n\t\t\tthis.initialize();\n\t\t}, 0);\n\t}\n\n\tprivate async initialize(): Promise<void> {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tif (this.isInitialized) return;\n\n\t\t\tthis.initializeErrorHandlers();\n\t\t\tthis.initializeUIMonitoring();\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.initializeResourceMonitoring();\n\t\t\t}, 1000);\n\t\t\tthis.initializeStateRecovery();\n\t\t\tthis.checkPreviousError();\n\n\t\t\tthis.isInitialized = true;\n\t\t} catch (error) {\n\t\t\tlog.error('ErrorHandler initialization failed', false, error);\n\t\t}\n\t}\n\n\tpublic static getInstance(): ErrorHandler {\n\t\tif (!ErrorHandler.instance) {\n\t\t\tErrorHandler.instance = new ErrorHandler();\n\t\t}\n\t\treturn ErrorHandler.instance;\n\t}\n\n\thandleError(error: Error): void {\n\t\tif (!isBrowser) return;\n\t\tlog.error('Error handled by ErrorHandler:', false, error);\n\t}\n\n\tprivate initializeErrorHandlers(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tlet lastError: any = null;\n\t\t\tconst performance = window.performance as ExtendedPerformance;\n\n\t\t\tObject.defineProperty(window, 'lastError', {\n\t\t\t\tget: () => lastError,\n\t\t\t\tset: (error) => {\n\t\t\t\t\tlastError = error;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\t'lastFatalError',\n\t\t\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\t\t\terror: error?.toString(),\n\t\t\t\t\t\t\t\tstack: error?.stack,\n\t\t\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\t\tmemory: performance?.memory?.usedJSHeapSize,\n\t\t\t\t\t\t\t\tlastLocation: this.lastLocation,\n\t\t\t\t\t\t\t\tstateSnapshot: this.captureStateSnapshot(),\n\t\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Fail silently\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Track all clicks\n\t\t\tdocument.addEventListener(\n\t\t\t\t'click',\n\t\t\t\t(event) => {\n\t\t\t\t\tconst target = event.target as HTMLElement;\n\t\t\t\t\tconst action = {\n\t\t\t\t\t\ttime: Date.now(),\n\t\t\t\t\t\taction: `Click: ${target.tagName} ${target.className} ${target.id}`\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.lastActions.unshift(action);\n\t\t\t\t\tif (this.lastActions.length > this.MAX_ACTION_HISTORY) {\n\t\t\t\t\t\tthis.lastActions.pop();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Capture state after each click\n\t\t\t\t\tthis.stateSnapshots.push(this.captureStateSnapshot());\n\t\t\t\t\tif (this.stateSnapshots.length > 10) {\n\t\t\t\t\t\tthis.stateSnapshots.shift();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\twindow.onerror = (message, source, lineno, colno, error) => {\n\t\t\t\tconst messageText = message instanceof Event ? message.type : String(message);\n\n\t\t\t\tif (messageText?.includes('ResizeObserver loop')) {\n\t\t\t\t\treturn; // Ignore ResizeObserver errors\n\t\t\t\t}\n\n\t\t\t\tif (!this.isClosing) {\n\t\t\t\t\tconst errorInfo = {\n\t\t\t\t\t\tmessage: messageText,\n\t\t\t\t\t\tsource,\n\t\t\t\t\t\tlineno,\n\t\t\t\t\t\tcolno,\n\t\t\t\t\t\terror,\n\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\ttimeSinceMount: Date.now() - this.mountTime,\n\t\t\t\t\t\tmemoryUsage: performance?.memory?.usedJSHeapSize,\n\t\t\t\t\t\tlastLocation: this.lastLocation,\n\t\t\t\t\t\tstateSnapshots: this.stateSnapshots,\n\t\t\t\t\t\tlastActions: this.lastActions,\n\t\t\t\t\t\tcomponentErrors: this.lastComponentErrors,\n\t\t\t\t\t\tfinalSnapshot: this.captureStateSnapshot()\n\t\t\t\t\t};\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlocalStorage.setItem('lastFatalError', JSON.stringify(errorInfo));\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Ignore storage errors\n\t\t\t\t\t}\n\n\t\t\t\t\tlog.error('Fatal error caught', true, errorInfo);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\twindow.addEventListener('error', (event) => {\n\t\t\t\tconst errorDetails: GlobalError = {\n\t\t\t\t\tmessage: event.message,\n\t\t\t\t\tsource: event.filename,\n\t\t\t\t\tlineno: event.lineno,\n\t\t\t\t\tcolno: event.colno,\n\t\t\t\t\terror: event.error,\n\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\ttype: 'event'\n\t\t\t\t};\n\n\t\t\t\tlog.error('Error Event Caught', true, {\n\t\t\t\t\t...errorDetails,\n\t\t\t\t\tevent: {\n\t\t\t\t\t\ttype: event.type,\n\t\t\t\t\t\ttarget: event.target?.toString(),\n\t\t\t\t\t\ttimeStamp: event.timeStamp\n\t\t\t\t\t},\n\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\tmemorySnapshot: this.getMemorySnapshot(),\n\t\t\t\t\tstateSnapshot: this.captureStateSnapshot(),\n\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t});\n\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\n\t\t\twindow.addEventListener('unhandledrejection', (event) => {\n\t\t\t\tconst errorDetails: GlobalError = {\n\t\t\t\t\tmessage: event.reason?.message || event.reason,\n\t\t\t\t\terror: event.reason instanceof Error ? event.reason : new Error(String(event.reason)),\n\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\ttype: 'unhandledrejection'\n\t\t\t\t};\n\n\t\t\t\tlog.error('Unhandled Promise Rejection', true, {\n\t\t\t\t\t...errorDetails,\n\t\t\t\t\treason: event.reason,\n\t\t\t\t\tpromise: event.promise,\n\t\t\t\t\tstack: event.reason?.stack,\n\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\tmemorySnapshot: this.getMemorySnapshot(),\n\t\t\t\t\tstateSnapshot: this.captureStateSnapshot(),\n\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t});\n\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\n\t\t\ttry {\n\t\t\t\t// @ts-ignore\n\t\t\t\twindow.addEventListener('beforeunload', (event) => {\n\t\t\t\t\tthis.isClosing = true;\n\t\t\t\t\tconst finalSnapshot = this.captureStateSnapshot();\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\t'lastStateBeforeClose',\n\t\t\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\t\t\tsnapshot: finalSnapshot,\n\t\t\t\t\t\t\t\tactions: this.lastActions,\n\t\t\t\t\t\t\t\terrors: this.lastComponentErrors,\n\t\t\t\t\t\t\t\ttimestamp: Date.now()\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Ignore storage errors\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\t// Ignore error\n\t\t\t}\n\n\t\t\tdocument.addEventListener('visibilitychange', () => {\n\t\t\t\tconst snapshot = this.captureStateSnapshot();\n\t\t\t\tlog.info('Visibility change', true, {\n\t\t\t\t\tstate: document.visibilityState,\n\t\t\t\t\tsnapshot,\n\t\t\t\t\tlastActions: this.lastActions.slice(0, 10),\n\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Track pathname changes\n\t\t\tlet lastPathname = window.location.pathname;\n\t\t\tconst observer = new MutationObserver(() => {\n\t\t\t\tconst currentPathname = window.location.pathname;\n\t\t\t\tif (lastPathname !== currentPathname) {\n\t\t\t\t\tlog.info('Navigation occurred', true, {\n\t\t\t\t\t\tfrom: lastPathname,\n\t\t\t\t\t\tto: currentPathname,\n\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\tstateSnapshot: this.captureStateSnapshot()\n\t\t\t\t\t});\n\t\t\t\t\tlastPathname = currentPathname;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tobserver.observe(document, {\n\t\t\t\tsubtree: true,\n\t\t\t\tchildList: true\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tlog.error('Failed to initialize error handlers', false, error);\n\t\t}\n\t}\n\n\tprivate initializeUIMonitoring(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\t// Monitor DOM mutations for modal dialogs\n\t\t\tconst modalObserver = new MutationObserver((mutations) => {\n\t\t\t\tmutations.forEach((mutation) => {\n\t\t\t\t\tmutation.addedNodes.forEach((node) => {\n\t\t\t\t\t\tif (node instanceof HTMLElement) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tnode.getAttribute('role') === 'dialog' ||\n\t\t\t\t\t\t\t\tnode.classList.contains('modal') ||\n\t\t\t\t\t\t\t\tnode.getAttribute('aria-modal') === 'true'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tlog.info('Modal dialog opened', true, {\n\t\t\t\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\t\t\tmodalId: node.id,\n\t\t\t\t\t\t\t\t\tmodalClasses: node.className,\n\t\t\t\t\t\t\t\t\tmemorySnapshot: this.getMemorySnapshot(),\n\t\t\t\t\t\t\t\t\tstateSnapshot: this.captureStateSnapshot()\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tmutation.removedNodes.forEach((node) => {\n\t\t\t\t\t\tif (node instanceof HTMLElement) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tnode.getAttribute('role') === 'dialog' ||\n\t\t\t\t\t\t\t\tnode.classList.contains('modal') ||\n\t\t\t\t\t\t\t\tnode.getAttribute('aria-modal') === 'true'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tlog.info('Modal dialog closed', true, {\n\t\t\t\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\t\t\tmodalId: node.id,\n\t\t\t\t\t\t\t\t\tmodalClasses: node.className,\n\t\t\t\t\t\t\t\t\tmemorySnapshot: this.getMemorySnapshot(),\n\t\t\t\t\t\t\t\t\tstateSnapshot: this.captureStateSnapshot()\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tmodalObserver.observe(document.body, {\n\t\t\t\tchildList: true,\n\t\t\t\tsubtree: true,\n\t\t\t\tattributes: true,\n\t\t\t\tattributeFilter: ['class', 'style', 'hidden']\n\t\t\t});\n\n\t\t\t// Monitor Send button\n\t\t\tconst sendButtonObserver = new MutationObserver((mutations) => {\n\t\t\t\tmutations.forEach((mutation) => {\n\t\t\t\t\tif (mutation.type === 'attributes' && mutation.attributeName === 'disabled') {\n\t\t\t\t\t\tconst button = mutation.target as HTMLElement;\n\t\t\t\t\t\tlog.info('Send button state changed', true, {\n\t\t\t\t\t\t\tdisabled: button.hasAttribute('disabled'),\n\t\t\t\t\t\t\ttimestamp: Date.now(),\n\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\tsnapshot: this.captureStateSnapshot(),\n\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Observe the Send button once it's available\n\t\t\tconst observeSendButton = () => {\n\t\t\t\tconst sendButton = document.querySelector('[data-testid=\"send-button\"]');\n\t\t\t\tif (sendButton) {\n\t\t\t\t\tsendButtonObserver.observe(sendButton, {\n\t\t\t\t\t\tattributes: true,\n\t\t\t\t\t\tattributeFilter: ['disabled']\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Check periodically for the Send button\n\t\t\tconst buttonCheckInterval = setInterval(() => {\n\t\t\t\tobserveSendButton();\n\t\t\t}, 1000);\n\n\t\t\t// Clean up interval when done\n\t\t\tsetTimeout(() => {\n\t\t\t\tclearInterval(buttonCheckInterval);\n\t\t\t}, 10000); // Stop checking after 10 seconds\n\t\t} catch (error) {\n\t\t\tlog.error('Failed to initialize UI monitoring', false, error);\n\t\t}\n\t}\n\n\tprivate initializeResourceMonitoring(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tconst performance = window.performance as ExtendedPerformance;\n\n\t\t\tthis.memoryCheckInterval = window.setInterval(() => {\n\t\t\t\ttry {\n\t\t\t\t\tconst snapshot = this.getMemorySnapshot();\n\t\t\t\t\tthis.memorySnapshots.push(snapshot);\n\n\t\t\t\t\tif (this.memorySnapshots.length > 3) {\n\t\t\t\t\t\tthis.memorySnapshots.shift();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.memorySnapshots.length === 3) {\n\t\t\t\t\t\t// Calculate percentage increase\n\t\t\t\t\t\tconst firstMemory = this.memorySnapshots[0].memory || 0;\n\t\t\t\t\t\tconst lastMemory = this.memorySnapshots[2].memory || 0;\n\t\t\t\t\t\tconst percentageIncrease = ((lastMemory - firstMemory) / firstMemory) * 100;\n\n\t\t\t\t\t\t// Only warn if there's significant growth (more than 20% across samples)\n\t\t\t\t\t\tif (percentageIncrease > 20) {\n\t\t\t\t\t\t\tlog.warn('Significant memory growth detected', true, {\n\t\t\t\t\t\t\t\tsnapshots: this.memorySnapshots,\n\t\t\t\t\t\t\t\tpercentageIncrease: percentageIncrease.toFixed(2) + '%',\n\t\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (snapshot.memory && snapshot.memory > MEMORY_THRESHOLDS.heap) {\n\t\t\t\t\t\tlog.warn('High memory usage detected', true, {\n\t\t\t\t\t\t\t...snapshot,\n\t\t\t\t\t\t\tthreshold: MEMORY_THRESHOLDS.heap,\n\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (snapshot.nodes > MEMORY_THRESHOLDS.nodes) {\n\t\t\t\t\t\tlog.warn('High DOM node count detected', true, {\n\t\t\t\t\t\t\t...snapshot,\n\t\t\t\t\t\t\tthreshold: MEMORY_THRESHOLDS.nodes,\n\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (snapshot.eventListeners > MEMORY_THRESHOLDS.eventListeners) {\n\t\t\t\t\t\tlog.warn('High event listener count detected', true, {\n\t\t\t\t\t\t\t...snapshot,\n\t\t\t\t\t\t\tthreshold: MEMORY_THRESHOLDS.eventListeners,\n\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tlog.error('Memory monitoring error', false, error);\n\t\t\t\t}\n\t\t\t}, 30000); // 30 second interval\n\t\t} catch (error) {\n\t\t\tlog.error('Failed to initialize resource monitoring', false, error);\n\t\t}\n\t}\n\n\tprivate initializeStateRecovery(): void {\n\t\tif (!isBrowser) return;\n\n\t\tconst lastFatalError = localStorage.getItem('lastFatalError');\n\t\tif (lastFatalError) {\n\t\t\ttry {\n\t\t\t\tconst error = JSON.parse(lastFatalError);\n\t\t\t\tlog.error('Recovered from previous crash', true, {\n\t\t\t\t\tpreviousError: error,\n\t\t\t\t\ttimeSince: Date.now() - new Date(error.timestamp).getTime()\n\t\t\t\t});\n\t\t\t\tlocalStorage.removeItem('lastFatalError');\n\t\t\t} catch (e) {\n\t\t\t\t// Handle parse error\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate checkPreviousError(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tconst lastError = localStorage.getItem('lastFatalError');\n\t\t\tconst lastState = localStorage.getItem('lastStateBeforeClose');\n\n\t\t\tif (lastError) {\n\t\t\t\tconst errorData = JSON.parse(lastError);\n\t\t\t\tlog.error('Recovered error from previous session', true, errorData);\n\t\t\t\tlocalStorage.removeItem('lastFatalError');\n\t\t\t}\n\n\t\t\tif (lastState) {\n\t\t\t\tconst stateData = JSON.parse(lastState);\n\t\t\t\tlocalStorage.removeItem('lastStateBeforeClose');\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// Ignore recovery errors\n\t\t}\n\t}\n\n\tprivate getMemorySnapshot(): MemorySnapshot {\n\t\tif (!isBrowser) return { time: Date.now(), nodes: 0, eventListeners: 0, location: '' };\n\n\t\tconst performance = window.performance as ExtendedPerformance;\n\t\treturn {\n\t\t\ttime: Date.now(),\n\t\t\tmemory: performance?.memory?.usedJSHeapSize,\n\t\t\tnodes: document.getElementsByTagName('*').length,\n\t\t\teventListeners: this.getEventListenerCount(),\n\t\t\tlocation: window.location.href\n\t\t};\n\t}\n\n\tprivate captureStateSnapshot(): StateSnapshot {\n\t\tif (!isBrowser)\n\t\t\treturn {\n\t\t\t\ttimestamp: Date.now(),\n\t\t\t\troute: '',\n\t\t\t\tactiveModals: [],\n\t\t\t\tcomponentStack: [],\n\t\t\t\teventQueue: [],\n\t\t\t\tlastActions: [],\n\t\t\t\tmemoryUsage: {}\n\t\t\t};\n\n\t\tconst performance = window.performance as ExtendedPerformance;\n\n\t\treturn {\n\t\t\ttimestamp: Date.now(),\n\t\t\troute: window.location.pathname,\n\t\t\tactiveModals: Array.from(\n\t\t\t\tdocument.querySelectorAll('[role=\"dialog\"], .modal, [aria-modal=\"true\"]')\n\t\t\t).map((el) => ({\n\t\t\t\tid: el.id,\n\t\t\t\tclass: (el as HTMLElement).className,\n\t\t\t\tvisible: (el as HTMLElement).style.display !== 'none'\n\t\t\t})),\n\t\t\tcomponentStack: this.captureComponentStack(),\n\t\t\teventQueue: this.getEventListeners(),\n\t\t\tlastActions: [...this.lastActions],\n\t\t\tmemoryUsage: {\n\t\t\t\tjsHeapSize: performance?.memory?.usedJSHeapSize,\n\t\t\t\ttotalNodes: document.getElementsByTagName('*').length,\n\t\t\t\teventListeners: this.getEventListenerCount()\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate captureComponentStack(): string[] {\n\t\tif (!isBrowser) return [];\n\n\t\tconst stack: string[] = [];\n\t\tlet element = document.activeElement;\n\n\t\twhile (element && element !== document.body) {\n\t\t\tconst componentName =\n\t\t\t\telement.getAttribute('data-component') || element.getAttribute('class') || element.tagName;\n\t\t\tstack.push(componentName);\n\t\t\telement = element.parentElement;\n\t\t}\n\n\t\treturn stack;\n\t}\n\n\tprivate getEventListeners(): string[] {\n\t\tif (!isBrowser) return [];\n\n\t\t// Basic estimation of event types\n\t\tconst elements = document.getElementsByTagName('*');\n\t\tconst listeners: string[] = [];\n\n\t\tfor (const element of elements) {\n\t\t\tconst eventAttributes = Array.from(element.attributes)\n\t\t\t\t.filter((attr) => attr.name.startsWith('on'))\n\t\t\t\t.map((attr) => attr.name);\n\t\t\tlisteners.push(...eventAttributes);\n\t\t}\n\n\t\treturn listeners;\n\t}\n\n\tprivate getEventListenerCount(): number {\n\t\tif (!isBrowser) return 0;\n\n\t\tconst elements = document.getElementsByTagName('*');\n\t\tlet count = 0;\n\t\tfor (const element of elements) {\n\t\t\tcount += Object.keys(element).filter((key) => key.startsWith('on')).length;\n\t\t}\n\t\treturn count;\n\t}\n\n\tpublic isReady(): boolean {\n\t\treturn this.isInitialized;\n\t}\n\n\tpublic destroy(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tif (this.resourceCheckInterval) {\n\t\t\t\tclearInterval(this.resourceCheckInterval);\n\t\t\t}\n\t\t\tif (this.memoryCheckInterval) {\n\t\t\t\tclearInterval(this.memoryCheckInterval);\n\t\t\t}\n\t\t\tthis.isInitialized = false;\n\t\t} catch (error) {\n\t\t\tlog.error('Error during ErrorHandler cleanup', false, error);\n\t\t}\n\t}\n}\n","<script lang=\"ts\">\n\timport { browserSvelte } from '$lib/common/environment';\n\timport {\n\t\tresetStores,\n\t\tsetMiscStore,\n\t\tsetYakklTokenDataCustomStorage,\n\t\tyakklCurrentlySelectedStore,\n\t\tyakklSettingsStore,\n\t\tyakklTokenDataCustomStore\n\t} from '$lib/common/stores';\n\timport { setBadgeText, setIconLock } from '$lib/utilities/utilities';\n\n\timport { type Settings, type YakklCurrentlySelected } from '$lib/common';\n\timport { removeTimers } from '$lib/common/timers';\n\timport { removeListeners } from '$lib/common/listeners';\n\timport { setLocks } from '$lib/common/locks';\n\timport { resetTokenDataStoreValues } from '$lib/common/resetTokenDataStoreValues';\n\timport { log } from '$lib/common/logger-wrapper';\n\timport { stopActivityTracking } from '$lib/common/messaging';\n\timport { ErrorHandler } from '$lib/managers/ErrorHandler';\n\n\t// Initialize error handler\n\tif (browserSvelte) {\n\t\tErrorHandler.getInstance();\n\t}\n\n\t// Reactive State\n\tlet yakklCurrentlySelected: YakklCurrentlySelected | null = $state(null);\n\tlet yakklSettings: Settings | null = $state(null);\n\n\t$effect(() => {\n\t\tyakklCurrentlySelected = $yakklCurrentlySelectedStore;\n\t});\n\t$effect(() => {\n\t\tyakklSettings = $yakklSettingsStore;\n\t});\n\n\tlet isUpdating = false; // Prevent concurrent executions\n\n\tasync function update() {\n\t\tif (!browserSvelte) return;\n\t\tif (isUpdating) return; // Prevent multiple updates\n\t\tisUpdating = true;\n\n\t\ttry {\n\t\t\tawait stopActivityTracking();\n\t\t\t// Set lock icon\n\t\t\tawait setBadgeText('');\n\t\t\tawait setIconLock();\n\t\t\tsetLocks(true);\n\n\t\t\t// Clear session-specific state\n\t\t\tremoveTimers();\n\t\t\tremoveListeners();\n\t\t\tsetMiscStore('');\n\t\t\tresetTokenDataStoreValues();\n\t\t\tsetYakklTokenDataCustomStorage($yakklTokenDataCustomStore); // Zero out values in custom token storage\n\t\t\tresetStores();\n\t\t} catch (error) {\n\t\t\tlog.error('Logout failed:', false, error);\n\t\t\talert(\n\t\t\t\t'Logout encountered an error. Please try again or refresh the extension via browser extension manager.'\n\t\t\t);\n\t\t} finally {\n\t\t\tisUpdating = false;\n\t\t\twindow.close();\n\t\t}\n\t}\n\n\tif (browserSvelte) {\n\t\tupdate();\n\t}\n</script>\n"],"names":["isBrowser","window","MEMORY_THRESHOLDS","heap","nodes","eventListeners","ErrorHandler","static","memorySnapshots","stateSnapshots","lastActions","lastComponentErrors","mountTime","Date","now","lastLocation","resourceCheckInterval","memoryCheckInterval","isInitialized","isClosing","MAX_ACTION_HISTORY","constructor","setTimeout","this","initialize","initializeErrorHandlers","initializeUIMonitoring","initializeResourceMonitoring","initializeStateRecovery","checkPreviousError","error","log","getInstance","instance","handleError","lastError","performance","Object","defineProperty","get","set","localStorage","setItem","JSON","stringify","toString","stack","timestamp","toISOString","location","href","memory","usedJSHeapSize","stateSnapshot","captureStateSnapshot","slice","e","document","addEventListener","event","target","action","time","tagName","className","id","unshift","length","pop","push","shift","onerror","message","source","lineno","colno","messageText","Event","type","String","includes","errorInfo","timeSinceMount","memoryUsage","componentErrors","finalSnapshot","errorDetails","filename","timeStamp","memorySnapshot","getMemorySnapshot","preventDefault","reason","Error","promise","snapshot","actions","errors","info","state","visibilityState","lastPathname","pathname","observer","MutationObserver","currentPathname","from","to","observe","subtree","childList","modalObserver","mutations","forEach","mutation","addedNodes","node","HTMLElement","getAttribute","classList","contains","modalId","modalClasses","removedNodes","body","attributes","attributeFilter","sendButtonObserver","attributeName","button","disabled","hasAttribute","observeSendButton","sendButton","querySelector","buttonCheckInterval","setInterval","clearInterval","firstMemory","lastMemory","percentageIncrease","warn","snapshots","toFixed","threshold","lastFatalError","getItem","parse","previousError","timeSince","getTime","removeItem","lastState","errorData","stateData","getElementsByTagName","getEventListenerCount","route","activeModals","componentStack","eventQueue","Array","querySelectorAll","map","el","class","visible","style","display","captureComponentStack","getEventListeners","jsHeapSize","totalNodes","element","activeElement","componentName","parentElement","elements","listeners","eventAttributes","filter","attr","name","startsWith","count","keys","key","isReady","destroy","browserSvelte","isUpdating","update","stopActivityTracking","setBadgeText","setIconLock","setLocks","removeTimers","removeListeners","setMiscStore","resetTokenDataStoreValues","setYakklTokenDataCustomStorage","$.store_get","$$store_subs","yakklTokenDataCustomStore","resetStores","alert","close"],"mappings":"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"}