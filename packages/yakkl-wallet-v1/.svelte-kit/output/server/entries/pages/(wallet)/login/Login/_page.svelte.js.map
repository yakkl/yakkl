{"version":3,"file":"_page.svelte.js","sources":["../../../../../../../../src/routes/(wallet)/login/Login/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport Login from '$lib/components/Login.svelte';\n\timport { setSettingsStorage, syncStorageToStore, yakklUserNameStore } from '$lib/common/stores';\n\timport { setIconUnlock } from '$lib/utilities/utilities';\n\timport { safeLogout, safeNavigate } from '$lib/common/safeNavigate';\n\timport { startActivityTracking } from '$lib/common/messaging';\n\timport { log } from '$lib/common/logger-wrapper';\n\timport type { Profile, Settings } from '$lib/common/interfaces';\n\timport { getNormalizedSettings, PATH_WELCOME, PlanType } from '$lib/common';\n\timport Welcome from '$lib/components/Welcome.svelte';\n\timport Copyright from '$lib/components/Copyright.svelte';\n\timport ErrorNoAction from '$lib/components/ErrorNoAction.svelte';\n\timport { onMount } from 'svelte';\n\timport { protectedContexts } from '$lib/common/globals';\n\n\t// State\n\tlet showError = $state(false);\n\tlet errorValue = $state('');\n\tlet planType = $state(PlanType.BASIC_MEMBER);\n\tlet yakklSettings: Settings | null = $state(null);\n\n\tonMount(async () => {\n\t\tyakklSettings = await getNormalizedSettings();\n\t\tawait setSettingsStorage(yakklSettings);\n\t\tplanType = yakklSettings?.plan.type ?? PlanType.BASIC_MEMBER;\n\t});\n\n\t// Handle successful login in the main wallet\n\tfunction onSuccess(profile: Profile, digest: string, isMinimal: boolean) {\n\t\ttry {\n\t\t\t// Set the username in the global store\n\t\t\t$yakklUserNameStore = profile.userName || '';\n\n\t\t\t// Full wallet initialization\n\t\t\tsetIconUnlock();\n\t\t\tsyncStorageToStore();\n\n\t\t\t// Only start activity tracking for protected contexts (wallet/dapp)\n\t\t\tconst contextType = 'popup-wallet'; // This is explicitly the wallet context\n\t\t\tif (protectedContexts.includes(contextType)) {\n\t\t\t\tlog.info(`Starting activity tracking for protected context: ${contextType}`);\n\t\t\t\tstartActivityTracking(contextType);\n\t\t\t} else {\n\t\t\t\tlog.info(`Skipping activity tracking for non-protected context: ${contextType}`);\n\t\t\t}\n\n\t\t\t// Navigate to wallet dashboard\n\t\t\tsafeNavigate(PATH_WELCOME, 0, { replaceState: true, invalidateAll: true });\n\t\t} catch (e: any) {\n\t\t\tlog.error('Error during post-login initialization', false, e);\n\t\t\terrorValue = e;\n\t\t\tshowError = true;\n\t\t}\n\t}\n\n\t// Handle login errors\n\tfunction onError(value: string) {\n\t\terrorValue = value;\n\t\tshowError = true;\n\t}\n\n\t// Handle login cancel\n\tfunction onCancel() {\n\t\tsafeLogout();\n\t}\n\n\t// Handle close\n\tfunction onClose() {\n\t\tshowError = false;\n\t\terrorValue = '';\n\t}\n</script>\n\n<ErrorNoAction bind:show={showError} title=\"ERROR!\" value={errorValue} {onClose} />\n\n<!-- relative bg-gradient-to-b from-indigo-700 to-indigo-500/15 m-1 ml-2 mr-2 dark:bg-gray-900 rounded-t-xl overflow-hidden -->\n<div class=\"relative h-[98vh] text-base-content\">\n\t<main class=\"px-4 text-center\">\n\t\t<Welcome />\n\n\t\t<div class=\"mt-5\">\n\t\t\t<Login\n\t\t\t\t{onSuccess}\n\t\t\t\t{onError}\n\t\t\t\t{onCancel}\n\t\t\t\tloginButtonText=\"Unlock\"\n\t\t\t\tcancelButtonText=\"Exit/Logout\"\n\t\t\t/>\n\t\t</div>\n\n\t\t<div id=\"upgrade\" class=\"w-full mt-14\">\n\t\t\t<div class=\"card bg-base-100 shadow-xl image-full animate-pulse\">\n\t\t\t\t<figure><img src=\"/images/logoBullFav128x128.png\" alt=\"upgrade\" /></figure>\n\t\t\t\t<div class=\"card-body\">\n\t\t\t\t\t{#if planType.toLowerCase() === PlanType.YAKKL_PRO.toLowerCase()}\n\t\t\t\t\t\t<h2 class=\"card-title self-center\">PRO!</h2>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tWelcome to our Pro version. We have a lot of additional features waiting on you. We're\n\t\t\t\t\t\t\talso working hard on advanced features to make your digital asset experience a dream!\n\t\t\t\t\t\t\tWe also need your suggestions! Enjoy!\n\t\t\t\t\t\t</p>\n\t\t\t\t\t{:else if planType.toLowerCase() === PlanType.FOUNDING_MEMBER.toLowerCase()}\n\t\t\t\t\t\t<h2 class=\"card-title self-center\">FOUNDING MEMBER!</h2>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tWelcome to our Founding Member version. We have a lot of additional features waiting\n\t\t\t\t\t\t\ton you. We're also working hard on advanced features to make your digital asset\n\t\t\t\t\t\t\texperience a dream! We also need your suggestions! Enjoy!\n\t\t\t\t\t\t</p>\n\t\t\t\t\t{:else if planType.toLowerCase() === PlanType.EARLY_ADOPTER.toLowerCase()}\n\t\t\t\t\t\t<h2 class=\"card-title self-center\">EARLY ADOPTER!</h2>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tWelcome to our Early Adopter version. We have a lot of additional features waiting on\n\t\t\t\t\t\t\tyou. We're also working hard on advanced features to make your digital asset\n\t\t\t\t\t\t\texperience a dream! We also need your suggestions! Enjoy!\n\t\t\t\t\t\t</p>\n\t\t\t\t\t{:else}\n\t\t\t\t\t\t<h2 class=\"card-title self-center\">BASIC MEMBER!</h2>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tWelcome to our free Basic Member version. The core wallet features are waiting on you.\n\t\t\t\t\t\t\tIf you desire more, you can upgrade to our Pro levels. We're also working hard on\n\t\t\t\t\t\t\tadvanced features to make your digital asset experience a dream! We also need your\n\t\t\t\t\t\t\tsuggestions! Enjoy!\n\t\t\t\t\t\t</p>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<Copyright {planType} />\n\t</main>\n</div>\n"],"names":["showError","errorValue","planType","PlanType","BASIC_MEMBER","onSuccess","profile","digest","isMinimal","store_set","yakklUserNameStore","userName","setIconUnlock","syncStorageToStore","contextType","protectedContexts","includes","log","info","startActivityTracking","safeNavigate","PATH_WELCOME","replaceState","invalidateAll","e","error","onError","value","onCancel","safeLogout","onClose","$$value","toLowerCase","YAKKL_PRO","FOUNDING_MEMBER","EARLY_ADOPTER"],"mappings":"ojCAgBK,IAAAA,UAAmB,MACnB,IAAAC,WAAoB,GACpB,IAAAC,SAAkBC,SAASC,aAUtB,SAAAC,UAAUC,QAAkBC,OAAgBC,WAChD,IAEmBC,UAAAC,mBAAAJ,QAAQK,UAAY,IAG1CC,gBACAC,2BAGMC,YAAc,eAChB,GAAAC,kBAAkBC,SAASF,aAAc,CACxCG,IAAAC,0DAA0DJ,eAC9DK,sBAAsBL,iBAChB,CACFG,IAAAC,8DAA8DJ,cACnE,CAGAM,aAAaC,aAAc,EAAA,CAAKC,aAAc,KAAMC,cAAe,MACpE,OAASC,GACJP,IAAAQ,MAAM,yCAA0C,MAAOD,GAC9CvB,WAAAuB,EACDxB,UAAA,IACb,CACD,CAGS,SAAA0B,QAAQC,OACH1B,WAAA0B,MACD3B,UAAA,IACb,UAGS4B,WACRC,YACD,UAGSC,UACI9B,UAAA,MACCC,WAAA,EACd,2HAG0DA,sCAAjC,OAAAD,6BAASA,UAAA+B,6hCAqBzB,GAAA7B,SAAS8B,gBAAkB7B,SAAS8B,UAAUD,cAAW,kfAOpD,SAAA9B,SAAS8B,gBAAkB7B,SAAS+B,gBAAgBF,cAAW,2gBAO/D,SAAA9B,SAAS8B,gBAAkB7B,SAASgC,cAAcH,cAAW"}