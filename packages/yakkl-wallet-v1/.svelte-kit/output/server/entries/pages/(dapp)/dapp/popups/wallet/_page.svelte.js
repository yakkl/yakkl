import{p as push,j as store_set,h as copy_payload,i as assign_payload,c as pop,r as head,a as push_element,m as attr,b as pop_element,e as escape_html,g as stringify,s as store_get,u as unsubscribe_stores}from"../../../../../../chunks/index2.js";import{b as browserSvelte}from"../../../../../../chunks/environment.js";import{p as page}from"../../../../../../chunks/index3.js";import{b as yakklDappConnectRequestStore,_ as DEFAULT_TITLE}from"../../../../../../chunks/encryption.js";import{l as log}from"../../../../../../chunks/Logger.js";import{F as FILENAME}from"../../../../../../chunks/utils.js";import{v as verifySessionToken,s as sessionToken}from"../../../../../../chunks/session.js";import{C as Confirmation}from"../../../../../../chunks/Confirmation.js";import{C as Copyright}from"../../../../../../chunks/Copyright.js";import{F as Failed}from"../../../../../../chunks/Failed.js";import{s as safeLogout}from"../../../../../../chunks/safeNavigate.js";_page[FILENAME]="src/routes/(dapp)/dapp/popups/wallet/+page.svelte";function _page($$payload,$$props){push(_page);var $$store_subs;let showConfirm=false;let showSuccess=false;let showFailure=false;let errorValue="No domain/site name was found. Access to YAKKL® is denied.";let domain="";let domainLogo="";let title=DEFAULT_TITLE;let requestId;let method;let pass=false;let portManager=null;let stream=null;let chainId="";if(browserSvelte){try{requestId=page.url.searchParams.get("requestId");method=page.url.searchParams.get("method");store_set(yakklDappConnectRequestStore,requestId);if(requestId){pass=true}}catch(e){log.error(e);handleReject("No requestId or method was found. Access to YAKKL® is denied.")}}async function handleReject(message="User rejected the request."){try{if(browserSvelte){showConfirm=false;showFailure=false;showSuccess=false;if(stream);}}catch(e){log.error(e)}finally{close()}}async function handleProcess(){try{if(!browserSvelte){await handleReject()}if(!verifySessionToken(store_get($$store_subs??={},"$sessionToken",sessionToken))){await handleReject("Session token is invalid. Login again.")}if(stream);else{await handleReject("Request failed to send to dapp due to connection port not found.")}close()}catch(e){log.error(e);errorValue=e instanceof Error?e.message:"Unknown error occurred";showFailure=true}}async function close(){if(browserSvelte){try{if(portManager);}catch(e){log.warn("Port did not go idle in time",false,e)}safeLogout()}}let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){head($$payload2,$$payload3=>{$$payload3.title=`<title>${escape_html(title)}</title>`});Failed($$payload2,{title:"Failed!",content:errorValue,onReject:handleReject,get show(){return showFailure},set show($$value){showFailure=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e `;Confirmation($$payload2,{title:`Connect to ${stringify(domain)}`,message:`This will connect ${stringify(domain)} to chainId ${stringify(chainId)} and switch your wallet to that network! Do you wish to continue?`,onConfirm:handleProcess,get show(){return showConfirm},set show($$value){showConfirm=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e <div class="flex flex-col h-full max-h-screen overflow-hidden">`;push_element($$payload2,"div",228,0);$$payload2.out+=`<div class="p-4 border-b border-base-300 flex-shrink-0">`;push_element($$payload2,"div",230,1);$$payload2.out+=`<div class="flex items-center justify-between">`;push_element($$payload2,"div",231,2);$$payload2.out+=`<div class="flex items-center gap-2 min-w-0">`;push_element($$payload2,"div",232,3);$$payload2.out+=`<img id="dappImageId" crossorigin="anonymous"${attr("src",domainLogo)} alt="Dapp logo" class="w-8 h-8 rounded-full flex-shrink-0"/>`;push_element($$payload2,"img",233,4);pop_element();$$payload2.out+=` <span class="font-semibold truncate"${attr("title",domain)}>`;push_element($$payload2,"span",240,4);$$payload2.out+=`${escape_html(domain)}</span>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=` <button class="btn btn-ghost btn-sm flex-shrink-0 svelte-fpbg1x" aria-label="Close">`;push_element($$payload2,"button",244,3);$$payload2.out+=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">`;push_element($$payload2,"svg",245,4);$$payload2.out+=`<path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd">`;push_element($$payload2,"path",251,5);$$payload2.out+=`</path>`;pop_element();$$payload2.out+=`</svg>`;pop_element();$$payload2.out+=`</button>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=` <div class="flex-1 p-6 flex flex-col max-w-[428px]">`;push_element($$payload2,"div",262,1);$$payload2.out+=`<div class="text-center mb-4 flex-shrink-0 border-2 border-red-500 rounded-md p-2">`;push_element($$payload2,"div",263,2);$$payload2.out+=`<p class="text-md font-extrabold animate-pulse mb-2">`;push_element($$payload2,"p",264,3);$$payload2.out+=`Important!:</p>`;pop_element();$$payload2.out+=` <span class="text-sm font-bold mb-2">`;push_element($$payload2,"span",265,3);$$payload2.out+=`Allowing another site or app to change the network of your wallet is a security concern.</span>`;pop_element();$$payload2.out+=` <span class="text-sm font-bold mb-2">`;push_element($$payload2,"span",268,3);$$payload2.out+=`You change it back to Mainnet from within the wallet if you desire! Be 100% sure you trust\n\t\t\t\tthe site or app or REJECT this transaction and research more before trying again.</span>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=` <div class="p-4 border-t border-base-300 flex-shrink-0">`;push_element($$payload2,"div",276,1);$$payload2.out+=`<div class="flex gap-4 justify-end">`;push_element($$payload2,"div",277,2);$$payload2.out+=`<button class="btn btn-outline svelte-fpbg1x">`;push_element($$payload2,"button",278,3);$$payload2.out+=`Reject</button>`;pop_element();$$payload2.out+=` <button class="btn btn-primary svelte-fpbg1x">`;push_element($$payload2,"button",279,3);$$payload2.out+=`Approve</button>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=` `;Copyright($$payload2,{});$$payload2.out+=`\x3c!----\x3e`}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);if($$store_subs)unsubscribe_stores($$store_subs);pop()}_page.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};export{_page as default};
//# sourceMappingURL=_page.svelte.js.map
