import{p as push,a as push_element,f as attr_class,m as attr,g as stringify,b as pop_element,e as escape_html,c as pop,s as store_get,u as unsubscribe_stores,F as derived$1,G as spread_attributes,k as bind_props,h as copy_payload,i as assign_payload,H as spread_props,l as prevent_snippet_stringification,v as ensure_array_like,z as maybe_selected,o as store_mutate}from"./index2.js";import{aR as sortedTokens,l as log,aS as toBigInt,a1 as YAKKL_FEE_BASIS_POINTS_DIVISOR,aT as safeConvertToBigInt,a2 as getMiscStore,aU as YAKKL_FEE_BASIS_POINTS,o as getProfile,i as isEncryptedData,j as decryptData,aV as ETH_BASE_SWAP_GAS_UNITS,B as BigNumber,m as yakklCurrentlySelectedStore,Q as YAKKL_ZERO_ADDRESS}from"./encryption.js";import{o as onDestroy}from"./index-server2.js";import{d as derived,w as writable}from"./index.js";import{F as FILENAME}from"./utils.js";import{l as log$1}from"./Logger.js";import"./environment.js";import"./UnifiedTimerManager.js";import{formatPrice,formatQuantity,calculateFeeAmount,formatFeeToUSD,deepCopy}from"./utilities.js";import"./gas.js";import"ethereum-blockies-base64";import{debounce}from"lodash-es";import{b as convertUsdToTokenAmount,d as convertTokenToUsd,p as parseAmount}from"./utils2.js";import"clsx";import{e as createContext,u as useRefById,i as ENTER,S as SPACE,j as getDataRequired,k as getDataChecked,g as getDataDisabled,l as getAriaRequired,o as getAriaChecked,p as getDisabled,s as styleToString,q as getAriaHidden,r as srOnlyStyles,f as useId,n as noop,d as box,m as mergeProps,h as cn}from"./utils3.js";import{M as Modal}from"./Modal2.js";import{ethers}from"ethers-v6";import{g as getTimerManager}from"./TimerManager.js";import debounce$1 from"lodash/debounce.js";import{E as ErrorNoAction}from"./ErrorNoAction.js";import{W as Warning}from"./Warning.js";import{P as PincodeVerify}from"./PincodeVerify.js";import{C as Confirmation}from"./Confirmation.js";import{s as sendNotificationMessage}from"./notifications.js";import"easyqrcodejs";import{C as Copy}from"./Copy.js";TokenDropdown[FILENAME]="src/lib/components/TokenDropdown.svelte";function TokenDropdown($$payload,$$props){push(TokenDropdown);let{selectedToken:selectedToken,disabled:disabled=false,onTokenSelect:onTokenSelect}=$$props;let searchQuery="";derived([sortedTokens],([$sortedTokens])=>searchQuery.trim()?$sortedTokens.filter(token=>token.symbol.toLowerCase().includes(searchQuery.toLowerCase())||token.name.toLowerCase().includes(searchQuery.toLowerCase())):$sortedTokens);function getLogoURL(logoURI){if(!logoURI||logoURI.startsWith("http://")||logoURI.startsWith("ipfs://")){return"/images/logoBullFav32x32.png"}return logoURI}$$payload.out+=`<div class="relative w-full max-w-sm mx-auto">`;push_element($$payload,"div",34,0);$$payload.out+=`<button${attr_class(`w-full flex items-center px-4 py-3 ${stringify(disabled?"bg-gray-500 text-gray-200 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700")} font-bold rounded-full transition duration-300 ease-in-out focus:outline-none`)}${attr("disabled",disabled,true)}>`;push_element($$payload,"button",35,1);if(selectedToken?.symbol&&selectedToken?.name){$$payload.out+="\x3c!--[--\x3e";$$payload.out+=`<img${attr("src",getLogoURL(selectedToken.logoURI))}${attr("alt",selectedToken.name)} class="w-8 h-8 rounded-full"/>`;push_element($$payload,"img",45,3);pop_element();$$payload.out+=` <div class="flex-1 flex flex-col ml-3">`;push_element($$payload,"div",50,3);$$payload.out+=`<span class="font-bold text-lg">`;push_element($$payload,"span",51,4);$$payload.out+=`${escape_html(selectedToken.symbol)}</span>`;pop_element();$$payload.out+=` <span class="text-sm text-gray-200 mt-0.5">`;push_element($$payload,"span",52,4);$$payload.out+=`${escape_html(selectedToken.name)}</span>`;pop_element();$$payload.out+=`</div>`;pop_element()}else{$$payload.out+="\x3c!--[!--\x3e";$$payload.out+=`<span class="ml-3">`;push_element($$payload,"span",55,3);$$payload.out+=`Select Token</span>`;pop_element()}$$payload.out+=`\x3c!--]--\x3e <svg xmlns="http://www.w3.org/2000/svg" class="ml-auto h-5 w-5 transition-transform duration-300" viewBox="0 0 20 20" fill="currentColor">`;push_element($$payload,"svg",57,2);$$payload.out+=`<path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd">`;push_element($$payload,"path",63,3);$$payload.out+=`</path>`;pop_element();$$payload.out+=`</svg>`;pop_element();$$payload.out+=`</button>`;pop_element();$$payload.out+=` `;{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e</div>`;pop_element();pop()}TokenDropdown.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};const isUsdModeStore=writable(false);SwapTokenPrice[FILENAME]="src/lib/components/SwapTokenPrice.svelte";function SwapTokenPrice($$payload,$$props){push(SwapTokenPrice);var $$store_subs;let isUsdMode=isUsdModeStore;let{swapPriceDataStore:swapPriceDataStore,type:type="sell",showLastUpdated:showLastUpdated=false,className:className=""}=$$props;let price=0;let amount=0n;let decimals=0;function getSymbolPair(){const inSymbol=swapPriceData.tokenIn?.symbol||"";const outSymbol=swapPriceData.tokenOut?.symbol||"";return inSymbol&&outSymbol?`${inSymbol}/${outSymbol}`:""}let swapPriceData=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore);$$payload.out+=`<div${attr_class(`flex flex-col w-full gap-1 ${stringify(className)}`)}>`;push_element($$payload,"div",61,0);$$payload.out+=`<div class="flex justify-between items-center w-full">`;push_element($$payload,"div",62,1);$$payload.out+=`<div class="flex items-center gap-2">`;push_element($$payload,"div",63,2);$$payload.out+=`<span class="text-sm text-gray-600">`;push_element($$payload,"span",64,3);$$payload.out+=`${escape_html(getSymbolPair())}</span>`;pop_element();$$payload.out+=` <span class="text-sm font-semibold">`;push_element($$payload,"span",65,3);$$payload.out+=`${escape_html(isUsdMode?`${formatPrice(price)}`:`${formatQuantity(amount,decimals)}`)}</span>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=` <div class="flex justify-between items-center w-full text-xs text-gray-500">`;push_element($$payload,"div",71,1);{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload.out+=`</div>`;pop_element();if($$store_subs)unsubscribe_stores($$store_subs);pop()}SwapTokenPrice.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};const ROOT_ATTR="data-switch-root";const THUMB_ATTR="data-switch-thumb";class SwitchRootState{#id;#ref;checked;disabled;required;name;value;constructor(props){this.checked=props.checked;this.disabled=props.disabled;this.required=props.required;this.name=props.name;this.value=props.value;this.#id=props.id;this.#ref=props.ref;useRefById({id:this.#id,ref:this.#ref});this.onkeydown=this.onkeydown.bind(this);this.onclick=this.onclick.bind(this)}#toggle(){this.checked.current=!this.checked.current}onkeydown(e){if(!(e.key===ENTER||e.key===SPACE)||this.disabled.current)return;e.preventDefault();this.#toggle()}onclick(_){if(this.disabled.current)return;this.#toggle()}#sharedProps=derived$1(()=>({"data-disabled":getDataDisabled(this.disabled.current),"data-state":getDataChecked(this.checked.current),"data-required":getDataRequired(this.required.current)}));get sharedProps(){return this.#sharedProps()}set sharedProps($$value){return this.#sharedProps($$value)}#props=derived$1(()=>({...this.sharedProps,id:this.#id.current,role:"switch",disabled:getDisabled(this.disabled.current),"aria-checked":getAriaChecked(this.checked.current),"aria-required":getAriaRequired(this.required.current),[ROOT_ATTR]:"",onclick:this.onclick,onkeydown:this.onkeydown}));get props(){return this.#props()}set props($$value){return this.#props($$value)}}class SwitchInputState{#root;#shouldRender=derived$1(()=>this.#root.name.current!==void 0);get shouldRender(){return this.#shouldRender()}set shouldRender($$value){return this.#shouldRender($$value)}constructor(root){this.#root=root}#props=derived$1(()=>({type:"checkbox",name:this.#root.name.current,value:this.#root.value.current,checked:this.#root.checked.current,disabled:this.#root.disabled.current,required:this.#root.required.current,"aria-hidden":getAriaHidden(true),style:styleToString(srOnlyStyles)}));get props(){return this.#props()}set props($$value){return this.#props($$value)}}class SwitchThumbState{#id;#ref;root;constructor(props,root){this.root=root;this.#id=props.id;this.#ref=props.ref;useRefById({id:this.#id,ref:this.#ref})}#props=derived$1(()=>({...this.root.sharedProps,id:this.#id.current,[THUMB_ATTR]:""}));get props(){return this.#props()}set props($$value){return this.#props($$value)}}const[setSwitchRootContext,getSwitchRootContext]=createContext("Switch.Root");function useSwitchRoot(props){return setSwitchRootContext(new SwitchRootState(props))}function useSwitchInput(){return new SwitchInputState(getSwitchRootContext())}function useSwitchThumb(props){return new SwitchThumbState(props,getSwitchRootContext())}Switch_input[FILENAME]="/Users/hansjones/projects/lambdastack/yakkl/crypto/yakkl/node_modules/.pnpm/bits-ui@1.0.0-next.74_svelte@5.34.3/node_modules/bits-ui/dist/bits/switch/components/switch-input.svelte";function Switch_input($$payload,$$props){push(Switch_input);const inputState=useSwitchInput();if(inputState.shouldRender){$$payload.out+="\x3c!--[--\x3e";$$payload.out+=`<input${spread_attributes({...inputState.props})}/>`;push_element($$payload,"input",6,1);pop_element()}else{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e`;pop()}Switch_input.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};Switch$1[FILENAME]="/Users/hansjones/projects/lambdastack/yakkl/crypto/yakkl/node_modules/.pnpm/bits-ui@1.0.0-next.74_svelte@5.34.3/node_modules/bits-ui/dist/bits/switch/components/switch.svelte";function Switch$1($$payload,$$props){push(Switch$1);let{child:child,children:children,ref:ref=null,id:id=useId(),disabled:disabled=false,required:required=false,checked:checked=false,value:value="on",name:name=void 0,type:type="button",onCheckedChange:onCheckedChange=noop,controlledChecked:controlledChecked=false,$$slots:$$slots,$$events:$$events,...restProps}=$$props;const rootState=useSwitchRoot({checked:box.with(()=>checked,v=>{if(controlledChecked){onCheckedChange(v)}else{checked=v;onCheckedChange?.(v)}}),disabled:box.with(()=>disabled??false),required:box.with(()=>required),value:box.with(()=>value),name:box.with(()=>name),id:box.with(()=>id),ref:box.with(()=>ref,v=>ref=v)});const mergedProps=mergeProps(restProps,rootState.props,{type:type});if(child){$$payload.out+="\x3c!--[--\x3e";child($$payload,{props:mergedProps,checked:rootState.checked.current});$$payload.out+=`\x3c!----\x3e`}else{$$payload.out+="\x3c!--[!--\x3e";$$payload.out+=`<button${spread_attributes({...mergedProps})}>`;push_element($$payload,"button",49,1);children?.($$payload,{checked:rootState.checked.current});$$payload.out+=`\x3c!----\x3e</button>`;pop_element()}$$payload.out+=`\x3c!--]--\x3e `;Switch_input($$payload);$$payload.out+=`\x3c!----\x3e`;bind_props($$props,{ref:ref,checked:checked});pop()}Switch$1.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};Switch_thumb[FILENAME]="/Users/hansjones/projects/lambdastack/yakkl/crypto/yakkl/node_modules/.pnpm/bits-ui@1.0.0-next.74_svelte@5.34.3/node_modules/bits-ui/dist/bits/switch/components/switch-thumb.svelte";function Switch_thumb($$payload,$$props){push(Switch_thumb);let{child:child,children:children,ref:ref=null,id:id=useId(),$$slots:$$slots,$$events:$$events,...restProps}=$$props;const thumbState=useSwitchThumb({id:box.with(()=>id),ref:box.with(()=>ref,v=>ref=v)});const mergedProps=mergeProps(restProps,thumbState.props);if(child){$$payload.out+="\x3c!--[--\x3e";child($$payload,{props:mergedProps,checked:thumbState.root.checked.current});$$payload.out+=`\x3c!----\x3e`}else{$$payload.out+="\x3c!--[!--\x3e";$$payload.out+=`<span${spread_attributes({...mergedProps})}>`;push_element($$payload,"span",24,1);children?.($$payload,{checked:thumbState.root.checked.current});$$payload.out+=`\x3c!----\x3e</span>`;pop_element()}$$payload.out+=`\x3c!--]--\x3e`;bind_props($$props,{ref:ref});pop()}Switch_thumb.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};Switch[FILENAME]="src/lib/components/ui/switch/switch.svelte";function Switch($$payload,$$props){push(Switch);let{ref:ref=null,class:className,checked:checked=false,$$slots:$$slots,$$events:$$events,...restProps}=$$props;let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){$$payload2.out+=`\x3c!----\x3e`;Switch$1($$payload2,spread_props([{class:cn("focus-visible:ring-ring focus-visible:ring-offset-background data-[state=checked]:bg-primary data-[state=unchecked]:bg-input peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",className)},restProps,{get ref(){return ref},set ref($$value){ref=$$value;$$settled=false},get checked(){return checked},set checked($$value){checked=$$value;$$settled=false},children:prevent_snippet_stringification($$payload3=>{$$payload3.out+=`\x3c!----\x3e`;Switch_thumb($$payload3,{class:cn("bg-slate-200 pointer-events-none block h-4 w-4 rounded-full shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")});$$payload3.out+=`\x3c!----\x3e`}),$$slots:{default:true}}]));$$payload2.out+=`\x3c!----\x3e`}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);bind_props($$props,{ref:ref,checked:checked});pop()}Switch.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};ToggleSwitch[FILENAME]="src/lib/components/ToggleSwitch.svelte";function ToggleSwitch($$payload,$$props){push(ToggleSwitch);let{value:value,labelOn:labelOn="USD",labelOff:labelOff="Token",disabled:disabled=false,onChange:onChange,$$slots:$$slots,$$events:$$events,...rest}=$$props;let checked=value;let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){$$payload2.out+=`<div class="flex items-center">`;push_element($$payload2,"div",18,0);$$payload2.out+=`<span class="mr-2 text-sm w-10">`;push_element($$payload2,"span",19,1);$$payload2.out+=`${escape_html(checked?labelOn:labelOff)}</span>`;pop_element();$$payload2.out+=` `;Switch($$payload2,{class:"peer inline-flex h-6 w-10 cursor-pointer items-center rounded-full border-2 border-purple-600 shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",disabled:disabled,get checked(){return checked},set checked($$value){checked=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e</div>`;pop_element()}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);pop()}ToggleSwitch.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};NumericInput[FILENAME]="src/lib/components/NumericInput.svelte";function NumericInput($$payload,$$props){push(NumericInput);const{value:value="",placeholder:placeholder="0",disabled:disabled=false,errorClass:errorClass="",className:className="",onChange:onChange=value2=>{},onBlur:onBlur=value2=>{}}=$$props;let inputValue=value||"";$$payload.out+=`<input type="text"${attr("placeholder",placeholder)}${attr("disabled",disabled,true)}${attr("value",inputValue)}${attr_class(`${stringify(className)} ${stringify(errorClass)}`)}/>`;push_element($$payload,"input",29,0);pop_element();pop()}NumericInput.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};SellTokenPanel[FILENAME]="src/lib/components/SellTokenPanel.svelte";function SellTokenPanel($$payload,$$props){push(SellTokenPanel);var $$store_subs;let{disabled:disabled=false,resetValues:resetValues=false,insufficientBalance:insufficientBalance=false,balance:balance="0",swapPriceDataStore:swapPriceDataStore,onTokenSelect:onTokenSelect,onAmountChange:onAmountChange,lastModifiedPanel:lastModifiedPanel="sell"}=$$props;let tokenValue="";let usdValue="";let displayValue="";const debouncedAmountChange=debounce(value=>{onAmountChange(value)},300);function handleAmountInput(value){lastModifiedPanel="sell";const marketPrice=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).marketPriceIn||0;if(!value){tokenValue="";usdValue="";displayValue="";debouncedAmountChange("");return}if(store_get($$store_subs??={},"$isUsdModeStore",isUsdModeStore)){usdValue=value;if(marketPrice>0){try{const calculatedTokenAmount=convertUsdToTokenAmount(Number(value),marketPrice,store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).tokenIn.decimals);tokenValue=calculatedTokenAmount.toString();debouncedAmountChange(tokenValue)}catch(error){log.error("USD to Token conversion error:",false,error);debouncedAmountChange("")}}}else{tokenValue=value;if(marketPrice>0){try{const calculatedUsdAmount=convertTokenToUsd(Number(value),marketPrice);usdValue=calculatedUsdAmount.toString()}catch(error){log.error("Token to USD conversion error:",false,error)}}debouncedAmountChange(value)}}function handleTokenSelection(token){tokenValue="";usdValue="";displayValue="";onTokenSelect(token)}function handleBlur(value){}$$payload.out+=`<div${attr_class(`border border-gray-300 shadow-md p-4 rounded-lg bg-gray-50 dark:bg-gray-800 ${stringify(disabled?" opacity-50 pointer-events-none":"")}`)}>`;push_element($$payload,"div",122,0);$$payload.out+=`<div class="flex justify-between items-center">`;push_element($$payload,"div",126,1);NumericInput($$payload,{value:displayValue,onChange:handleAmountInput,onBlur:handleBlur,disabled:disabled,className:`\n        bg-transparent\n        text-3xl\n        font-bold\n        w-1/2\n        mr-4\n        focus:outline-none\n        focus:border-b-2\n        focus:border-blue-500\n        ${stringify(insufficientBalance?"text-red-500 dark:text-red-400 ":"text-black dark:text-white ")}\n        ${stringify(disabled?"cursor-not-allowed":"")}\n      `});$$payload.out+=`\x3c!----\x3e `;TokenDropdown($$payload,{disabled:disabled,selectedToken:store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).tokenIn,onTokenSelect:handleTokenSelection});$$payload.out+=`\x3c!----\x3e</div>`;pop_element();$$payload.out+=` <div class="flex justify-between items-center mt-2 text-sm">`;push_element($$payload,"div",151,1);$$payload.out+=`<div class="flex items-center">`;push_element($$payload,"div",152,2);ToggleSwitch($$payload,{value:store_get($$store_subs??={},"$isUsdModeStore",isUsdModeStore),labelOn:"USD",labelOff:"Token",className:"bg-purple-300",onChange:value=>isUsdModeStore.set(value)});$$payload.out+=`\x3c!----\x3e</div>`;pop_element();$$payload.out+=` <div class="flex flex-col items-end text-right">`;push_element($$payload,"div",161,2);SwapTokenPrice($$payload,{swapPriceDataStore:swapPriceDataStore,type:"sell"});$$payload.out+=`\x3c!----\x3e <span>`;push_element($$payload,"span",163,3);$$payload.out+=`Balance: ${escape_html(balance)}</span>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=` `;if(insufficientBalance){$$payload.out+="\x3c!--[--\x3e";$$payload.out+=`<div class="text-red-500 dark:text-red-400 text-sm mt-1">`;push_element($$payload,"div",167,2);$$payload.out+=`Insufficient balance for this swap</div>`;pop_element()}else{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e</div>`;pop_element();if($$store_subs)unsubscribe_stores($$store_subs);bind_props($$props,{resetValues:resetValues,lastModifiedPanel:lastModifiedPanel});pop()}SellTokenPanel.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};BuyTokenPanel[FILENAME]="src/lib/components/BuyTokenPanel.svelte";function BuyTokenPanel($$payload,$$props){push(BuyTokenPanel);var $$store_subs;let{disabled:disabled=false,resetValues:resetValues=false,swapPriceDataStore:swapPriceDataStore,onTokenSelect:onTokenSelect,onAmountChange:onAmountChange,lastModifiedPanel:lastModifiedPanel="sell"}=$$props;let userInput="";let formattedAmount="";const debouncedAmountChange=debounce(value=>{onAmountChange(value)},300);function handleAmountInput(value){lastModifiedPanel="buy";if(!value){userInput="";formattedAmount="";debouncedAmountChange("");return}userInput=value;formattedAmount=value;debouncedAmountChange(value)}function handleTokenSelection(token){userInput="";formattedAmount="";onTokenSelect(token)}function handleBlur(value){if(!value){userInput="";formattedAmount=""}}$$payload.out+=`<div${attr_class(`border border-gray-300 shadow-md p-4 rounded-lg bg-gray-50 dark:bg-gray-800 ${stringify(disabled?" opacity-50 pointer-events-none":"")}`)}>`;push_element($$payload,"div",64,0);$$payload.out+=`<div class="flex justify-between items-center">`;push_element($$payload,"div",68,1);NumericInput($$payload,{value:userInput||formattedAmount,onChange:handleAmountInput,onBlur:handleBlur,disabled:disabled,className:`\n        bg-transparent\n        text-3xl\n        font-bold\n        w-1/2\n        mr-4\n        focus:outline-none\n        focus:border-b-2\n        focus:border-blue-500\n        text-black dark:text-white\n        ${stringify(disabled?"cursor-not-allowed":"")}\n      `});$$payload.out+=`\x3c!----\x3e `;TokenDropdown($$payload,{disabled:disabled,selectedToken:store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).tokenOut,onTokenSelect:handleTokenSelection});$$payload.out+=`\x3c!----\x3e</div>`;pop_element();$$payload.out+=` <div class="flex justify-between items-center mt-2 text-sm">`;push_element($$payload,"div",93,1);SwapTokenPrice($$payload,{swapPriceDataStore:swapPriceDataStore,type:"buy"});$$payload.out+=`\x3c!----\x3e</div>`;pop_element();$$payload.out+=`</div>`;pop_element();if($$store_subs)unsubscribe_stores($$store_subs);bind_props($$props,{resetValues:resetValues,lastModifiedPanel:lastModifiedPanel});pop()}BuyTokenPanel.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};SwapSettings[FILENAME]="src/lib/components/SwapSettings.svelte";function SwapSettings($$payload,$$props){push(SwapSettings);var $$store_subs;let{swapPriceDataStore:swapPriceDataStore,onSlippageChange:onSlippageChange,onDeadlineChange:onDeadlineChange,onPoolFeeChange:onPoolFeeChange,className:className="text-gray-700"}=$$props;const slippageOptions=[.1,.5,1,3];const deadlineOptions=[10,20,30,60];const poolFeeOptions=[500,3e3,1e4];store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore);let slippageTolerance=.5;let deadline=10;let poolFee=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).fee||3e3;const each_array=ensure_array_like(slippageOptions);const each_array_1=ensure_array_like(deadlineOptions);const each_array_2=ensure_array_like(poolFeeOptions);$$payload.out+=`<div${attr_class(`flex justify-between items-center space-x-4 ${stringify(className)}`)}>`;push_element($$payload,"div",55,0);$$payload.out+=`<div>`;push_element($$payload,"div",56,1);$$payload.out+=`<label for="slippage" class="block text-sm font-medium">`;push_element($$payload,"label",57,2);$$payload.out+=`Slippage</label>`;pop_element();$$payload.out+=` <select id="slippage" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">`;push_element($$payload,"select",58,2);$$payload.select_value=slippageTolerance;$$payload.out+=`\x3c!--[--\x3e`;for(let $$index=0,$$length=each_array.length;$$index<$$length;$$index++){let option=each_array[$$index];$$payload.out+=`<option${attr("value",option)}${maybe_selected($$payload,option)}>`;push_element($$payload,"option",65,4);$$payload.out+=`${escape_html(option)}%</option>`;pop_element()}$$payload.out+=`\x3c!--]--\x3e`;$$payload.select_value=void 0;$$payload.out+=`</select>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=` <div>`;push_element($$payload,"div",70,1);$$payload.out+=`<label for="deadline" class="block text-sm font-medium">`;push_element($$payload,"label",71,2);$$payload.out+=`Deadline</label>`;pop_element();$$payload.out+=` <select id="deadline" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">`;push_element($$payload,"select",72,2);$$payload.select_value=deadline;$$payload.out+=`\x3c!--[--\x3e`;for(let $$index_1=0,$$length=each_array_1.length;$$index_1<$$length;$$index_1++){let option=each_array_1[$$index_1];$$payload.out+=`<option${attr("value",option)}${maybe_selected($$payload,option)}>`;push_element($$payload,"option",79,4);$$payload.out+=`${escape_html(option)} minutes</option>`;pop_element()}$$payload.out+=`\x3c!--]--\x3e`;$$payload.select_value=void 0;$$payload.out+=`</select>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=` <div>`;push_element($$payload,"div",84,1);$$payload.out+=`<label for="poolFee" class="block text-sm font-medium">`;push_element($$payload,"label",85,2);$$payload.out+=`Pool Fee</label>`;pop_element();$$payload.out+=` <select id="poolFee" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">`;push_element($$payload,"select",86,2);$$payload.select_value=poolFee;$$payload.out+=`\x3c!--[--\x3e`;for(let $$index_2=0,$$length=each_array_2.length;$$index_2<$$length;$$index_2++){let option=each_array_2[$$index_2];$$payload.out+=`<option${attr("value",option)}${maybe_selected($$payload,option)}>`;push_element($$payload,"option",93,4);$$payload.out+=`${escape_html(option/1e4)}%</option>`;pop_element()}$$payload.out+=`\x3c!--]--\x3e`;$$payload.select_value=void 0;$$payload.out+=`</select>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=`</div>`;pop_element();if($$store_subs)unsubscribe_stores($$store_subs);pop()}SwapSettings.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};SwapSummary[FILENAME]="src/lib/components/SwapSummary.svelte";function SwapSummary($$payload,$$props){push(SwapSummary);var $$store_subs;let{swapPriceDataStore:swapPriceDataStore,disabled:disabled=false}=$$props;let feeBasisPointsToPercent="0.0000%";let swapPriceData=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore);let tokenOutPriceInUSD=swapPriceData.tokenOutPriceInUSD||"--";let gasEstimateInUSD=swapPriceData.gasEstimateInUSD||"--";let feeAmountInUSD=(()=>{if(swapPriceData&&toBigInt(swapPriceData.amountIn)>0n&&swapPriceData.marketPriceIn>0&&swapPriceData.tokenIn&&swapPriceData.tokenIn.decimals&&swapPriceData.feeBasisPoints&&disabled===false){swapPriceData.feeBasisPoints/YAKKL_FEE_BASIS_POINTS_DIVISOR;const feeAmount=calculateFeeAmount(toBigInt(swapPriceData.amountIn),swapPriceData.feeBasisPoints);return formatFeeToUSD(feeAmount,swapPriceData.tokenIn.decimals,swapPriceData.marketPriceIn)}else{return disabled?"":"Calculating..."}})();$$payload.out+=`<div class="space-y-2 text-sm text-gray-500">`;push_element($$payload,"div",58,0);if(!disabled){$$payload.out+="\x3c!--[--\x3e";$$payload.out+=`<div class="flex justify-between w-full">`;push_element($$payload,"div",61,2);$$payload.out+=`<span class="text-left truncate">`;push_element($$payload,"span",62,3);{$$payload.out+="\x3c!--[!--\x3e";$$payload.out+=`Exchange Rate: ~N/A~`}$$payload.out+=`\x3c!--]--\x3e</span>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=` <div class="flex justify-between w-full">`;push_element($$payload,"div",73,2);$$payload.out+=`<span class="text-left truncate">`;push_element($$payload,"span",74,3);$$payload.out+=`Token Price (USD): ${escape_html(tokenOutPriceInUSD)}</span>`;pop_element();$$payload.out+=`</div>`;pop_element()}else{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e <div class="flex justify-between items-center w-full">`;push_element($$payload,"div",81,1);$$payload.out+=`<div class="flex items-center space-x-2">`;push_element($$payload,"div",82,2);$$payload.out+=`<img src="/images/gas.svg" alt="Gas Estimate" class="w-3 h-3"/>`;push_element($$payload,"img",83,3);pop_element();$$payload.out+=` <span>`;push_element($$payload,"span",84,3);$$payload.out+=`Gas Fee ≈ ${escape_html(gasEstimateInUSD)}</span>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=` `;if(!disabled){$$payload.out+="\x3c!--[--\x3e";$$payload.out+=`<div class="flex justify-between w-full">`;push_element($$payload,"div",90,2);$$payload.out+=`<span class="text-left truncate">`;push_element($$payload,"span",91,3);$$payload.out+=`Fee (${escape_html(feeBasisPointsToPercent)}): ≈ ${escape_html(feeAmountInUSD)}</span>`;pop_element();$$payload.out+=`</div>`;pop_element()}else{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e</div>`;pop_element();if($$store_subs)unsubscribe_stores($$store_subs);pop()}SwapSummary.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};class Token{address;name;symbol;decimals;logoURI;description;chainId;isNative;isStablecoin;blockchain;provider;privateKey;url;balance=0n;constructor(address,name,symbol,decimals,logoURI,description,chainId,isNative,isStablecoin,blockchain,provider,balance,privateKey,url){this.address=address;this.name=name;this.symbol=symbol;this.decimals=decimals;this.logoURI=logoURI;this.description=description||`${name} token`;this.chainId=chainId||1;this.isNative=isNative||false;this.isStablecoin=isStablecoin||false;this.blockchain=blockchain;this.provider=provider;this.balance=balance||0n;this.privateKey=privateKey||"";this.url=url||""}toJSON(){return{address:this.address,name:this.name,symbol:this.symbol,decimals:this.decimals,balance:this.balance?.toString(),logoURI:this.logoURI,description:this.description,chainId:this.chainId,isNative:this.isNative,isStablecoin:this.isStablecoin,url:this.url}}static fromSwapToken(swapToken,blockchain,provider,privateKey){return new ConcreteToken(swapToken.address,swapToken.name,swapToken.symbol,swapToken.decimals,swapToken.logoURI||"",swapToken.description||`${swapToken.name} token`,swapToken.chainId,swapToken.isNative||false,swapToken.isStablecoin||false,blockchain,provider,swapToken.balance||0n,privateKey,swapToken.url||"")}}class ConcreteToken extends Token{async getContract(){return this.blockchain.createContract(this.address,["function balanceOf(address account) view returns (uint256)","function transfer(address to, uint256 amount) returns (bool)"])}async getBalance(userAddress){const contract=await this.getContract();if(!contract)return 0n;this.balance=await contract.call("balanceOf",userAddress);return this.balance}async transfer(toAddress,amount){const contract=await this.getContract();if(!contract)throw new Error("Invalid contract");return await contract.sendTransaction("transfer",toAddress,amount)}}function shouldShowErrorToUser(error){const errorMessage=error?.message||error?.toString()||"";const networkErrors=["missing response","timeout","TIMEOUT","SERVER_ERROR","NETWORK_ERROR","Failed to fetch","fetch","Connection failed","Request timeout","eth_getBalance","call revert exception","alchemy.com","infura.io","requestBody","serverError","code=SERVER_ERROR","version=web/","JsonRpcError","RPC Error","getBalance","Balance fetch"];return!networkErrors.some(pattern=>errorMessage.toLowerCase().includes(pattern.toLowerCase()))}async function getTokenBalance(token,address,provider,tokenService){try{if(!token)return 0n;if(token.isNative){if(!provider)return 0n;const retBal2=await provider.getBalance(address);token.balance=retBal2;const{balanceCacheManager:balanceCacheManager}=await import("./BalanceCacheManager.js");const{yakklPricingStore:yakklPricingStore}=await import("./encryption.js").then(n=>n.b3);const{get:get}=await import("./index-server.js");const currentPrice=get(yakklPricingStore)?.price;if(currentPrice){balanceCacheManager.setCachedBalance(address,retBal2,currentPrice)}return retBal2}if(!tokenService)return 0n;const retBal=await tokenService.getBalance(token.address,address);token.balance=retBal;return retBal}catch(error){if(shouldShowErrorToUser(error)){log$1.error("getTokenBalance - error",false,error)}return 0n}}function validateObject(data,rules){const validateValue=(value,rule)=>{if(value===void 0||value===null){return!rule.required}let bigIntValue;if(rule.type){switch(rule.type){case"number":if(typeof value!=="number"||isNaN(value))return false;break;case"bigint":case"bignumberish":bigIntValue=safeConvertToBigInt(value);if(bigIntValue===void 0)return false;value=bigIntValue;break;case"string":if(typeof value!=="string")return false;break;case"boolean":if(typeof value!=="boolean")return false;break;case"array":if(!Array.isArray(value))return false;break;case"object":if(typeof value!=="object"||value===null)return false;break}}if(rule.min!==void 0){if(typeof rule.min==="number"&&value<rule.min)return false;if(rule.type==="bigint"||rule.type==="bignumberish"){const minBigInt=safeConvertToBigInt(rule.min);const valueBigInt=safeConvertToBigInt(value);if(minBigInt===void 0||valueBigInt===void 0)return false;if(valueBigInt<minBigInt)return false}}if(rule.max!==void 0){if(typeof rule.max==="number"&&value>rule.max)return false;if(rule.type==="bigint"||rule.type==="bignumberish"){const maxBigInt=safeConvertToBigInt(rule.max);const valueBigInt=safeConvertToBigInt(value);if(maxBigInt===void 0||valueBigInt===void 0)return false;if(valueBigInt>maxBigInt)return false}}if(rule.equals!==void 0&&value!==rule.equals)return false;if(rule.notEquals!==void 0&&value===rule.notEquals)return false;if(rule.oneOf!==void 0&&!rule.oneOf.includes(value))return false;if(rule.notOneOf!==void 0&&rule.notOneOf.includes(value))return false;if(rule.customValidation&&!rule.customValidation(value))return false;return true};for(const[key,rule]of Object.entries(rules)){const value=data[key];if(!validateValue(value,rule)){let errorMessage=`Invalid ${key}: `;if(value===void 0||value===null){errorMessage+=rule.required?"is required":"is missing but not required"}else{const currentRule=rule;if(currentRule.min!==void 0)errorMessage+=`must be at least ${currentRule.min}`;if(currentRule.max!==void 0)errorMessage+=`must be at most ${currentRule.max}`;if(currentRule.equals!==void 0)errorMessage+=`must equal ${currentRule.equals}`;if(currentRule.notEquals!==void 0)errorMessage+=`cannot equal ${currentRule.notEquals}`;if(currentRule.oneOf!==void 0)errorMessage+=`must be one of ${currentRule.oneOf.join(", ")}`;if(currentRule.notOneOf!==void 0)errorMessage+=`cannot be one of ${currentRule.notOneOf.join(", ")}`}return{isValid:false,error:errorMessage}}}return{isValid:true,error:""}}function validateSwapQuote(quote){return validateObject(quote,{amountIn:{required:true,type:"bignumberish",min:0n,customValidation:amount=>{const bigIntAmount=safeConvertToBigInt(amount);return bigIntAmount!==void 0&&bigIntAmount>0n}},amountOut:{required:true,type:"bignumberish",min:0n,customValidation:amount=>{const bigIntAmount=safeConvertToBigInt(amount);return bigIntAmount!==void 0&&bigIntAmount>0n}},tokenIn:{required:true,type:"object",customValidation:token=>!!(token&&token.address&&token.symbol)},tokenOut:{required:true,type:"object",customValidation:token=>!!(token&&token.address&&token.symbol)},fee:{oneOf:[500,3e3,1e4]}})}Swap[FILENAME]="src/lib/components/Swap.svelte";function Swap($$payload,$$props){push(Swap);var $$store_subs;let{fundingAddress:fundingAddress,provider:provider,blockchain:blockchain,swapManager:swapManager,tokenService:tokenService,show:show=false,className:className="text-gray-600 z-[699]",onSwap:onSwap=()=>{}}=$$props;const SUPPORTED_STABLECOINS=["USDC","USDT","DAI","BUSD"];let gasToken=void 0;let initialToken={chainId:1,address:"",name:"",symbol:"",decimals:0,balance:0n,logoURI:"",isNative:false,isStablecoin:false};const initialSwapPriceData={provider:"Uniswap V3",lastUpdated:new Date,chainId:1,tokenIn:initialToken,tokenOut:initialToken,quoteAmount:0n,fundingAddress:"",feeAmount:0n,amountAfterFee:0n,amountIn:0n,amountOut:0n,exchangeRate:0n,marketPriceIn:0,marketPriceOut:0,marketPriceGas:0,priceImpactRatio:0,path:[],fee:0,feeBasisPoints:YAKKL_FEE_BASIS_POINTS,feeAmountPrice:0,feeAmountInUSD:"",gasEstimate:0n,gasEstimateInUSD:"",tokenOutPriceInUSD:"",multiHop:false,slippageTolerance:.5,deadline:10,error:null,isLoading:false};const swapPriceDataStore=writable(initialSwapPriceData);const insufficientBalanceStore=writable(false);let swapStateStore=writable({tokenIn:initialToken,tokenOut:initialToken,fromAmount:"",toAmount:"",fromBalance:"0",error:"",deadline:10,slippageTolerance:.5,poolFee:3e3,multiHop:false});let uiStateStore=writable({resetValues:false,isLoading:false,isSwapping:false});let lastModifiedPanel="sell";let swapManagerName="";let isEthWethSwap=false;let showVerify=false;let showError=false;let errorValue="";let showWarning=false;let warningValue="";let showConfirmation=false;let pincodeVerified=false;onDestroy(()=>{const yakklMiscStore=getMiscStore();if(yakklMiscStore){getTimerManager().stopTimer("swap_fetchPrices");debouncedGetQuote.cancel();debouncedCheckBalance.cancel();debouncedGetMarketPrice.cancel();reset()}});derived([swapStateStore],([$swapStateStore2])=>{const{deadline:deadline,slippageTolerance:slippageTolerance,poolFee:poolFee}=$swapStateStore2;return{deadline:deadline,slippageTolerance:slippageTolerance,poolFee:poolFee}});const debouncedGetQuote=debounce$1(async()=>{await getQuote()},300);const debouncedCheckBalance=debounce$1(checkBalance,300);debounce$1(async()=>{const price=await gasToken.getMarketPrice();if(store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).marketPriceGas===0){updateSwapPriceData({marketPriceGas:price.price})}},500);const debouncedGetMarketPrice=debounce$1(async token=>{const price=await swapManager.getMarketPrice(`${token.symbol}-USD`);if(price.price>0){updateSwapPriceData({marketPriceIn:price.price})}},500);async function handleSellAmountChange(amount){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="");store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount=amount);lastModifiedPanel="sell";if(amount!=="."&&isNaN(parseFloat(amount))){log.info("Swap - Invalid sell amount:",false,amount);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount="");updateSwapPriceData({amountIn:0n,amountOut:0n});return}try{const parsedAmount=parseAmount(amount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals);updateSwapPriceData({amountIn:parsedAmount});if(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn&&store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut){await getQuote(true)}}catch(error){log.error("Error handling sell amount change:",false,error);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="Failed to process sell amount")}}async function handleBuyAmountChange(amount){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="");store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount=amount);lastModifiedPanel="buy";if(amount!=="."&&isNaN(parseFloat(amount))){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount="");updateSwapPriceData({amountOut:0n});return}try{const parsedAmount=parseAmount(amount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut.decimals);updateSwapPriceData({amountOut:parsedAmount});if(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn&&store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut)await getQuote(false)}catch(error){log.error("Error handling buy amount change:",false,error);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="Failed to process buy amount")}}async function handleTokenSelect(token,type){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="");const otherToken=type==="sell"?store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut:store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn;if(otherToken.symbol&&areTokensEqual(token,otherToken)){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=`Cannot swap ${token.symbol} for itself`);return}if(token.isStablecoin||SUPPORTED_STABLECOINS.includes(token.symbol)){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee=500);token.isStablecoin=true;updateSwapPriceData({fee:store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee})}if(!token.balance||toBigInt(token.balance)<=0n){token.balance=await getTokenBalance(token,fundingAddress,provider,tokenService)}const formattedBalance=ethers.formatUnits(toBigInt(token.balance),token.decimals);if(type==="sell"){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn=token);updateSwapPriceData({tokenIn:token});store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromBalance=formattedBalance)}else{store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut=token);updateSwapPriceData({tokenOut:token})}if(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn&&store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut){if(lastModifiedPanel==="sell"&&store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount){await handleSellAmountChange(store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount)}else if(lastModifiedPanel==="buy"&&store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount){await handleBuyAmountChange(store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount)}}}function updateSwapPriceData(newData){swapPriceDataStore.update(currentData=>({...currentData,...newData}))}async function checkBalance(token,amount,fundingAddress2){try{if(!token||!amount||!fundingAddress2){insufficientBalanceStore.set(false);return false}const balance=await getTokenBalance(token,fundingAddress2,provider,tokenService);const formattedBalance=ethers.formatUnits(balance,token.decimals);if(formattedBalance!==store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromBalance){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromBalance=formattedBalance);token.balance=balance}const requiredAmount=parseAmount(amount,token.decimals);const isInsufficient=balance<requiredAmount;insufficientBalanceStore.set(isInsufficient);return isInsufficient}catch(error){insufficientBalanceStore.set(false);log.error("Error checking balance:",false,error);return false}}async function validateBalance(){try{if(!store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount||!fundingAddress)return false;const balance=await getTokenBalance(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn,fundingAddress,provider,tokenService);const swapAmount=ethers.parseUnits(store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals);if(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.isNative){const gasEstimate=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).gasEstimate||0n;const totalRequiredAmount=swapAmount+(BigNumber.toBigInt(gasEstimate)||0n);if(balance<totalRequiredAmount){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=`Insufficient ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol} balance. Need ${ethers.formatUnits(totalRequiredAmount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals)} ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol}, but have ${ethers.formatUnits(balance,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals)} ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol}`);return false}}else{const totalRequiredAmount=swapAmount;if(balance<totalRequiredAmount){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=`Insufficient ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol} balance. Need ${ethers.formatUnits(totalRequiredAmount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals)} ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol}, but have ${ethers.formatUnits(balance,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals)} ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol}`);return false}}return true}catch(error){log.error("Error validating balance:",false,error);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="Failed to validate balance. Please try again.");return false}}async function getQuote(isExactIn=true){if(!store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut.symbol||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount&&!store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount)return;if(areTokensEqual(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut)){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=`Cannot swap ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol} for itself`);return}try{store_mutate($$store_subs??={},"$uiStateStore",uiStateStore,store_get($$store_subs??={},"$uiStateStore",uiStateStore).isLoading=true);const amount=isExactIn?parseAmount(store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals):parseAmount(store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut.decimals);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).slippageTolerance=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).slippageTolerance||.5);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).deadline=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).deadline||10);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).fee||3e3);const quote=await swapManager.getQuote(Token.fromSwapToken(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn,blockchain,provider),Token.fromSwapToken(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut,blockchain,provider),amount,fundingAddress,isExactIn,store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee);if(!quote||quote.error){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="No valid pool found for this token pair. Try a different combination.");return}if(quote){quote.slippageTolerance=store_get($$store_subs??={},"$swapStateStore",swapStateStore).slippageTolerance;quote.deadline=store_get($$store_subs??={},"$swapStateStore",swapStateStore).deadline}if(isExactIn){const amountOut=quote.amountOut??0n;store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount=ethers.formatUnits(toBigInt(amountOut),store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut.decimals))}else{const amountIn=quote.amountIn??0n;store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount=ethers.formatUnits(toBigInt(amountIn),store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals))}updateSwapPriceData(quote)}catch(error){log.error("Quote Error:",false,error);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=`Failed to get quote: ${error}`);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount="")}finally{store_mutate($$store_subs??={},"$uiStateStore",uiStateStore,store_get($$store_subs??={},"$uiStateStore",uiStateStore).isLoading=false)}}async function validateQuote(){let returnCode=false;if(!store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount||!fundingAddress||!swapManager){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="Invalid swap parameters");return returnCode}if(areTokensEqual(store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut)){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=`Cannot swap ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol} for itself`);return returnCode}if(!store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore)){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="Failed to get quote");return returnCode}if(store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).error){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).error);return returnCode}if(store_get($$store_subs??={},"$insufficientBalanceStore",insufficientBalanceStore)){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=`Insufficient balance for the given swap. You need ETH for gas fees and enough ${store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.symbol} to sell/swap.`);return returnCode}if(!(await validateBalance())){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="Insufficient balance for the given swap");return}const results=validateSwapQuote(store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore));if(results.error){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=results.error);log.error("Validation error:",false,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error);return returnCode}return true}function areTokensEqual(token1,token2){const isEthVariant=symbol=>["ETH","WETH"].includes(symbol);if(token1.address&&token2.address){return token1.address.toLowerCase()===token2.address.toLowerCase()}else if(token1.symbol&&token2.symbol){if(isEthVariant(token1.symbol)&&isEthVariant(token2.symbol)){return token1.symbol===token2.symbol}return token1.symbol===token2.symbol}return false}async function swapTokens(){try{if(!pincodeVerified){showVerify=true;return}if(isEthWethSwap);store_mutate($$store_subs??={},"$uiStateStore",uiStateStore,store_get($$store_subs??={},"$uiStateStore",uiStateStore).isSwapping=true);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="");if(!(await validateQuote())){store_mutate($$store_subs??={},"$uiStateStore",uiStateStore,store_get($$store_subs??={},"$uiStateStore",uiStateStore).isSwapping=false);return}const tokenInInstance=Token.fromSwapToken(store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).tokenIn,blockchain,provider);const tokenOutInstance=Token.fromSwapToken(store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).tokenOut,blockchain,provider);if(!store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).tokenIn.isNative){const allowance=await swapManager.checkAllowance(tokenInInstance,fundingAddress);const requiredAmount=ethers.parseUnits(store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount,tokenInInstance.decimals);if(allowance<requiredAmount){const receipt=await swapManager.approveToken(tokenInInstance,store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount)}}const{maxFeePerGas:maxFeePerGas,maxPriorityFeePerGas:maxPriorityFeePerGas}=await getCurrentGasPrices();const params={tokenIn:tokenInInstance,tokenOut:tokenOutInstance,amount:ethers.parseUnits(store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount,store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).tokenIn.decimals),fee:store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).fee||store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee,slippage:store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).slippageTolerance||store_get($$store_subs??={},"$swapStateStore",swapStateStore).slippageTolerance,deadline:store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).deadline||store_get($$store_subs??={},"$swapStateStore",swapStateStore).deadline,recipient:store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).fundingAddress,feeRecipient:"aifees.eth",feeAmount:store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).feeAmount||0n,gasLimit:toBigInt(store_get($$store_subs??={},"$swapPriceDataStore",swapPriceDataStore).gasEstimate)||ETH_BASE_SWAP_GAS_UNITS,maxFeePerGas:maxFeePerGas,maxPriorityFeePerGas:maxPriorityFeePerGas};const[receiptTrans,receiptFee]=await swapManager.executeFullSwap(params);onSwap(fundingAddress,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut,ethers.parseUnits(store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn.decimals),ethers.parseUnits(store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut.decimals));store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="");await sendNotificationMessage("Swap completed successfully","Your swap has been completed successfully.");reset();show=false}catch(err){store_mutate($$store_subs??={},"$uiStateStore",uiStateStore,store_get($$store_subs??={},"$uiStateStore",uiStateStore).isSwapping=false);log.error("Error executing swap:",err);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error=`Failed to execute swap: ${err.message}`)}}async function getCurrentGasPrices(){try{const feeData=await provider.getFeeData();return{maxFeePerGas:toBigInt(feeData.maxFeePerGas),maxPriorityFeePerGas:toBigInt(feeData.maxPriorityFeePerGas)}}catch(error){return{maxFeePerGas:ethers.parseUnits("30","gwei"),maxPriorityFeePerGas:ethers.parseUnits("1","gwei")}}}function reset(){showConfirmation=false;showError=false;errorValue="";showWarning=false;warningValue="";pincodeVerified=false;showVerify=false;store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn=initialToken);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut=initialToken);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount="");store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount="");store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromBalance="0");store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee=3e3);store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).error="");lastModifiedPanel="sell";insufficientBalanceStore.set(false);swapPriceDataStore.set(initialSwapPriceData);store_mutate($$store_subs??={},"$uiStateStore",uiStateStore,store_get($$store_subs??={},"$uiStateStore",uiStateStore).resetValues=true)}function handleCancelSwap(){showConfirmation=false}function handleConfirm(){showConfirmation=false;showWarning=false;warningValue="";handleSwap()}function handleSwap(){pincodeVerified=false;showWarning=false;warningValue="";showVerify=true}function handleClose(){showConfirmation=false;showError=false;errorValue="";showWarning=false;warningValue="";pincodeVerified=false;showVerify=false}function handleReject(rejection="You have rejected or Pincode was not validated. No swap transaction was sent."){try{showConfirmation=false;showVerify=false;showError=false;pincodeVerified=false;showWarning=true;warningValue=rejection}catch(e){log.error(e)}}async function handleVerified(pincode){try{let profile=await verifyWithPin(pincode,pincodeVerified);if(profile===null){throw"Profile was not found."}pincodeVerified=true;showVerify=false;await swapTokens()}catch(e){log.error(e)}}async function verifyWithPin(pincode,pincodeVerified2){try{const yakklMiscStore=getMiscStore();let profile=await getProfile();if(profile===null){pincodeVerified2=false;throw"Profile was not found."}let profileEncrypted=null;if(isEncryptedData(profile.data)){profileEncrypted=deepCopy(profile);await decryptData(profile?.data,yakklMiscStore).then(result=>{profile.data=result})}if(profile.data.pincode!==pincode&&pincodeVerified2===false){pincodeVerified2=false;throw"PINCODE was not verified."}if(pincode===profile.data.pincode){profile=null;return profileEncrypted}else{pincodeVerified2=false;throw"PINCODE did not match."}}catch(e){log.error(e);pincodeVerified2=false;return null}}function handleCloseModal(){reset();show=false}let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){Confirmation($$payload2,{className:"z-[990]",onConfirm:handleConfirm,onReject:handleCancelSwap,get show(){return showConfirmation},set show($$value){showConfirmation=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e `;PincodeVerify($$payload2,{className:"text-gray-600 z-[990]",onRejected:handleReject,onVerified:handleVerified,get show(){return showVerify},set show($$value){showVerify=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e `;ErrorNoAction($$payload2,{className:"z-[999]",value:errorValue,handle:handleClose,get show(){return showError},set show($$value){showError=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e `;Warning($$payload2,{className:"z-[999]",value:warningValue,handle:handleClose,get show(){return showWarning},set show($$value){showWarning=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e `;Modal($$payload2,{title:"Swap",className:className,onClose:handleCloseModal,get show(){return show},set show($$value){show=$$value;$$settled=false},children:prevent_snippet_stringification($$payload3=>{$$payload3.out+=`<div class="p-6 space-y-4">`;push_element($$payload3,"div",734,1);$$payload3.out+=`<span>`;push_element($$payload3,"span",736,2);$$payload3.out+=`Sell</span>`;pop_element();$$payload3.out+=` `;SellTokenPanel($$payload3,{swapPriceDataStore:swapPriceDataStore,disabled:false,insufficientBalance:store_get($$store_subs??={},"$insufficientBalanceStore",insufficientBalanceStore),balance:store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromBalance,onTokenSelect:token=>handleTokenSelect(token,"sell"),onAmountChange:handleSellAmountChange,get resetValues(){return store_get($$store_subs??={},"$uiStateStore",uiStateStore).resetValues},set resetValues($$value){store_mutate($$store_subs??={},"$uiStateStore",uiStateStore,store_get($$store_subs??={},"$uiStateStore",uiStateStore).resetValues=$$value);$$settled=false},get lastModifiedPanel(){return lastModifiedPanel},set lastModifiedPanel($$value){lastModifiedPanel=$$value;$$settled=false}});$$payload3.out+=`\x3c!----\x3e  <button class="mx-auto block bg-gray-200 p-2 rounded-full transform transition-transform hover:rotate-180">`;push_element($$payload3,"button",750,2);$$payload3.out+=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">`;push_element($$payload3,"svg",754,3);$$payload3.out+=`<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4">`;push_element($$payload3,"path",761,4);$$payload3.out+=`</path>`;pop_element();$$payload3.out+=`</svg>`;pop_element();$$payload3.out+=`</button>`;pop_element();$$payload3.out+=` <span>`;push_element($$payload3,"span",771,2);$$payload3.out+=`Buy</span>`;pop_element();$$payload3.out+=` `;BuyTokenPanel($$payload3,{swapPriceDataStore:swapPriceDataStore,disabled:false,onTokenSelect:token=>handleTokenSelect(token,"buy"),onAmountChange:handleBuyAmountChange,get resetValues(){return store_get($$store_subs??={},"$uiStateStore",uiStateStore).resetValues},set resetValues($$value){store_mutate($$store_subs??={},"$uiStateStore",uiStateStore,store_get($$store_subs??={},"$uiStateStore",uiStateStore).resetValues=$$value);$$settled=false},get lastModifiedPanel(){return lastModifiedPanel},set lastModifiedPanel($$value){lastModifiedPanel=$$value;$$settled=false}});$$payload3.out+=`\x3c!----\x3e `;if(store_get($$store_subs??={},"$swapStateStore",swapStateStore).error&&!isEthWethSwap){$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`<div class="w-full bg-red-50 border border-red-200 rounded-lg p-3">`;push_element($$payload3,"div",783,3);$$payload3.out+=`<div class="flex items-center justify-center">`;push_element($$payload3,"div",784,4);$$payload3.out+=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500 mr-2" viewBox="0 0 20 20" fill="currentColor">`;push_element($$payload3,"svg",785,5);$$payload3.out+=`<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd">`;push_element($$payload3,"path",791,6);$$payload3.out+=`</path>`;pop_element();$$payload3.out+=`</svg>`;pop_element();$$payload3.out+=` <div class="text-red-500 text-center overflow-x-auto max-w-full">`;push_element($$payload3,"div",797,5);$$payload3.out+=`<span class="whitespace-nowrap">`;push_element($$payload3,"span",798,6);$$payload3.out+=`${escape_html(store_get($$store_subs??={},"$swapStateStore",swapStateStore).error)}</span>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e"}$$payload3.out+=`\x3c!--]--\x3e <div class="w-full bg-blue-400 border border-blue-800 rounded-lg p-3">`;push_element($$payload3,"div",804,2);$$payload3.out+=`<div class="flex items-center justify-center">`;push_element($$payload3,"div",805,3);$$payload3.out+=`<div class="text-blue-700 text-center overflow-x-auto max-w-full">`;push_element($$payload3,"div",806,4);if(store_get($$store_subs??={},"$swapStateStore",swapStateStore).multiHop){$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`<span class="whitespace-nowrap">`;push_element($$payload3,"span",808,6);$$payload3.out+=`This swap requires multiple hops to complete.</span>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e";$$payload3.out+=`<span class="whitespace-nowrap">`;push_element($$payload3,"span",810,6);$$payload3.out+=`This swap requires a single hop to complete.</span>`;pop_element()}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` `;{$$payload3.out+="\x3c!--[--\x3e";SwapSettings($$payload3,{swapPriceDataStore:swapPriceDataStore,onSlippageChange:value=>store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).slippageTolerance=value),onDeadlineChange:value=>store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).deadline=value),onPoolFeeChange:value=>{store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee=value);if((store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn?.isStablecoin||store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut?.isStablecoin)&&swapManagerName.includes("uniswap")){store_mutate($$store_subs??={},"$swapStateStore",swapStateStore,store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee=500)}updateSwapPriceData({fee:store_get($$store_subs??={},"$swapStateStore",swapStateStore).poolFee})}})}$$payload3.out+=`\x3c!--]--\x3e `;SwapSummary($$payload3,{swapPriceDataStore:swapPriceDataStore,disabled:isEthWethSwap});$$payload3.out+=`\x3c!----\x3e <button class="w-full px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors flex items-center justify-center">`;push_element($$payload3,"button",849,2);$$payload3.out+=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">`;push_element($$payload3,"svg",853,3);$$payload3.out+=`<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">`;push_element($$payload3,"path",860,4);$$payload3.out+=`</path>`;pop_element();$$payload3.out+=`</svg>`;pop_element();$$payload3.out+=` Reset Swap</button>`;pop_element();$$payload3.out+=` <button class="w-full px-4 py-3 text-lg font-medium text-white bg-blue-600 rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"${attr("disabled",!store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenIn||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).tokenOut||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).fromAmount||!store_get($$store_subs??={},"$swapStateStore",swapStateStore).toAmount,true)}>`;push_element($$payload3,"button",871,2);{$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`${escape_html(store_get($$store_subs??={},"$uiStateStore",uiStateStore).isLoading?"Loading...":store_get($$store_subs??={},"$uiStateStore",uiStateStore).isSwapping?"Swapping...":"Swap")}`}$$payload3.out+=`\x3c!--]--\x3e</button>`;pop_element();$$payload3.out+=` <button class="w-full px-4 py-3 text-lg font-medium text-white bg-red-500 rounded-lg shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-400">`;push_element($$payload3,"button",890,2);$$payload3.out+=`Cancel</button>`;pop_element();$$payload3.out+=`</div>`;pop_element()}),$$slots:{default:true}});$$payload2.out+=`\x3c!----\x3e`}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);if($$store_subs)unsubscribe_stores($$store_subs);bind_props($$props,{show:show});pop()}Swap.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};QR[FILENAME]="src/lib/components/QR.svelte";function QR($$payload,$$props){push(QR);let{qrText:qrText}=$$props;const width=220;const height=220;$$payload.out+=`<div class="flex mx-auto justify-center w-full h-full svelte-x2f3mp">`;push_element($$payload,"div",21,0);$$payload.out+=`</div>`;pop_element();bind_props($$props,{width:width,height:height});pop()}QR.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};Receive[FILENAME]="src/lib/components/Receive.svelte";function Receive($$payload,$$props){push(Receive);var $$store_subs;let{show:show=false,address:address="",title:title="Receive"}=$$props;let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){Modal($$payload2,{title:title,get show(){return show},set show($$value){show=$$value;$$settled=false},children:prevent_snippet_stringification($$payload3=>{$$payload3.out+=`<div class="p-6">`;push_element($$payload3,"div",17,1);if(store_get($$store_subs??={},"$yakklCurrentlySelectedStore",yakklCurrentlySelectedStore)&&store_get($$store_subs??={},"$yakklCurrentlySelectedStore",yakklCurrentlySelectedStore).shortcuts.address!==YAKKL_ZERO_ADDRESS){$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`<div class="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-6 mb-6 text-center">`;push_element($$payload3,"div",20,3);$$payload3.out+=`<div class="mb-6">`;push_element($$payload3,"div",21,4);QR($$payload3,{qrText:address});$$payload3.out+=`\x3c!----\x3e</div>`;pop_element();$$payload3.out+=` <h3 class="text-lg font-semibold text-gray-800 mb-2">`;push_element($$payload3,"h3",24,4);$$payload3.out+=`Your Wallet Address</h3>`;pop_element();$$payload3.out+=` <p class="text-sm text-gray-600 mb-4">`;push_element($$payload3,"p",25,4);$$payload3.out+=`Share this address to receive payments</p>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div class="bg-white rounded-lg border border-gray-200 shadow-sm">`;push_element($$payload3,"div",29,3);$$payload3.out+=`<div class="flex items-center justify-between p-4">`;push_element($$payload3,"div",30,4);$$payload3.out+=`<div class="flex-1 min-w-0 mr-3">`;push_element($$payload3,"div",31,5);$$payload3.out+=`<div class="text-xs font-medium text-gray-500 uppercase tracking-wide mb-1">`;push_element($$payload3,"div",32,6);$$payload3.out+=`Ethereum Address</div>`;pop_element();$$payload3.out+=` <p class="text-sm font-mono text-gray-900 truncate"${attr("title",address)} id="eth-address">`;push_element($$payload3,"p",35,6);$$payload3.out+=`${escape_html(address)}</p>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div class="flex-shrink-0">`;push_element($$payload3,"div",39,5);Copy($$payload3,{target:{},className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"});$$payload3.out+=`\x3c!----\x3e</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">`;push_element($$payload3,"div",46,3);$$payload3.out+=`<div class="flex items-center">`;push_element($$payload3,"div",47,4);$$payload3.out+=`<div class="flex-shrink-0">`;push_element($$payload3,"div",48,5);$$payload3.out+=`<svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">`;push_element($$payload3,"svg",49,6);$$payload3.out+=`<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd">`;push_element($$payload3,"path",50,7);$$payload3.out+=`</path>`;pop_element();$$payload3.out+=`</svg>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div class="ml-3">`;push_element($$payload3,"div",53,5);$$payload3.out+=`<p class="text-sm text-blue-800">`;push_element($$payload3,"p",54,6);$$payload3.out+=`<span class="font-medium">`;push_element($$payload3,"span",55,7);$$payload3.out+=`Scan the QR code</span>`;pop_element();$$payload3.out+=` with your mobile wallet or <span class="font-medium">`;push_element($$payload3,"span",56,7);$$payload3.out+=`copy the address</span>`;pop_element();$$payload3.out+=` to receive payments</p>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e";$$payload3.out+=`<div class="text-center py-12">`;push_element($$payload3,"div",63,3);$$payload3.out+=`<div class="w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center">`;push_element($$payload3,"div",64,4);$$payload3.out+=`<svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">`;push_element($$payload3,"svg",65,5);$$payload3.out+=`<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z">`;push_element($$payload3,"path",66,6);$$payload3.out+=`</path>`;pop_element();$$payload3.out+=`</svg>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <h3 class="text-lg font-semibold text-gray-700 mb-2">`;push_element($$payload3,"h3",69,4);$$payload3.out+=`No Portfolio Accounts</h3>`;pop_element();$$payload3.out+=` <p class="text-gray-500">`;push_element($$payload3,"p",70,4);$$payload3.out+=`Create at least one Portfolio account to receive payments</p>`;pop_element();$$payload3.out+=`</div>`;pop_element()}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element()}),$$slots:{default:true}})}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);if($$store_subs)unsubscribe_stores($$store_subs);bind_props($$props,{show:show,address:address});pop()}Receive.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};export{Receive as R,Swap as S,getTokenBalance as g};
//# sourceMappingURL=Receive.js.map
