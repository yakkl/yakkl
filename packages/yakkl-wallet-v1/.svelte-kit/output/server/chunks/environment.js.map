{"version":3,"file":"environment.js","sources":["../../../../src/lib/common/environment.ts"],"sourcesContent":["// $lib/common/environment.ts\nimport type { Browser } from 'webextension-polyfill';\nimport { log } from '$lib/managers/Logger';\n\n// Helper function to check if we're in a browser environment\nfunction isBrowserSide(): boolean {\n\treturn typeof window !== 'undefined' && typeof document !== 'undefined';\n}\n\nexport const isClient = isBrowserSide();\n\n// Create a mock for SSR\nconst mockBrowser = {\n\truntime: {\n\t\tconnect: () => ({}),\n\t\tsendMessage: () => Promise.resolve({}),\n\t\tonMessage: {\n\t\t\taddListener: () => {},\n\t\t\tremoveListener: () => {},\n\t\t\thasListener: () => false\n\t\t}\n\t}\n\t// Add other APIs as needed\n} as unknown as Browser;\n\n// Get the browser API from the global set in hooks.client.ts\nexport function getBrowserExtFromGlobal(): Browser | null {\n\tif (!isClient) return null; // mockBrowser for SSR??\n\n\ttry {\n\t\t// First try the dedicated property we set\n\t\tif (window.browserPolyfill) {\n\t\t\treturn window.browserPolyfill;\n\t\t}\n\n\t\t// Then try the standard global\n\t\tif ((window as any).browser) {\n\t\t\treturn (window as any).browser;\n\t\t}\n\t} catch (err) {\n\t\tlog.error('Error accessing browser API from global:', false, err);\n\t}\n\n\treturn null;\n}\n\n// Export a function that gets the browser API\nexport function getBrowserExt(): Browser | null {\n\tif (!isClient) return null;\n\treturn getBrowserExtFromGlobal();\n}\n\n// For backward compatibility - use the getter function\nexport const browser_ext = isClient ? getBrowserExtFromGlobal() : null;\nexport const browserSvelte = isClient && !!browser_ext;\n\nexport function isBrowserEnv(): boolean {\n\treturn isClient && getBrowserExt() !== null;\n}\n"],"names":["isBrowserSide","window","document","isClient","getBrowserExtFromGlobal","browserPolyfill","browser","err","log","error","getBrowserExt","browser_ext","browserSvelte","isBrowserEnv"],"mappings":"kCAKA,SAASA,gBACR,cAAcC,SAAW,oBAAsBC,WAAa,WAC7D,CAEO,MAAMC,SAAWH,gBAiBjB,SAASI,0BACX,IAACD,SAAiB,OAAA,KAElB,IAEH,GAAIF,OAAOI,gBAAiB,CAC3B,OAAOJ,OAAOI,eAAA,CAIf,GAAKJ,OAAeK,QAAS,CAC5B,OAAQL,OAAeK,OAAA,QAEhBC,KACJC,IAAAC,MAAM,2CAA4C,MAAOF,IAAG,CAG1D,OAAA,IACR,CAGO,SAASG,gBACX,IAACP,SAAiB,OAAA,KACtB,OAAOC,yBACR,CAGa,MAAAO,YAAcR,SAAWC,0BAA4B,KACrD,MAAAQ,cAAgBT,YAAcQ,YAEpC,SAASE,eACR,OAAAV,UAAYO,kBAAoB,IACxC"}