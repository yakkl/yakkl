import{p as push,h as copy_payload,i as assign_payload,k as bind_props,c as pop,l as prevent_snippet_stringification,a as push_element,b as pop_element,m as attr,s as store_get,e as escape_html,u as unsubscribe_stores,g as stringify,f as attr_class,v as ensure_array_like,j as store_set,B as validate_snippet_args}from"./index2.js";import{a5 as AccountTypeCategory,w as dateString,a9 as setYakklAccountsStorage,at as yakklAccountsStore,au as yakklPrimaryAccountsStore,a6 as setYakklPrimaryAccountsStorage,m as yakklCurrentlySelectedStore,Q as YAKKL_ZERO_ADDRESS,W as setYakklCurrentlySelectedStorage}from"./encryption.js";import{M as Modal}from"./Modal2.js";import{o as onDestroy}from"./index-server2.js";import{c as createForm}from"./create-form.js";import{ClipboardIcon}from"svelte-feather-icons";import*as yup from"yup";import{F as FILENAME}from"./utils.js";import"./Confirmation.js";import{S as SkeletonBalance}from"./ImportWatchAccount.js";import{P as ProtectedValue}from"./ProtectedValue.js";import{E as EditControls}from"./EditControls.js";import{l as log}from"./Logger.js";import"./environment.js";import{balanceCacheManager}from"./BalanceCacheManager.js";import{o as openModal}from"./modal.js";import{UnifiedTimerManager}from"./UnifiedTimerManager.js";import"./utilities.js";import"./gas.js";import"ethereum-blockies-base64";AccountForm[FILENAME]="src/lib/components/AccountForm.svelte";function AccountForm($$payload,$$props){push(AccountForm);var $$store_subs;let{show:show=false,account:account=null,onSubmit:onSubmit=()=>{}}=$$props;const{form:form,errors:errors}=createForm({initialValues:{name:"",alias:"",description:""},validationSchema:yup.object().shape({name:yup.string().required("Please enter an account name"),alias:yup.string().optional(),description:yup.string().optional()}),onSubmit:values=>{if(account){const updatedAccount={...account,name:values.name,alias:values.alias,description:values.description};onSubmit(updatedAccount)}show=false}});let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){Modal($$payload2,{title:account?"Edit Account":"Add Account",get show(){return show},set show($$value){show=$$value;$$settled=false},children:prevent_snippet_stringification($$payload3=>{$$payload3.out+=`<form class="space-y-4 p-6">`;push_element($$payload3,"form",56,1);$$payload3.out+=`<div>`;push_element($$payload3,"div",57,2);$$payload3.out+=`<label class="block text-sm font-medium text-gray-700">`;push_element($$payload3,"label",59,3);$$payload3.out+=`Address</label>`;pop_element();$$payload3.out+=` <div class="mt-1 flex items-center">`;push_element($$payload3,"div",60,3);$$payload3.out+=`<input type="text" class="flex-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-800 bg-gray-100 cursor-not-allowed"${attr("value",account?.address||"")} disabled/>`;push_element($$payload3,"input",61,4);pop_element();$$payload3.out+=` <button type="button" class="ml-2 inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">`;push_element($$payload3,"button",67,4);ClipboardIcon($$payload3,{class:"h-4 w-4"});$$payload3.out+=`\x3c!----\x3e</button>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div>`;push_element($$payload3,"div",77,2);$$payload3.out+=`<label for="name" class="block text-sm font-medium text-gray-700">`;push_element($$payload3,"label",78,3);$$payload3.out+=`Name</label>`;pop_element();$$payload3.out+=` <input type="text" id="name" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-800"${attr("value",store_get($$store_subs??={},"$form",form).name)}/>`;push_element($$payload3,"input",79,3);pop_element();$$payload3.out+=` `;if(store_get($$store_subs??={},"$errors",errors).name){$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`<p class="mt-2 text-sm text-red-600">`;push_element($$payload3,"p",87,4);$$payload3.out+=`${escape_html(store_get($$store_subs??={},"$errors",errors).name)}</p>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e"}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload3.out+=` <div>`;push_element($$payload3,"div",90,2);$$payload3.out+=`<label for="alias" class="block text-sm font-medium text-gray-700">`;push_element($$payload3,"label",91,3);$$payload3.out+=`Alias</label>`;pop_element();$$payload3.out+=` <input type="text" id="alias" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-800"${attr("value",store_get($$store_subs??={},"$form",form).alias)}/>`;push_element($$payload3,"input",92,3);pop_element();$$payload3.out+=` `;if(store_get($$store_subs??={},"$errors",errors).alias){$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`<p class="mt-2 text-sm text-red-600">`;push_element($$payload3,"p",100,4);$$payload3.out+=`${escape_html(store_get($$store_subs??={},"$errors",errors).alias)}</p>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e"}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload3.out+=` <div>`;push_element($$payload3,"div",103,2);$$payload3.out+=`<label for="description" class="block text-sm font-medium text-gray-700">`;push_element($$payload3,"label",104,3);$$payload3.out+=`Description</label>`;pop_element();$$payload3.out+=` <textarea id="description" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm text-gray-800">`;push_element($$payload3,"textarea",105,3);const $$body=escape_html(store_get($$store_subs??={},"$form",form).description);if($$body){$$payload3.out+=`${$$body}`}$$payload3.out+=`</textarea>`;pop_element();$$payload3.out+=` `;if(store_get($$store_subs??={},"$errors",errors).description){$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`<p class="mt-2 text-sm text-red-600">`;push_element($$payload3,"p",113,4);$$payload3.out+=`${escape_html(store_get($$store_subs??={},"$errors",errors).description)}</p>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e"}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload3.out+=` <div class="pt-5">`;push_element($$payload3,"div",116,2);$$payload3.out+=`<div class="flex justify-end space-x-4">`;push_element($$payload3,"div",117,3);$$payload3.out+=`<button type="button" class="rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">`;push_element($$payload3,"button",118,4);$$payload3.out+=`Cancel</button>`;pop_element();$$payload3.out+=` <button type="button" class="rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">`;push_element($$payload3,"button",123,4);$$payload3.out+=`Reset</button>`;pop_element();$$payload3.out+=` <button type="submit" class="rounded-md border border-transparent bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">`;push_element($$payload3,"button",128,4);$$payload3.out+=`Save</button>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</form>`;pop_element()}),$$slots:{default:true}})}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);if($$store_subs)unsubscribe_stores($$store_subs);bind_props($$props,{show:show});pop()}AccountForm.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};BalanceIndicator[FILENAME]="src/lib/components/BalanceIndicator.svelte";function BalanceIndicator($$payload,$$props){push(BalanceIndicator);let{isLoading:isLoading=false,loadingError:loadingError=null,isCached:isCached=false,isStale:isStale=false,lastUpdated:lastUpdated=null,quantityFormatted:quantityFormatted="",totalValueFormatted:totalValueFormatted="",onRetry:onRetry=()=>{}}=$$props;function formatLastUpdated(date){if(!date)return"";const now=new Date;const diffMs=now.getTime()-date.getTime();const diffMins=Math.floor(diffMs/(1e3*60));if(diffMins<1)return"just now";if(diffMins<60)return`${diffMins}m ago`;const diffHours=Math.floor(diffMins/60);if(diffHours<24)return`${diffHours}h ago`;const diffDays=Math.floor(diffHours/24);return`${diffDays}d ago`}$$payload.out+=`<div class="mt-2 space-y-1">`;push_element($$payload,"div",29,0);$$payload.out+=`<div class="flex items-center justify-between">`;push_element($$payload,"div",31,1);if(isLoading&&!isCached){$$payload.out+="\x3c!--[--\x3e";SkeletonBalance($$payload,{showLabel:false,className:"h-4"})}else if(loadingError){$$payload.out+="\x3c!--[1--\x3e";$$payload.out+=`<div class="flex items-center space-x-1">`;push_element($$payload,"div",35,3);$$payload.out+=`<span class="text-xs text-red-500">`;push_element($$payload,"span",36,4);$$payload.out+=`Error loading</span>`;pop_element();$$payload.out+=` <button class="text-xs text-blue-500 hover:text-blue-700 underline">`;push_element($$payload,"button",37,4);$$payload.out+=`Retry</button>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=` <span class="text-xs text-gray-400">`;push_element($$payload,"span",41,3);$$payload.out+=`--</span>`;pop_element()}else{$$payload.out+="\x3c!--[!--\x3e";$$payload.out+=`<div class="flex items-center space-x-1">`;push_element($$payload,"div",43,3);$$payload.out+=`<span class="text-sm font-semibold text-gray-900">`;push_element($$payload,"span",44,4);ProtectedValue($$payload,{value:`${quantityFormatted} ETH`,placeholder:"******* ETH"});$$payload.out+=`\x3c!----\x3e</span>`;pop_element();$$payload.out+=` `;if(isLoading){$$payload.out+="\x3c!--[--\x3e";$$payload.out+=`<div class="w-3 h-3 border border-blue-400 border-t-transparent rounded-full animate-spin">`;push_element($$payload,"div",48,5);$$payload.out+=`</div>`;pop_element()}else if(isStale){$$payload.out+="\x3c!--[1--\x3e";$$payload.out+=`<div title="Data may be outdated">`;push_element($$payload,"div",52,5);$$payload.out+=`<svg class="w-3 h-3 text-orange-400" fill="currentColor" viewBox="0 0 20 20">`;push_element($$payload,"svg",53,6);$$payload.out+=`<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd">`;push_element($$payload,"path",54,7);$$payload.out+=`</path>`;pop_element();$$payload.out+=`</svg>`;pop_element();$$payload.out+=`</div>`;pop_element()}else if(isCached){$$payload.out+="\x3c!--[2--\x3e";$$payload.out+=`<div title="Cached data">`;push_element($$payload,"div",62,5);$$payload.out+=`<svg class="w-3 h-3 text-green-400" fill="currentColor" viewBox="0 0 20 20">`;push_element($$payload,"svg",63,6);$$payload.out+=`<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd">`;push_element($$payload,"path",64,7);$$payload.out+=`</path>`;pop_element();$$payload.out+=`</svg>`;pop_element();$$payload.out+=`</div>`;pop_element()}else{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload.out+=` <span class="text-sm font-semibold text-gray-900">`;push_element($$payload,"span",73,3);ProtectedValue($$payload,{value:totalValueFormatted,placeholder:"*****"});$$payload.out+=`\x3c!----\x3e</span>`;pop_element()}$$payload.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload.out+=` `;if(lastUpdated&&(isStale||isCached)){$$payload.out+="\x3c!--[--\x3e";$$payload.out+=`<div class="flex justify-end">`;push_element($$payload,"div",81,2);$$payload.out+=`<span class="text-xs text-gray-400"${attr("title",`Last updated: ${stringify(lastUpdated.toLocaleString())}`)}>`;push_element($$payload,"span",82,3);$$payload.out+=`Updated ${escape_html(formatLastUpdated(lastUpdated))}</span>`;pop_element();$$payload.out+=`</div>`;pop_element()}else{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e</div>`;pop_element();pop()}BalanceIndicator.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};SubAccountIndicator[FILENAME]="src/lib/components/SubAccountIndicator.svelte";function SubAccountIndicator($$payload,$$props){push(SubAccountIndicator);let{primaryAccount:primaryAccount,allAccounts:allAccounts,className:className=""}=$$props;const subAccounts=()=>{if(primaryAccount.accountType!==AccountTypeCategory.PRIMARY){return[]}return allAccounts.filter(account=>account.accountType===AccountTypeCategory.SUB&&account.primaryAccount?.address===primaryAccount.address)};const subAccountCount=subAccounts().length;if(subAccountCount>0){$$payload.out+="\x3c!--[--\x3e";$$payload.out+=`<div${attr_class(`flex items-center space-x-1 ${stringify(className)}`)}>`;push_element($$payload,"div",16,1);$$payload.out+=`<div class="relative">`;push_element($$payload,"div",18,2);$$payload.out+=`<svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">`;push_element($$payload,"svg",19,3);$$payload.out+=`<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10">`;push_element($$payload,"path",20,4);$$payload.out+=`</path>`;pop_element();$$payload.out+=`</svg>`;pop_element();$$payload.out+=` <div class="absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold">`;push_element($$payload,"div",29,3);$$payload.out+=`${escape_html(subAccountCount)}</div>`;pop_element();$$payload.out+=`</div>`;pop_element();$$payload.out+=` <span class="text-xs text-blue-600 font-medium">`;push_element($$payload,"span",37,2);$$payload.out+=`${escape_html(subAccountCount)} sub-account${escape_html(subAccountCount>1?"s":"")}</span>`;pop_element();$$payload.out+=`</div>`;pop_element()}else{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e`;pop()}SubAccountIndicator.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};EnhancedDeleteConfirmation[FILENAME]="src/lib/components/EnhancedDeleteConfirmation.svelte";function EnhancedDeleteConfirmation($$payload,$$props){push(EnhancedDeleteConfirmation);let{show:show=false,account:account=null,allAccounts:allAccounts=[],onConfirm:onConfirm=()=>{},onCancel:onCancel=()=>{},onLoadBalance:onLoadBalance=async()=>0n}=$$props;let accountsWithBalances=[];let loading=false;function getAccountIcon(accountType){switch(accountType){case AccountTypeCategory.PRIMARY:return"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10";case AccountTypeCategory.SUB:return"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2";default:return"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"}}const isPrimaryAccountWithSubs=()=>account?.accountType===AccountTypeCategory.PRIMARY&&accountsWithBalances.length>1;let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){Modal($$payload2,{title:"Delete Account Confirmation",className:"z-[900]",get show(){return show},set show($$value){show=$$value;$$settled=false},children:prevent_snippet_stringification($$payload3=>{const each_array=ensure_array_like(accountsWithBalances);$$payload3.out+=`<div class="p-6 space-y-4">`;push_element($$payload3,"div",168,1);$$payload3.out+=`<div class="flex items-center space-x-3 p-4 bg-red-50 border border-red-200 rounded-lg">`;push_element($$payload3,"div",170,2);$$payload3.out+=`<div class="flex-shrink-0">`;push_element($$payload3,"div",171,3);$$payload3.out+=`<svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">`;push_element($$payload3,"svg",172,4);$$payload3.out+=`<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z">`;push_element($$payload3,"path",173,5);$$payload3.out+=`</path>`;pop_element();$$payload3.out+=`</svg>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div>`;push_element($$payload3,"div",181,3);$$payload3.out+=`<h3 class="text-lg font-semibold text-red-800">`;push_element($$payload3,"h3",182,4);$$payload3.out+=`${escape_html(isPrimaryAccountWithSubs?"Delete Primary Account & Sub-Accounts":"Delete Account")}</h3>`;pop_element();$$payload3.out+=` <p class="text-sm text-red-600">`;push_element($$payload3,"p",185,4);$$payload3.out+=`This action cannot be undone and will permanently delete the account${escape_html(isPrimaryAccountWithSubs?"s":"")}.</p>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div class="space-y-3">`;push_element($$payload3,"div",194,2);$$payload3.out+=`<h4 class="font-medium text-gray-900">`;push_element($$payload3,"h4",195,3);$$payload3.out+=`${escape_html(isPrimaryAccountWithSubs?"Accounts to be deleted:":"Account to be deleted:")}</h4>`;pop_element();$$payload3.out+=` <div class="bg-gray-50 rounded-lg p-4 space-y-3">`;push_element($$payload3,"div",199,3);$$payload3.out+=`\x3c!--[--\x3e`;for(let index=0,$$length=each_array.length;index<$$length;index++){let item=each_array[index];$$payload3.out+=`<div${attr_class(`flex items-start space-x-3 ${stringify(item.account.accountType===AccountTypeCategory.SUB?"ml-6 border-l-2 border-blue-200 pl-4":"")}`)}>`;push_element($$payload3,"div",201,5);$$payload3.out+=`<div${attr_class(`flex-shrink-0 w-8 h-8 rounded-full ${stringify(item.account.accountType===AccountTypeCategory.PRIMARY?"bg-purple-100":"bg-blue-100")} flex items-center justify-center`)}>`;push_element($$payload3,"div",207,6);$$payload3.out+=`<svg${attr_class(`w-4 h-4 ${stringify(item.account.accountType===AccountTypeCategory.PRIMARY?"text-purple-600":"text-blue-600")}`)} fill="none" stroke="currentColor" viewBox="0 0 24 24">`;push_element($$payload3,"svg",213,7);$$payload3.out+=`<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"${attr("d",getAccountIcon(item.account.accountType))}>`;push_element($$payload3,"path",221,8);$$payload3.out+=`</path>`;pop_element();$$payload3.out+=`</svg>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div class="flex-1 min-w-0">`;push_element($$payload3,"div",231,6);$$payload3.out+=`<div class="flex items-center justify-between">`;push_element($$payload3,"div",232,7);$$payload3.out+=`<div>`;push_element($$payload3,"div",233,8);$$payload3.out+=`<p class="text-sm font-medium text-gray-900">`;push_element($$payload3,"p",234,9);$$payload3.out+=`${escape_html(item.account.name)} `;if(item.account.accountType===AccountTypeCategory.SUB){$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`<span class="text-xs text-gray-500">`;push_element($$payload3,"span",237,11);$$payload3.out+=`(Sub-account)</span>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e"}$$payload3.out+=`\x3c!--]--\x3e</p>`;pop_element();$$payload3.out+=` <p class="text-xs text-gray-500 font-mono">`;push_element($$payload3,"p",240,9);$$payload3.out+=`${escape_html(item.account.address.slice(0,6))}...${escape_html(item.account.address.slice(-4))}</p>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=` <div class="text-right">`;push_element($$payload3,"div",246,8);if(item.isLoading){$$payload3.out+="\x3c!--[--\x3e";SkeletonBalance($$payload3,{showLabel:false,className:"w-16"})}else if(item.error){$$payload3.out+="\x3c!--[1--\x3e";$$payload3.out+=`<div class="text-xs text-red-500">`;push_element($$payload3,"div",250,10);$$payload3.out+=`Error loading</div>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e";$$payload3.out+=`<div class="text-sm font-semibold text-gray-900">`;push_element($$payload3,"div",252,10);$$payload3.out+=`${escape_html(item.balanceFormatted)} ETH</div>`;pop_element();$$payload3.out+=` <div class="text-xs text-gray-600">`;push_element($$payload3,"div",255,10);$$payload3.out+=`${escape_html(item.valueFormatted)}</div>`;pop_element()}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element()}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload3.out+=` `;{$$payload3.out+="\x3c!--[!--\x3e"}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload3.out+=` `;{$$payload3.out+="\x3c!--[!--\x3e"}$$payload3.out+=`\x3c!--]--\x3e <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200">`;push_element($$payload3,"div",310,2);$$payload3.out+=`<button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">`;push_element($$payload3,"button",311,3);$$payload3.out+=`Cancel</button>`;pop_element();$$payload3.out+=` <button type="button" class="px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed"${attr("disabled",loading,true)}>`;push_element($$payload3,"button",318,3);$$payload3.out+=`${escape_html(`Delete Account${isPrimaryAccountWithSubs?"s":""}`)}</button>`;pop_element();$$payload3.out+=`</div>`;pop_element();$$payload3.out+=`</div>`;pop_element()}),$$slots:{default:true}})}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);bind_props($$props,{show:show});pop()}EnhancedDeleteConfirmation.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};AccountListing[FILENAME]="src/lib/components/AccountListing.svelte";function AccountListing($$payload,$$props){push(AccountListing);var $$store_subs;let{accounts:accounts=[],onAccountSelect:onAccountSelect=()=>{},onUpgrade:onUpgrade=()=>{}}=$$props;let editMode=false;let showEnhancedDeleteModal=false;let selectedAccount=null;let accountData=[];function retryBalance(accountAddress){return}onDestroy(()=>{});function handleEdit(account){selectedAccount=account;editMode=true}function handleDelete(account){selectedAccount=account;showEnhancedDeleteModal=true}async function confirmDelete(){if(selectedAccount){if(selectedAccount.accountType===AccountTypeCategory.PRIMARY){let subAccounts=accounts.filter(a=>a.primaryAccount?.address===selectedAccount.address);subAccounts.forEach(subAccount=>{const index=accounts.findIndex(a=>a.address===subAccount.address);if(index!==-1){accounts.splice(index,1)}})}accounts=accounts.filter(a=>a.address!==selectedAccount.address);setYakklAccountsStorage(accounts);store_set(yakklAccountsStore,accounts);if(selectedAccount.accountType===AccountTypeCategory.PRIMARY){let primaryAccounts=store_get($$store_subs??={},"$yakklPrimaryAccountsStore",yakklPrimaryAccountsStore).filter(a=>a.address!==selectedAccount.address);setYakklPrimaryAccountsStorage(primaryAccounts);selectedAccount=null}else{if(selectedAccount.address===store_get($$store_subs??={},"$yakklCurrentlySelectedStore",yakklCurrentlySelectedStore).shortcuts.address){selectedAccount=selectedAccount.primaryAccount?.account;onAccountSelect(selectedAccount)}}showEnhancedDeleteModal=false}}function updateAccount(updatedAccount){const index=accounts.findIndex(a=>a.address===updatedAccount.address);if(index!==-1){accounts[index]={...updatedAccount,updateDate:dateString()};if(updatedAccount.accountType===AccountTypeCategory.PRIMARY){updatePrimaryAndSubAccounts(updatedAccount)}setYakklAccountsStorage(accounts);store_set(yakklAccountsStore,accounts);selectedAccount=updatedAccount}editMode=false}function updatePrimaryAndSubAccounts(updatedPrimaryAccount){let primaryAccount=store_get($$store_subs??={},"$yakklPrimaryAccountsStore",yakklPrimaryAccountsStore).find(a=>a.address===updatedPrimaryAccount.address);if(primaryAccount){primaryAccount.name=updatedPrimaryAccount.name;primaryAccount.updateDate=dateString();setYakklPrimaryAccountsStorage(store_get($$store_subs??={},"$yakklPrimaryAccountsStore",yakklPrimaryAccountsStore))}let subAccounts=accounts.filter(a=>a.primaryAccount?.address===updatedPrimaryAccount.address);subAccounts.forEach(subAccount=>{const index=accounts.findIndex(a=>a.address===subAccount.address);if(index!==-1){accounts[index].primaryAccount.name=updatedPrimaryAccount.name;accounts[index].primaryAccount.updateDate=dateString()}})}function handleCopy(account){navigator.clipboard.writeText(account.address)}async function loadBalanceForDelete(address){const cached=balanceCacheManager.getCachedBalance(address);if(cached){log.info(`[AccountListing] Using cached balance for delete confirmation: ${address}`);return cached.balance}const accountDataItem=accountData.find(data=>data.account.address===address);if(accountDataItem&&!accountDataItem.isLoading&&!accountDataItem.loadingError){log.info(`[AccountListing] Using accountData balance for delete confirmation: ${address}`);return accountDataItem.quantity}return 0n}let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){const each_array=ensure_array_like(accountData);$$payload2.out+=`<ul class="overflow-hidden">`;push_element($$payload2,"ul",331,0);$$payload2.out+=`\x3c!--[--\x3e`;for(let $$index=0,$$length=each_array.length;$$index<$$length;$$index++){let data=each_array[$$index];$$payload2.out+=`<li class="mb-3 relative overflow-hidden">`;push_element($$payload2,"li",333,2);$$payload2.out+=`<button${attr_class(`w-full flex items-start rounded-lg p-3 transition-colors duration-200 overflow-hidden ${stringify(data.account.accountType===AccountTypeCategory.PRIMARY?"bg-purple-50 hover:bg-purple-100 border border-purple-200":data.account.accountType===AccountTypeCategory.SUB?"bg-blue-50 hover:bg-blue-100 border border-blue-200":"bg-green-50 hover:bg-green-100 border border-green-200")}`)}>`;push_element($$payload2,"button",334,3);$$payload2.out+=`<div${attr_class(`w-6 h-6 flex items-center justify-center rounded-full ${stringify(data.account.accountType===AccountTypeCategory.PRIMARY?"bg-purple-500":data.account.accountType===AccountTypeCategory.SUB?"bg-blue-500":"bg-green-500")} text-white mr-3 shrink-0`)}>`;push_element($$payload2,"div",343,4);$$payload2.out+=`<svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" viewBox="0 0 20 20" fill="currentColor">`;push_element($$payload2,"svg",351,5);$$payload2.out+=`<path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd">`;push_element($$payload2,"path",357,6);$$payload2.out+=`</path>`;pop_element();$$payload2.out+=`</svg>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=` <div class="flex-1 min-w-0 overflow-hidden">`;push_element($$payload2,"div",364,4);$$payload2.out+=`<div class="flex items-center justify-between mb-1">`;push_element($$payload2,"div",365,5);$$payload2.out+=`<div class="flex items-center space-x-2">`;push_element($$payload2,"div",366,6);$$payload2.out+=`<h3 class="text-sm font-semibold text-gray-800">`;push_element($$payload2,"h3",367,7);$$payload2.out+=`${escape_html(data.account.accountType===AccountTypeCategory.PRIMARY?"PORTFOLIO":data.account.accountType===AccountTypeCategory.SUB?"SUB-PORTFOLIO":"IMPORTED")}</h3>`;pop_element();$$payload2.out+=` `;if(data.account.accountType===AccountTypeCategory.PRIMARY){$$payload2.out+="\x3c!--[--\x3e";SubAccountIndicator($$payload2,{primaryAccount:data.account,allAccounts:accounts,className:"ml-1"})}else{$$payload2.out+="\x3c!--[!--\x3e"}$$payload2.out+=`\x3c!--]--\x3e</div>`;pop_element();$$payload2.out+=`</div>`;pop_element();$$payload2.out+=` <p class="text-sm font-medium text-gray-700 truncate mb-1"${attr("title",data.account.name)}>`;push_element($$payload2,"p",384,5);$$payload2.out+=`${escape_html(data.account.name)}</p>`;pop_element();$$payload2.out+=` `;if(data.account.accountType===AccountTypeCategory.SUB){$$payload2.out+="\x3c!--[--\x3e";$$payload2.out+=`<span class="text-xs text-gray-500 mb-1 block truncate"${attr("title",`Derived from ${stringify(data.account.primaryAccount?.name)}`)}>`;push_element($$payload2,"span",388,6);$$payload2.out+=`Derived from ${escape_html(data.account.primaryAccount?.name)}</span>`;pop_element()}else{$$payload2.out+="\x3c!--[!--\x3e"}$$payload2.out+=`\x3c!--]--\x3e <p class="text-xs text-gray-500 font-mono truncate mb-2"${attr("title",data.account.address)}>`;push_element($$payload2,"p",394,5);$$payload2.out+=`${escape_html(data.account.address)}</p>`;pop_element();$$payload2.out+=` `;BalanceIndicator($$payload2,{isLoading:data.isLoading,loadingError:data.loadingError,isCached:data.isCached,isStale:data.isStale,lastUpdated:data.lastUpdated,quantityFormatted:data.quantityFormatted,totalValueFormatted:data.totalValueFormatted,onRetry:()=>retryBalance(data.account.address)});$$payload2.out+=`\x3c!----\x3e</div>`;pop_element();$$payload2.out+=`</button>`;pop_element();$$payload2.out+=` `;EditControls($$payload2,{onEdit:()=>handleEdit(data.account),onDelete:()=>handleDelete(data.account),onCopy:()=>handleCopy(data.account),controls:["copy","edit","delete"],hasBalance:data.quantity>0n});$$payload2.out+=`\x3c!----\x3e</li>`;pop_element()}$$payload2.out+=`\x3c!--]--\x3e</ul>`;pop_element();$$payload2.out+=` `;{$$payload2.out+="\x3c!--[!--\x3e"}$$payload2.out+=`\x3c!--]--\x3e `;AccountForm($$payload2,{account:selectedAccount,onSubmit:updateAccount,get show(){return editMode},set show($$value){editMode=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e `;EnhancedDeleteConfirmation($$payload2,{account:selectedAccount,allAccounts:accounts,onConfirm:confirmDelete,onCancel:()=>showEnhancedDeleteModal=false,onLoadBalance:loadBalanceForDelete,get show(){return showEnhancedDeleteModal},set show($$value){showEnhancedDeleteModal=$$value;$$settled=false}});$$payload2.out+=`\x3c!----\x3e`}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);if($$store_subs)unsubscribe_stores($$store_subs);bind_props($$props,{accounts:accounts});pop()}AccountListing.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};Accounts[FILENAME]="src/lib/components/Accounts.svelte";function Accounts($$payload,$$props){push(Accounts);var $$store_subs;let{account:account=null,show:show=false,onAccountSelect:onAccountSelect=null,onClose:onClose=null,className:className="z-[999]"}=$$props;async function handleAccountSelect(selectedAccount){try{log.info("[Accounts] Account selected:",false,{name:selectedAccount.name,address:selectedAccount.address,type:selectedAccount.accountType,currentShowState:show});if(account!==null){account=selectedAccount}if(onAccountSelect!==null){onAccountSelect(selectedAccount)}const currentlySelected=store_get($$store_subs??={},"$yakklCurrentlySelectedStore",yakklCurrentlySelectedStore);if(currentlySelected){const updatedCurrentlySelected={...currentlySelected,shortcuts:{...currentlySelected.shortcuts,address:selectedAccount.address,accountName:selectedAccount.name,accountType:selectedAccount.accountType,alias:selectedAccount.alias,quantity:0n,primary:selectedAccount.accountType==="sub"?selectedAccount.primaryAccount:null},updateDate:dateString()};await setYakklCurrentlySelectedStorage(updatedCurrentlySelected);log.info("[Accounts] Successfully updated currently selected account, closing modal")}else{log.warn("[Accounts] No currently selected store found, cannot update account")}show=false;if(onClose){onClose()}log.info("[Accounts] Modal show state set to false:",false,{show:show})}catch(error){log.error("[Accounts] Failed to update selected account:",false,error);show=false;if(onClose){onClose()}}}function handleUpgrade(){show=false;openModal("upgrade")}function closeModal(){show=false;if(onClose){onClose()}}let $$settled=true;let $$inner_payload;function $$render_inner($$payload2){$$payload2.out+=`<div${attr_class(`relative ${stringify(className)}`)}>`;push_element($$payload2,"div",81,0);{let footer=function($$payload3){validate_snippet_args($$payload3);$$payload3.out+=`<p class="text-sm text-gray-500">`;push_element($$payload3,"p",104,3);$$payload3.out+=`Whatever account you select will become your <span class="font-bold underline">`;push_element($$payload3,"span",105,49);$$payload3.out+=`active</span>`;pop_element();$$payload3.out+=` account!</p>`;pop_element()};prevent_snippet_stringification(footer);Modal($$payload2,{title:"Account List",description:"Select the account you wish to make current",onClose:closeModal,onCancel:closeModal,get show(){return show},set show($$value){show=$$value;$$settled=false},footer:footer,children:prevent_snippet_stringification($$payload3=>{$$payload3.out+=`<div class="border-t border-b border-gray-500 py-4">`;push_element($$payload3,"div",89,2);AccountListing($$payload3,{accounts:store_get($$store_subs??={},"$yakklAccountsStore",yakklAccountsStore),onAccountSelect:handleAccountSelect,onUpgrade:handleUpgrade});$$payload3.out+=`\x3c!----\x3e `;if(store_get($$store_subs??={},"$yakklCurrentlySelectedStore",yakklCurrentlySelectedStore)&&store_get($$store_subs??={},"$yakklCurrentlySelectedStore",yakklCurrentlySelectedStore).shortcuts.address===YAKKL_ZERO_ADDRESS){$$payload3.out+="\x3c!--[--\x3e";$$payload3.out+=`<p class="text-lg font-bold text-red-500">`;push_element($$payload3,"p",97,4);$$payload3.out+=`There are no Portfolio Accounts to display! Create at least one Portfolio account!</p>`;pop_element()}else{$$payload3.out+="\x3c!--[!--\x3e"}$$payload3.out+=`\x3c!--]--\x3e</div>`;pop_element()}),$$slots:{footer:true,default:true}})}$$payload2.out+=`\x3c!----\x3e</div>`;pop_element()}do{$$settled=true;$$inner_payload=copy_payload($$payload);$$render_inner($$inner_payload)}while(!$$settled);assign_payload($$payload,$$inner_payload);if($$store_subs)unsubscribe_stores($$store_subs);bind_props($$props,{account:account,show:show});pop()}Accounts.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};Copy[FILENAME]="src/lib/components/Copy.svelte";function Copy($$payload,$$props){push(Copy);const{target:target,size:size=20,className:className="",showFeedback:showFeedback=true,feedbackDuration:feedbackDuration=2e3,defaultRedactText:defaultRedactText="<redacted>",onClick:onClick=void 0}=$$props;UnifiedTimerManager.getInstance();$$payload.out+=`<button type="button"${attr_class(` inline-flex items-center justify-center transition-all duration-200 ease-in-out rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${stringify(className)} `)} title="Copy to clipboard">`;push_element($$payload,"button",104,0);{$$payload.out+="\x3c!--[!--\x3e";$$payload.out+=`<svg xmlns="http://www.w3.org/2000/svg"${attr("width",size)}${attr("height",size)} viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500 hover:text-blue-500 transition-colors duration-200" aria-hidden="true">`;push_element($$payload,"svg",141,2);$$payload.out+=`<rect x="9" y="9" width="13" height="13" rx="2" ry="2">`;push_element($$payload,"rect",154,3);$$payload.out+=`</rect>`;pop_element();$$payload.out+=`<path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1">`;push_element($$payload,"path",155,3);$$payload.out+=`</path>`;pop_element();$$payload.out+=`</svg>`;pop_element();$$payload.out+=` <span class="sr-only">`;push_element($$payload,"span",157,2);$$payload.out+=`Copy to clipboard</span>`;pop_element()}$$payload.out+=`\x3c!--]--\x3e</button>`;pop_element();pop()}Copy.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};export{Accounts as A,Copy as C};
//# sourceMappingURL=Copy.js.map
