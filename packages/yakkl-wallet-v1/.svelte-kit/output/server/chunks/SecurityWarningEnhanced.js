import{F as FILENAME}from"./utils.js";import"clsx";import{p as push,c as pop}from"./index2.js";import{o as onDestroy}from"./index-server2.js";import{N as NotificationService}from"./notifications.js";import{a as browser_ext}from"./environment.js";import{hideSecurityWarning}from"./securityWarning.js";import{l as log}from"./encryption.js";import{UnifiedTimerManager}from"./UnifiedTimerManager.js";SecurityWarningEnhanced[FILENAME]="src/lib/components/SecurityWarningEnhanced.svelte";function SecurityWarningEnhanced($$payload,$$props){push(SecurityWarningEnhanced);let{warningTime:warningTime=30,onComplete:onComplete=()=>{}}=$$props;let isCleaningUp=false;let timerManager=UnifiedTimerManager.getInstance();function cleanup(){timerManager.stopTimeout("title-flash");timerManager.removeTimeout("title-flash");if(typeof window!=="undefined"){const audioContext=window.__yakklAudioContext;if(audioContext&&audioContext.state!=="closed"){audioContext.close().catch(()=>{});window.__yakklAudioContext=null}}removeListeners()}function handleUserActivity(){if(isCleaningUp)return;log.info("ðŸ‘† [SecurityWarningEnhanced] User activity detected - canceling warning");isCleaningUp=true;try{cleanup();hideSecurityWarning();if(browser_ext){browser_ext.runtime.sendMessage({type:"USER_ACTIVITY",timestamp:Date.now(),context:"security",action:"security_warning_interaction"}).catch(()=>{})}NotificationService.clearAllAlertsEnhanced().catch(error=>{log.warn("Error clearing enhanced alerts from SecurityWarning:",false,error)})}catch(error){log.error("Error in handleUserActivity:",false,error)}finally{isCleaningUp=false}}function removeListeners(){if(typeof window==="undefined")return;window.removeEventListener("mousemove",handleUserActivity);window.removeEventListener("keydown",handleUserActivity);window.removeEventListener("click",handleUserActivity);window.removeEventListener("focus",handleUserActivity);log.debug("âœ… [SecurityWarningEnhanced] Activity listeners removed")}onDestroy(()=>{log.info("ðŸ”¥ [SecurityWarningEnhanced] Component destroyed - performing cleanup");cleanup()});{$$payload.out+="\x3c!--[!--\x3e"}$$payload.out+=`\x3c!--]--\x3e`;pop()}SecurityWarningEnhanced.render=function(){throw new Error("Component.render(...) is no longer valid in Svelte 5. See https://svelte.dev/docs/svelte/v5-migration-guide#Components-are-no-longer-classes for more information")};export{SecurityWarningEnhanced as S};
//# sourceMappingURL=SecurityWarningEnhanced.js.map
