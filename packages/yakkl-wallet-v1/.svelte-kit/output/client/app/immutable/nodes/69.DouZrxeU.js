const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BO6zr7mn.js","../chunks/BXFaAXnq.js","../chunks/BaS8d5lg.js","../chunks/3AhEABF_.js","../chunks/Cm3jf07C.js","../chunks/DX_EEhpR.js","../chunks/BYboeQtC.js","../chunks/CViNpZsE.js","../chunks/B2gA1VsD.js","../chunks/D-5FeuF0.js","../chunks/CoXEMRXA.js","../chunks/Cmwrv3PW.js","../chunks/DiU70Is3.js","../chunks/twIkBoiu.js","../chunks/BgcCkDX2.js","../chunks/Q1yPWpQ-.js","../chunks/DraJ8LN-.js","../chunks/Dv9a3G0k.js","../chunks/D_ljX5ue.js","../chunks/D1JcdFy3.js","../chunks/DZ17DrFv.js","../chunks/Cb2naUpm.js","../chunks/WDN37msH.js","../chunks/CgCfpVku.js","../chunks/BOosul_h.js","../chunks/d5hrMixo.js","../chunks/DTBsVM-c.js","../chunks/CkqS9PXN.js"])))=>i.map(i=>d[i]);
var __defProp=Object.defineProperty;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:true,configurable:true,writable:true,value:value}):obj[key]=value;var __publicField=(obj,key,value)=>__defNormalProp(obj,typeof key!=="symbol"?key+"":key,value);import{bM as parseEther,bN as id,bO as AbiCoder,t as parseUnits,bP as formatEther,bQ as isAddress,l as log,O as YAKKL_ZERO_ADDRESS,Z as yakklCurrentlySelectedStore,_ as __vitePreload}from"../chunks/Cb2naUpm.js";import{c as check_target,l as legacy_api}from"../chunks/BXFaAXnq.js";import{p as push,c as child,r as reset,t as template_effect,a as pop,s as sibling,f as first_child,F as FILENAME,h as tag,u as user_derived,i as state,g as get$1,b as strict_equals,j as next,e as set,ae as proxy,ay as user_effect,o as onMount}from"../chunks/BaS8d5lg.js";import{a as add_locations}from"../chunks/3AhEABF_.js";import{s as set_text}from"../chunks/Cmwrv3PW.js";import{i as if_block}from"../chunks/Q1yPWpQ-.js";import{a as append,f as from_html,d as from_svg,c as comment,t as text}from"../chunks/Cm3jf07C.js";import{v as validate_store}from"../chunks/Dv9a3G0k.js";import{s as set_attribute,r as remove_input_defaults,b as bind_select_value}from"../chunks/DTBsVM-c.js";import{s as set_class}from"../chunks/DX_EEhpR.js";import{d as delegate,b as apply}from"../chunks/DiU70Is3.js";import{s as setup_stores,a as store_get}from"../chunks/CViNpZsE.js";import{l as log_if_contains_state}from"../chunks/DZ17DrFv.js";import{e as each,i as index}from"../chunks/DraJ8LN-.js";import{p as prop}from"../chunks/BYboeQtC.js";import{g as get,d as derived,w as writable}from"../chunks/B2gA1VsD.js";import{B as BaseService,a as currentAccount,c as currentChain,M as Modal,m as modalStore,i as isModalOpen,A as AIHelpButton}from"../chunks/BO6zr7mn.js";import{b as bind_value}from"../chunks/B6q982nR.js";import{c as canUseFeature,d as canUseFeature$1,U as Upgrade}from"../chunks/CoXEMRXA.js";import{c as create_ownership_validator}from"../chunks/COgMMZ9C.js";import{w as wrap_snippet}from"../chunks/d5hrMixo.js";import{b as bind_this}from"../chunks/BMXnoaUY.js";import{Q as QRCode}from"../chunks/C7pQqEHo.js";import"../chunks/CgCfpVku.js";import"../chunks/WDN37msH.js";import{UnifiedTimerManager}from"../chunks/z-nmOEXa.js";import{t as timeoutClipboard}from"../chunks/CnIbzB-6.js";import"../chunks/Dw28gLPr.js";import"../chunks/D-aJ6pD4.js";import{u as uiStore}from"../chunks/Cb-Maka9.js";import{S as SimpleTooltip}from"../chunks/De3JWpHf.js";import{M as ModDashboard,a as initializeCore}from"../chunks/B6Kd56jc.js";MoreLess[FILENAME]="src/routes/preview2/lib/components/MoreLess.svelte";var root_1$8=add_locations(from_svg(`<svg class="w-4 h-4 mr-1 fill-current text-blue-400 dark:text-blue-300" viewBox="0 0 20 20"><path d="M7 5l5 5-5 5"></path></svg> `,1),MoreLess[FILENAME],[[17,4,[[18,6]]]]);var root_2$8=add_locations(from_svg(`<svg class="w-4 h-4 mr-1 fill-current text-blue-400 dark:text-blue-300 transform -rotate-90" viewBox="0 0 20 20"><path d="M7 5l5 5-5 5"></path></svg> `,1),MoreLess[FILENAME],[[22,4,[[23,6]]]]);var root$6=add_locations(from_html(`<button type="button"><!></button>`),MoreLess[FILENAME],[[11,0]]);function MoreLess($$anchor,$$props){check_target(new.target);push($$props,true,MoreLess);let count=prop($$props,"count",3,1),text2=prop($$props,"text",3,"more"),lessText=prop($$props,"lessText",3,"less"),expanded=prop($$props,"expanded",3,false),className=prop($$props,"className",3,""),onclick=prop($$props,"onclick",3,null);var button=root$6();button.__click=function(...$$args){apply(onclick,this,$$args,MoreLess,[14,11])};var node=child(button);{var consequent=$$anchor2=>{var fragment=root_1$8();var text_1=sibling(first_child(fragment));template_effect(()=>set_text(text_1,` + ${count()??""}${text2()??""}`));append($$anchor2,fragment)};var alternate=$$anchor2=>{var fragment_1=root_2$8();var text_2=sibling(first_child(fragment_1),1,true);template_effect(()=>set_text(text_2,lessText()));append($$anchor2,fragment_1)};if_block(node,$$render=>{if(!expanded())$$render(consequent);else $$render(alternate,false)})}reset(button);template_effect(()=>set_class(button,1,`flex items-center gap-1 text-xs text-blue-500 dark:text-blue-400 underline cursor-pointer select-none px-2 py-1 rounded hover:bg-blue-100 dark:hover:bg-zinc-700 transition ${className()}`));append($$anchor,button);return pop({...legacy_api()})}delegate(["click"]);const _TransactionService=class _TransactionService extends BaseService{constructor(){super()}static getInstance(){if(!_TransactionService.instance){_TransactionService.instance=new _TransactionService}return _TransactionService.instance}async sendTransaction(params){try{const account=get(currentAccount);const chain=get(currentChain);if(!account){return{success:false,error:{hasError:true,message:"No account selected"}}}const txParams={from:account.address,to:params.to,value:params.tokenAddress?"0x0":parseEther(params.value).toString(),chainId:chain==null?void 0:chain.chainId};if(params.tokenAddress){const transferData=this.encodeTokenTransfer(params.to,params.value);txParams.to=params.tokenAddress;txParams.data=transferData}if(params.gasPrice){txParams.gasPrice=params.gasPrice}if(params.gasLimit){txParams.gas=params.gasLimit}const response=await this.sendMessage({method:"eth_sendTransaction",params:[txParams]});return response}catch(error){return{success:false,error:this.handleError(error)}}}async getTransactionHistory(address,limit=10){try{const response=await this.sendMessage({method:"yakkl_getTransactionHistory",params:[address,limit]});if(response.success&&response.data){const transactions=response.data.map(tx=>({hash:tx.hash,from:tx.from,to:tx.to,value:tx.value,timestamp:tx.timestamp||Date.now(),status:this.mapTxStatus(tx.status),type:this.determineTxType(tx,address),gas:tx.gas,gasPrice:tx.gasPrice}));return{success:true,data:transactions}}return response}catch(error){return{success:false,error:this.handleError(error)}}}async estimateGas(params){try{const account=get(currentAccount);if(!account){return{success:false,error:{hasError:true,message:"No account selected"}}}const txParams={from:account.address,to:params.to,value:params.tokenAddress?"0x0":parseEther(params.value).toString()};if(params.tokenAddress){txParams.to=params.tokenAddress;txParams.data=this.encodeTokenTransfer(params.to,params.value)}const response=await this.sendMessage({method:"eth_estimateGas",params:[txParams]});return response}catch(error){return{success:false,error:this.handleError(error)}}}async getGasPrice(){try{const response=await this.sendMessage({method:"eth_gasPrice"});return response}catch(error){return{success:false,error:this.handleError(error)}}}encodeTokenTransfer(to,amount){const transferFn="transfer(address,uint256)";const transferSelector=id(transferFn).slice(0,10);const encodedParams=AbiCoder.defaultAbiCoder().encode(["address","uint256"],[to,parseUnits(amount,18)]);return transferSelector+encodedParams.slice(2)}mapTxStatus(status){if(status==="0x0"||status===0)return"failed";if(status==="0x1"||status===1)return"confirmed";return"pending"}determineTxType(tx,userAddress){var _a,_b;const from=(_a=tx.from)==null?void 0:_a.toLowerCase();const to=(_b=tx.to)==null?void 0:_b.toLowerCase();const user=userAddress.toLowerCase();if(from===user&&to!==user)return"send";if(from!==user&&to===user)return"receive";if(tx.data&&tx.data!=="0x")return"contract";return"send"}};__publicField(_TransactionService,"instance");let TransactionService=_TransactionService;function createTransactionStore(){const txService=TransactionService.getInstance();const{subscribe:subscribe,set:set2,update:update}=writable({transactions:[],pendingTx:null,loading:{isLoading:false},error:{hasError:false},gasPrice:null});currentAccount.subscribe(async account=>{if(account){await loadTransactions(account.address)}});async function loadTransactions(address){update(state2=>({...state2,loading:{isLoading:true,message:"Loading transactions..."}}));const response=await txService.getTransactionHistory(address);if(response.success&&response.data){update(state2=>({...state2,transactions:response.data,loading:{isLoading:false},error:{hasError:false}}))}else{update(state2=>({...state2,loading:{isLoading:false},error:response.error||{hasError:true,message:"Failed to load transactions"}}))}}return{subscribe:subscribe,async sendTransaction(to,value,tokenAddress){var _a;update(state2=>({...state2,loading:{isLoading:true,message:"Sending transaction..."},error:{hasError:false}}));const response=await txService.sendTransaction({to:to,value:value,tokenAddress:tokenAddress});if(response.success&&response.data){update(state2=>({...state2,pendingTx:response.data,loading:{isLoading:false},error:{hasError:false}}));setTimeout(()=>{const account=get(currentAccount);if(account){loadTransactions(account.address)}},3e3);return response.data}else{update(state2=>({...state2,loading:{isLoading:false},error:response.error||{hasError:true,message:"Transaction failed"}}));throw new Error(((_a=response.error)==null?void 0:_a.message)||"Transaction failed")}},async estimateGas(to,value,tokenAddress){const response=await txService.estimateGas({to:to,value:value,tokenAddress:tokenAddress});return response},async updateGasPrice(){const response=await txService.getGasPrice();if(response.success&&response.data){update(state2=>({...state2,gasPrice:response.data}))}},clearError(){update(state2=>({...state2,error:{hasError:false}}))},reset(){set2({transactions:[],pendingTx:null,loading:{isLoading:false},error:{hasError:false},gasPrice:null})}}}const transactionStore=createTransactionStore();const recentTransactions=derived(transactionStore,$store=>$store.transactions.slice(0,5));derived(transactionStore,$store=>$store.pendingTx);const isLoadingTx=derived(transactionStore,$store=>$store.loading.isLoading);const txError=derived(transactionStore,$store=>$store.error);RecentActivity[FILENAME]="src/routes/preview2/lib/components/RecentActivity.svelte";var root_2$7=add_locations(from_html(`<div class="flex items-center gap-2 py-2 animate-pulse"><div class="w-8 h-4 bg-zinc-300 dark:bg-zinc-600 rounded"></div> <div class="flex-1 h-3 bg-zinc-300 dark:bg-zinc-600 rounded"></div> <div class="w-16 h-3 bg-zinc-300 dark:bg-zinc-600 rounded"></div></div>`),RecentActivity[FILENAME],[[73,8,[[74,10],[75,10],[76,10]]]]);var root_1$7=add_locations(from_html(`<div class="space-y-2"></div>`),RecentActivity[FILENAME],[[71,4]]);var root_4$6=add_locations(from_html(`<div class="text-center py-8 text-gray-500 dark:text-gray-400"><p>No recent activity</p> <p class="text-sm mt-2">Your transactions will appear here</p></div>`),RecentActivity[FILENAME],[[81,4,[[82,6],[83,6]]]]);var root_7$5=add_locations(from_html(`<div class="flex items-center gap-1"><span> </span></div> <div class="text-gray-400 dark:text-gray-500 truncate"> </div>`,1),RecentActivity[FILENAME],[[99,14,[[100,16]]],[105,14]]);var root_9$4=add_locations(from_html(`<div class="font-bold text-blue-500">Swap</div> <div class="text-gray-400 dark:text-gray-500 truncate">Contract interaction</div>`,1),RecentActivity[FILENAME],[[109,14],[110,14]]);var root_10$3=add_locations(from_html(`<div class="font-bold text-purple-500">Contract</div> <div class="text-gray-400 dark:text-gray-500 truncate"> </div>`,1),RecentActivity[FILENAME],[[114,14],[115,14]]);var root_6$5=add_locations(from_html(`<li class="flex items-center gap-2 text-xs border-b border-zinc-100 dark:border-zinc-700 py-2 last:border-b-0"><span class="text-lg"> </span> <div class="flex-1 min-w-0"><!></div> <span> </span> <span class="text-gray-400 dark:text-gray-500 whitespace-nowrap ml-2"> </span></li>`),RecentActivity[FILENAME],[[90,8,[[92,10],[97,10],[122,10],[127,10]]]]);var root_5$4=add_locations(from_html(`<ul class="space-y-1 max-h-44 overflow-y-auto"></ul> <!>`,1),RecentActivity[FILENAME],[[86,4]]);var root$5=add_locations(from_html(`<div><div class="text-sm font-semibold mb-2 text-zinc-700 dark:text-zinc-200">Recent Activity</div> <!></div>`),RecentActivity[FILENAME],[[67,0,[[68,2]]]]);function RecentActivity($$anchor,$$props){check_target(new.target);push($$props,true,RecentActivity);const[$$stores,$$cleanup]=setup_stores();const $recentTransactions=()=>(validate_store(recentTransactions,"recentTransactions"),store_get(recentTransactions,"$recentTransactions",$$stores));const $isLoadingTx=()=>(validate_store(isLoadingTx,"isLoadingTx"),store_get(isLoadingTx,"$isLoadingTx",$$stores));const $currentAccount=()=>(validate_store(currentAccount,"currentAccount"),store_get(currentAccount,"$currentAccount",$$stores));let className=prop($$props,"className",3,""),maxRows=prop($$props,"maxRows",3,4);let transactions=tag(user_derived($recentTransactions),"transactions");let loading=tag(user_derived($isLoadingTx),"loading");let account=tag(user_derived($currentAccount),"account");let expanded=tag(state(false),"expanded");let visible=tag(user_derived(()=>get$1(expanded)?get$1(transactions):get$1(transactions).slice(0,maxRows())),"visible");let hidden=tag(user_derived(()=>get$1(expanded)?[]:get$1(transactions).slice(maxRows())),"hidden");function formatAmount(value){try{const num=parseFloat(value);if(num<1e-4){return num.toExponential(2)}return num.toFixed(4)}catch{return value}}function shortAddress(address){if(!address)return"";return`${address.slice(0,6)}...${address.slice(-4)}`}function formatTime(timestamp){const now=Date.now();const diff=now-timestamp;const minutes=Math.floor(diff/6e4);const hours=Math.floor(diff/36e5);const days=Math.floor(diff/864e5);if(minutes<1)return"Just now";if(minutes<60)return`${minutes}m ago`;if(hours<24)return`${hours}h ago`;return`${days}d ago`}function getTransactionDirection(tx){var _a;return strict_equals(tx.from.toLowerCase(),(_a=get$1(account))==null?void 0:_a.address.toLowerCase())?"sent":"received"}function getStatusColor(status){switch(status){case"confirmed":return"bg-green-200 text-green-800 dark:bg-green-900 dark:text-green-200";case"failed":return"bg-red-200 text-red-800 dark:bg-red-900 dark:text-red-200";case"pending":default:return"bg-yellow-200 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}}function getTransactionIcon(type){switch(type){case"send":return"↗️";case"receive":return"↙️";case"swap":return"🔄";case"contract":return"📄";default:return"💸"}}var div=root$5();var node=sibling(child(div),2);{var consequent=$$anchor2=>{var div_1=root_1$7();each(div_1,20,()=>Array(3),index,($$anchor3,_)=>{var div_2=root_2$7();append($$anchor3,div_2)});reset(div_1);append($$anchor2,div_1)};var alternate=($$anchor2,$$elseif)=>{{var consequent_1=$$anchor3=>{var div_3=root_4$6();append($$anchor3,div_3)};var alternate_1=$$anchor3=>{var fragment=root_5$4();var ul=first_child(fragment);each(ul,21,()=>get$1(visible),index,($$anchor4,tx)=>{var li=root_6$5();const direction=user_derived(()=>getTransactionDirection(get$1(tx)));get$1(direction);const isOutgoing=user_derived(()=>strict_equals(get$1(direction),"sent"));get$1(isOutgoing);var span=child(li);var text2=child(span,true);reset(span);var div_4=sibling(span,2);var node_1=child(div_4);{var consequent_2=$$anchor5=>{var fragment_1=root_7$5();var div_5=first_child(fragment_1);var span_1=child(div_5);var text_1=child(span_1);reset(span_1);reset(div_5);var div_6=sibling(div_5,2);var text_2=child(div_6);reset(div_6);template_effect(($0,$1)=>{set_class(span_1,1,`font-bold ${get$1(isOutgoing)?"text-red-500":"text-green-500"}`);set_text(text_1,`${get$1(isOutgoing)?"−":"+"}\n                  ${$0??""} ETH`);set_text(text_2,`${get$1(isOutgoing)?"to":"from"} ${$1??""}`)},[()=>formatAmount(get$1(tx).value),()=>shortAddress(get$1(isOutgoing)?get$1(tx).to:get$1(tx).from)]);append($$anchor5,fragment_1)};var alternate_2=($$anchor5,$$elseif2)=>{{var consequent_3=$$anchor6=>{var fragment_2=root_9$4();next(2);append($$anchor6,fragment_2)};var alternate_3=$$anchor6=>{var fragment_3=root_10$3();var div_7=sibling(first_child(fragment_3),2);var text_3=child(div_7,true);reset(div_7);template_effect($0=>set_text(text_3,$0),[()=>shortAddress(get$1(tx).to)]);append($$anchor6,fragment_3)};if_block($$anchor5,$$render=>{if(strict_equals(get$1(tx).type,"swap"))$$render(consequent_3);else $$render(alternate_3,false)},$$elseif2)}};if_block(node_1,$$render=>{if(strict_equals(get$1(tx).type,"send")||strict_equals(get$1(tx).type,"receive"))$$render(consequent_2);else $$render(alternate_2,false)})}reset(div_4);var span_2=sibling(div_4,2);var text_4=child(span_2,true);reset(span_2);var span_3=sibling(span_2,2);var text_5=child(span_3,true);reset(span_3);reset(li);template_effect(($0,$1,$2,$3)=>{set_attribute(span,"title",get$1(tx).type);set_text(text2,$0);set_class(span_2,1,`px-2 py-0.5 rounded-full text-xs ${$1??""} whitespace-nowrap`);set_text(text_4,$2);set_text(text_5,$3)},[()=>getTransactionIcon(get$1(tx).type),()=>getStatusColor(get$1(tx).status),()=>get$1(tx).status.charAt(0).toUpperCase()+get$1(tx).status.slice(1),()=>formatTime(get$1(tx).timestamp)]);append($$anchor4,li)});reset(ul);var node_2=sibling(ul,2);{var consequent_4=$$anchor4=>{MoreLess($$anchor4,{get count(){return get$1(hidden).length},text:"more",lessText:"less",get expanded(){return get$1(expanded)},className:"mt-2",onclick:()=>set(expanded,!get$1(expanded))})};if_block(node_2,$$render=>{if(get$1(hidden).length>0)$$render(consequent_4)})}append($$anchor3,fragment)};if_block($$anchor2,$$render=>{if(strict_equals(get$1(transactions).length,0))$$render(consequent_1);else $$render(alternate_1,false)},$$elseif)}};if_block(node,$$render=>{if(get$1(loading))$$render(consequent);else $$render(alternate,false)})}reset(div);template_effect(()=>set_class(div,1,`bg-white/70 dark:bg-zinc-800 rounded-2xl shadow p-4 mt-3 relative z-10 ${className()}`));append($$anchor,div);var $$pop=pop({...legacy_api()});$$cleanup();return $$pop}SendModal[FILENAME]="src/routes/preview2/lib/components/SendModal.svelte";function handleSubmit(_,validationError,mode,submitSend,submitSwap){set(validationError,"");if(strict_equals(mode(),"send")){submitSend()}else{submitSwap()}}var on_keydown$1=(e,closeModal)=>strict_equals(e.key,"Escape")&&closeModal();var on_click$3=e=>e.stopPropagation();var on_keydown_1$1=e=>e.stopPropagation();var root_3$4=add_locations(from_html(`<img class="w-6 h-6"/>`),SendModal[FILENAME],[[137,14]]);var root_4$5=add_locations(from_html(`<span class="text-xl"> </span>`),SendModal[FILENAME],[[139,14]]);var root_6$4=add_locations(from_html(`<option> </option>`),SendModal[FILENAME],[[165,14]]);var root_5$3=add_locations(from_html(`<div><label for="from-token-select" class="block text-xs mb-1 text-gray-600 dark:text-gray-400">From Token</label> <select id="from-token-select" class="w-full rounded bg-zinc-100 dark:bg-zinc-800 p-2 mb-1 text-zinc-900 dark:text-white"></select></div>`),SendModal[FILENAME],[[157,8,[[158,10],[159,10]]]]);var root_8$3=add_locations(from_html(`<option> </option>`),SendModal[FILENAME],[[179,14]]);var root_7$4=add_locations(from_html(`<div><label for="send-token-select" class="block text-xs mb-1 text-gray-600 dark:text-gray-400">Token</label> <select id="send-token-select" class="w-full rounded bg-zinc-100 dark:bg-zinc-800 p-2 mb-1 text-zinc-900 dark:text-white"></select></div>`),SendModal[FILENAME],[[171,8,[[172,10],[173,10]]]]);var on_click_1$3=(__1,amount,selectedToken)=>{var _a;return set(amount,((_a=get$1(selectedToken).qty)==null?void 0:_a.toString())||"0",true)};var root_10$2=add_locations(from_html(`<span class="animate-pulse">Estimating gas...</span>`),SendModal[FILENAME],[[231,12]]);var root_9$3=add_locations(from_html(`<div class="text-xs text-gray-500 dark:text-gray-400"><!></div>`),SendModal[FILENAME],[[229,8]]);var root_12$3=add_locations(from_html(`<div id="validation-error" class="text-xs text-red-500 bg-red-50 dark:bg-red-900/20 p-2 rounded" role="alert"> </div>`),SendModal[FILENAME],[[240,8]]);var root_13$2=add_locations(from_html(`<div class="text-xs text-red-500 bg-red-50 dark:bg-red-900/20 p-2 rounded" role="alert"> </div>`),SendModal[FILENAME],[[246,8]]);var root_14$2=add_locations(from_html(`<div class="flex items-center justify-center gap-2"><div class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div> </div>`),SendModal[FILENAME],[[258,10,[[259,12]]]]);var root_1$6=add_locations(from_html(`<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in" role="dialog" aria-modal="true" aria-label="Send tokens modal"><div class="relative bg-white dark:bg-zinc-900 rounded-2xl shadow-xl p-6 min-w-[320px] w-full max-w-xs flex flex-col gap-4 animate-in slide-in-from-bottom-10"><div class="flex items-center justify-between mb-2"><div class="flex items-center gap-2"><!> <span class="font-bold text-lg capitalize"> </span></div> <button class="text-2xl text-gray-400 hover:text-red-500 transition-colors" aria-label="Close modal">×</button></div> <!> <div><label for="recipient-input" class="block text-xs mb-1 text-gray-600 dark:text-gray-400"> </label> <input id="recipient-input" type="text" placeholder="0x..."/></div> <div><label for="amount-input" class="block text-xs mb-1 text-gray-600 dark:text-gray-400">Amount</label> <div class="relative"><input id="amount-input" type="number" min="0" step="any" placeholder="0.00"/> <button class="absolute right-2 top-2 text-xs text-blue-500 hover:text-blue-600">MAX</button></div></div> <!> <!> <!> <button><!></button></div></div>`),SendModal[FILENAME],[[122,2,[[128,4,[[133,6,[[134,8,[[142,10]]],[146,8]]],[188,6,[[189,8],[192,8]]],[204,6,[[205,8],[206,8,[[207,10],[218,10]]]]],[252,6]]]]]]);function SendModal($$anchor,$$props){check_target(new.target);push($$props,true,SendModal);const[$$stores,$$cleanup]=setup_stores();const $isLoadingTx=()=>(validate_store(isLoadingTx,"isLoadingTx"),store_get(isLoadingTx,"$isLoadingTx",$$stores));const $txError=()=>(validate_store(txError,"txError"),store_get(txError,"$txError",$$stores));let show=prop($$props,"show",11,false),onClose=prop($$props,"onClose",3,null),onSend=prop($$props,"onSend",3,null),tokens2=prop($$props,"tokens",19,()=>[]),chain=prop($$props,"chain",19,()=>({icon:"/images/eth.svg",name:"Ethereum"})),mode=prop($$props,"mode",3,"send");let recipient=tag(state(""),"recipient");let amount=tag(state(""),"amount");let selectedToken=tag(state(proxy(tokens2()[0]||{symbol:"ETH",icon:"/images/eth.svg"})),"selectedToken");let gasEstimate=tag(state(""),"gasEstimate");let estimatingGas=tag(state(false),"estimatingGas");let validationError=tag(state(""),"validationError");let sending=tag(user_derived($isLoadingTx),"sending");let error=tag(user_derived($txError),"error");user_effect(()=>{if(tokens2().length>0&&!get$1(selectedToken)){set(selectedToken,tokens2()[0],true)}});function validateAddress(address){try{return isAddress(address)}catch{return false}}function validateAmount(amt){const num=parseFloat(amt);return!isNaN(num)&&num>0}user_effect(()=>{if(get$1(recipient)&&get$1(amount)&&validateAddress(get$1(recipient))&&validateAmount(get$1(amount))){estimateGas()}});async function estimateGas(){if(!canUseFeature("send_tokens"))return;set(estimatingGas,true);try{const isETH=strict_equals(get$1(selectedToken).symbol,"ETH");const response=await transactionStore.estimateGas(get$1(recipient),get$1(amount),isETH?void 0:get$1(selectedToken).address);if(response.success&&response.data){const gasInEth=formatEther(response.data);set(gasEstimate,`~${parseFloat(gasInEth).toFixed(6)} ETH`)}}catch(error2){set(gasEstimate,"Unable to estimate")}finally{set(estimatingGas,false)}}function validateInputs(){if(!get$1(recipient))return"Recipient address is required";if(!validateAddress(get$1(recipient)))return"Invalid recipient address";if(!get$1(amount))return"Amount is required";if(!validateAmount(get$1(amount)))return"Invalid amount";if(parseFloat(get$1(amount))>get$1(selectedToken).qty)return"Insufficient balance";return null}function closeModal(){set(recipient,"");set(amount,"");set(gasEstimate,"");set(validationError,"");transactionStore.clearError();if(onClose())onClose()()}async function submitSend(){const validation=validateInputs();if(validation){set(validationError,validation,true);return}if(!canUseFeature("send_tokens")){set(validationError,"Send feature requires Pro plan");return}try{const isETH=strict_equals(get$1(selectedToken).symbol,"ETH");const txHash=await transactionStore.sendTransaction(get$1(recipient),get$1(amount),isETH?void 0:get$1(selectedToken).address);if(onSend()){await onSend()({recipient:get$1(recipient),amount:get$1(amount),token:get$1(selectedToken),txHash:txHash})}closeModal()}catch(error2){set(validationError,error2 instanceof Error?error2.message:"Transaction failed",true)}}async function submitSwap(){set(validationError,"Swap functionality coming soon")}var fragment=comment();var node=first_child(fragment);{var consequent_9=$$anchor2=>{var div=root_1$6();div.__click=closeModal;div.__keydown=[on_keydown$1,closeModal];var div_1=child(div);div_1.__click=[on_click$3];div_1.__keydown=[on_keydown_1$1];var div_2=child(div_1);var div_3=child(div_2);var node_1=child(div_3);{var consequent_1=$$anchor3=>{var fragment_1=comment();var node_2=first_child(fragment_1);{var consequent=$$anchor4=>{var img=root_3$4();template_effect(()=>{set_attribute(img,"src",chain().icon);set_attribute(img,"alt",chain().name)});append($$anchor4,img)};var alternate=$$anchor4=>{var span=root_4$5();var text2=child(span,true);reset(span);template_effect(()=>set_text(text2,chain().icon));append($$anchor4,span)};if_block(node_2,$$render=>{if(chain().icon.startsWith("/"))$$render(consequent);else $$render(alternate,false)})}append($$anchor3,fragment_1)};if_block(node_1,$$render=>{var _a;if((_a=chain())==null?void 0:_a.icon)$$render(consequent_1)})}var span_1=sibling(node_1,2);var text_1=child(span_1,true);reset(span_1);reset(div_3);var button=sibling(div_3,2);button.__click=closeModal;reset(div_2);var node_3=sibling(div_2,2);{var consequent_2=$$anchor3=>{var div_4=root_5$3();var select=sibling(child(div_4),2);each(select,21,tokens2,index,($$anchor4,token)=>{var option=root_6$4();var option_value={};var text_2=child(option);reset(option);template_effect(()=>{if(option_value!==(option_value=get$1(token))){option.value=(option.__value=get$1(token))??""}set_text(text_2,`${get$1(token).symbol??""} (${get$1(token).qty??""})`)});append($$anchor4,option)});reset(select);reset(div_4);bind_select_value(select,()=>get$1(selectedToken),$$value=>set(selectedToken,$$value));append($$anchor3,div_4)};var alternate_1=$$anchor3=>{var div_5=root_7$4();var select_1=sibling(child(div_5),2);each(select_1,21,tokens2,index,($$anchor4,token)=>{var option_1=root_8$3();var option_1_value={};var text_3=child(option_1);reset(option_1);template_effect(()=>{if(option_1_value!==(option_1_value=get$1(token))){option_1.value=(option_1.__value=get$1(token))??""}set_text(text_3,`${get$1(token).symbol??""} (Balance: ${get$1(token).qty??""})`)});append($$anchor4,option_1)});reset(select_1);reset(div_5);bind_select_value(select_1,()=>get$1(selectedToken),$$value=>set(selectedToken,$$value));append($$anchor3,div_5)};if_block(node_3,$$render=>{if(strict_equals(mode(),"swap"))$$render(consequent_2);else $$render(alternate_1,false)})}var div_6=sibling(node_3,2);var label=child(div_6);var text_4=child(label,true);reset(label);var input=sibling(label,2);remove_input_defaults(input);reset(div_6);var div_7=sibling(div_6,2);var div_8=sibling(child(div_7),2);var input_1=child(div_8);remove_input_defaults(input_1);var button_1=sibling(input_1,2);button_1.__click=[on_click_1$3,amount,selectedToken];reset(div_8);reset(div_7);var node_4=sibling(div_7,2);{var consequent_4=$$anchor3=>{var div_9=root_9$3();var node_5=child(div_9);{var consequent_3=$$anchor4=>{var span_2=root_10$2();append($$anchor4,span_2)};var alternate_2=$$anchor4=>{var text_5=text();template_effect(()=>set_text(text_5,`Estimated gas: ${get$1(gasEstimate)??""}`));append($$anchor4,text_5)};if_block(node_5,$$render=>{if(get$1(estimatingGas))$$render(consequent_3);else $$render(alternate_2,false)})}reset(div_9);append($$anchor3,div_9)};if_block(node_4,$$render=>{if(strict_equals(mode(),"send")&&get$1(gasEstimate))$$render(consequent_4)})}var node_6=sibling(node_4,2);{var consequent_5=$$anchor3=>{var div_10=root_12$3();var text_6=child(div_10,true);reset(div_10);template_effect(()=>set_text(text_6,get$1(validationError)));append($$anchor3,div_10)};if_block(node_6,$$render=>{if(get$1(validationError))$$render(consequent_5)})}var node_7=sibling(node_6,2);{var consequent_6=$$anchor3=>{var div_11=root_13$2();var text_7=child(div_11,true);reset(div_11);template_effect(()=>set_text(text_7,get$1(error).message));append($$anchor3,div_11)};if_block(node_7,$$render=>{if(get$1(error).hasError)$$render(consequent_6)})}var button_2=sibling(node_7,2);button_2.__click=[handleSubmit,validationError,mode,submitSend,submitSwap];var node_8=child(button_2);{var consequent_7=$$anchor3=>{var div_12=root_14$2();var text_8=sibling(child(div_12));reset(div_12);template_effect(()=>set_text(text_8,` ${strict_equals(mode(),"send")?"Sending...":"Swapping..."}`));append($$anchor3,div_12)};var alternate_3=($$anchor3,$$elseif)=>{{var consequent_8=$$anchor4=>{var text_9=text("Upgrade to Pro");append($$anchor4,text_9)};var alternate_4=$$anchor4=>{var text_10=text();template_effect(()=>set_text(text_10,strict_equals(mode(),"send")?"Send":"Swap"));append($$anchor4,text_10)};if_block($$anchor3,$$render=>{if(!canUseFeature(strict_equals(mode(),"send")?"send_tokens":"swap_tokens"))$$render(consequent_8);else $$render(alternate_4,false)},$$elseif)}};if_block(node_8,$$render=>{if(get$1(sending))$$render(consequent_7);else $$render(alternate_3,false)})}reset(button_2);reset(div_1);reset(div);template_effect(($0,$1,$2,$3,$4)=>{set_text(text_1,strict_equals(mode(),"send")?"Send Tokens":"Swap Tokens");set_text(text_4,strict_equals(mode(),"send")?"Recipient Address":"To Token");set_class(input,1,`w-full p-2 bg-zinc-100 dark:bg-zinc-800 rounded text-zinc-900 dark:text-white border ${$0??""}`);set_attribute(input,"aria-invalid",$1);set_attribute(input,"aria-describedby",get$1(validationError)?"validation-error":null);set_class(input_1,1,`w-full p-2 bg-zinc-100 dark:bg-zinc-800 rounded text-zinc-900 dark:text-white border ${$2??""}`);set_attribute(input_1,"aria-invalid",$3);set_attribute(input_1,"aria-describedby",get$1(validationError)?"validation-error":null);set_class(button_2,1,`w-full p-3 rounded-xl font-semibold shadow transition-all disabled:opacity-60 disabled:cursor-not-allowed ${strict_equals(mode(),"send")?"bg-green-600 hover:bg-green-700":"bg-purple-600 hover:bg-purple-700"} text-white`);button_2.disabled=$4},[()=>!get$1(recipient)||validateAddress(get$1(recipient))?"border-transparent":"border-red-400",()=>get$1(recipient)&&!validateAddress(get$1(recipient)),()=>!get$1(amount)||validateAmount(get$1(amount))?"border-transparent":"border-red-400",()=>get$1(amount)&&!validateAmount(get$1(amount)),()=>!get$1(recipient)||!get$1(amount)||get$1(sending)||!canUseFeature(strict_equals(mode(),"send")?"send_tokens":"swap_tokens")]);bind_value(input,()=>get$1(recipient),$$value=>set(recipient,$$value));bind_value(input_1,()=>get$1(amount),$$value=>set(amount,$$value));append($$anchor2,div)};if_block(node,$$render=>{if(show())$$render(consequent_9)})}append($$anchor,fragment);var $$pop=pop({...legacy_api()});$$cleanup();return $$pop}delegate(["click","keydown"]);QR[FILENAME]="src/routes/preview2/lib/components/v1/QR.svelte";var root$4=add_locations(from_html(`<div class="flex mx-auto justify-center w-full h-full svelte-x2f3mp"></div>`),QR[FILENAME],[[21,0]]);function QR($$anchor,$$props){check_target(new.target);push($$props,true,QR);const width=220;const height=220;let node=tag(state(void 0),"node");onMount(()=>{const options={text:$$props.qrText,width:220,height:220,quietZone:20,logo:"/images/logoBullFav48x48.png",logoBackgroundTransparent:true};new QRCode(get$1(node),options)});var div=root$4();bind_this(div,$$value=>set(node,$$value),()=>get$1(node));append($$anchor,div);return pop({get width(){return width},get height(){return height},...legacy_api()})}Copy[FILENAME]="src/routes/preview2/lib/components/v1/Copy.svelte";async function copyToClipboard(_,$$props,handleMultiCopy,handleSingleCopy,showFeedback,isCopied,timerManager,feedbackDuration){try{if(Array.isArray($$props.target)){await handleMultiCopy($$props.target)}else{await handleSingleCopy($$props.target)}if(showFeedback()){set(isCopied,true);timerManager.addTimeout("copy-feedback",()=>{set(isCopied,false)},feedbackDuration());timerManager.startTimeout("copy-feedback")}}catch(err){set(isCopied,false)}}var root_1$5=add_locations(from_html(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-500" aria-hidden="true"><path d="M20 6L9 17l-5-5"></path></svg> <span class="sr-only">Copied!</span>`,1),Copy[FILENAME],[[124,2,[[137,3]]],[139,2]]);var root_2$6=add_locations(from_html(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500 hover:text-blue-500 transition-colors duration-200" aria-hidden="true"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> <span class="sr-only">Copy to clipboard</span>`,1),Copy[FILENAME],[[141,2,[[154,3],[155,3]]],[157,2]]);var root$3=add_locations(from_html(`<button type="button" title="Copy to clipboard"><!></button>`),Copy[FILENAME],[[104,0]]);function Copy($$anchor,$$props){check_target(new.target);push($$props,true,Copy);const size=prop($$props,"size",3,20),className=prop($$props,"className",3,""),showFeedback=prop($$props,"showFeedback",3,true),feedbackDuration=prop($$props,"feedbackDuration",3,2e3),defaultRedactText=prop($$props,"defaultRedactText",3,"<redacted>"),onClick=prop($$props,"onClick",19,()=>void 0);let isCopied=tag(state(false),"isCopied");let timeoutIds=new Map;const timerManager=UnifiedTimerManager.getInstance();function getValue(copyTarget){if(copyTarget.id){const element=document.getElementById(copyTarget.id);if(element instanceof HTMLInputElement||element instanceof HTMLTextAreaElement){return element.value}else if(element){return element.textContent||""}log.warn(`Element with id '${copyTarget.id}' not found`);return""}const value=copyTarget.value;if(strict_equals(value,null)||strict_equals(value,void 0)){return""}return value.toString()}async function handleSingleCopy(copyTarget){const value=getValue(copyTarget);await navigator.clipboard.writeText(value);if(onClick()){onClick()(value)}if(copyTarget.timeout){timeoutClipboard(copyTarget.timeout,copyTarget.redactText||defaultRedactText())}}async function handleMultiCopy(copyTargets){const values=copyTargets.map(target2=>getValue(target2));const combinedValue=values.join("\n");await navigator.clipboard.writeText(combinedValue);if(onClick()){onClick()(combinedValue)}copyTargets.forEach((target2,index2)=>{if(target2.timeout){const timerId=`copy-timeout-${target2.id||index2}`;timerManager.addTimeout(timerId,async()=>{const currentValues=[...values];const redactText=target2.redactText||defaultRedactText();currentValues[index2]=redactText;await navigator.clipboard.writeText(currentValues.join("\n"));timeoutIds.delete(target2.id||values[index2])},target2.timeout);timerManager.startTimeout(timerId);timeoutIds.set(target2.id||values[index2],timerId)}})}user_effect(()=>()=>{timeoutIds.forEach(timerId=>{timerManager.stopTimeout(timerId);timerManager.removeTimeout(timerId)});timeoutIds.clear()});var button=root$3();button.__click=[copyToClipboard,$$props,handleMultiCopy,handleSingleCopy,showFeedback,isCopied,timerManager,feedbackDuration];var node=child(button);{var consequent=$$anchor2=>{var fragment=root_1$5();var svg=first_child(fragment);next(2);template_effect(()=>{set_attribute(svg,"width",size());set_attribute(svg,"height",size())});append($$anchor2,fragment)};var alternate=$$anchor2=>{var fragment_1=root_2$6();var svg_1=first_child(fragment_1);next(2);template_effect(()=>{set_attribute(svg_1,"width",size());set_attribute(svg_1,"height",size())});append($$anchor2,fragment_1)};if_block(node,$$render=>{if(get$1(isCopied))$$render(consequent);else $$render(alternate,false)})}reset(button);template_effect(()=>set_class(button,1,`\n    inline-flex\n    items-center\n    justify-center\n    transition-all\n    duration-200\n    ease-in-out\n    rounded-md\n    focus:outline-none\n    focus:ring-2\n    focus:ring-offset-2\n    focus:ring-blue-500\n    ${className()??""}\n  `));append($$anchor,button);return pop({...legacy_api()})}delegate(["click"]);Receive[FILENAME]="src/routes/preview2/lib/components/Receive.svelte";var root_2$5=add_locations(from_html(`<div class="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-6 mb-6 text-center"><div class="mb-6"><!></div> <h3 class="text-lg font-semibold text-gray-800 mb-2">Your Wallet Address</h3> <p class="text-sm text-gray-600 mb-4">Share this address to receive payments</p></div> <div class="bg-white rounded-lg border border-gray-200 shadow-sm"><div class="flex items-center justify-between p-4"><div class="flex-1 min-w-0 mr-3"><div class="text-xs font-medium text-gray-500 uppercase tracking-wide mb-1">Ethereum Address</div> <p class="text-sm font-mono text-gray-900 truncate" id="eth-address"> </p></div> <div class="flex-shrink-0"><!></div></div></div> <div class="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200"><div class="flex items-center"><div class="flex-shrink-0"><svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div> <div class="ml-3"><p class="text-sm text-blue-800"><span class="font-medium">Scan the QR code</span> with your mobile wallet or <span class="font-medium">copy the address</span> to receive payments</p></div></div></div>`,1),Receive[FILENAME],[[20,3,[[21,4],[24,4],[25,4]]],[29,3,[[30,4,[[31,5,[[32,6],[35,6]]],[39,5]]]]],[46,3,[[47,4,[[48,5,[[49,6,[[50,7]]]]],[53,5,[[54,6,[[55,7],[56,7]]]]]]]]]]);var root_3$3=add_locations(from_html(`<div class="text-center py-12"><div class="w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center"><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div> <h3 class="text-lg font-semibold text-gray-700 mb-2">No Portfolio Accounts</h3> <p class="text-gray-500">Create at least one Portfolio account to receive payments</p></div>`),Receive[FILENAME],[[63,3,[[64,4,[[65,5,[[66,6]]]]],[69,4],[70,4]]]]);var root_1$4=add_locations(from_html(`<div class="p-6"><!></div>`),Receive[FILENAME],[[17,1]]);function Receive($$anchor,$$props){check_target(new.target);push($$props,true,Receive);var $$ownership_validator=create_ownership_validator($$props);const[$$stores,$$cleanup]=setup_stores();const $yakklCurrentlySelectedStore=()=>(validate_store(yakklCurrentlySelectedStore,"yakklCurrentlySelectedStore"),store_get(yakklCurrentlySelectedStore,"$yakklCurrentlySelectedStore",$$stores));let show=prop($$props,"show",15,false),address=prop($$props,"address",15,""),title=prop($$props,"title",3,"Receive");onMount(()=>{if($yakklCurrentlySelectedStore()&&strict_equals($yakklCurrentlySelectedStore().shortcuts.address,YAKKL_ZERO_ADDRESS,false)){address($yakklCurrentlySelectedStore().shortcuts.address)}});{$$ownership_validator.binding("show",Modal,show);Modal($$anchor,{get title(){return title()},get show(){return show()},set show($$value){show($$value)},children:wrap_snippet(Receive,($$anchor2,$$slotProps)=>{var div=root_1$4();var node=child(div);{var consequent=$$anchor3=>{var fragment_1=root_2$5();var div_1=first_child(fragment_1);var div_2=child(div_1);var node_1=child(div_2);QR(node_1,{get qrText(){return address()}});reset(div_2);next(4);reset(div_1);var div_3=sibling(div_1,2);var div_4=child(div_3);var div_5=child(div_4);var p=sibling(child(div_5),2);var text2=child(p,true);reset(p);reset(div_5);var div_6=sibling(div_5,2);var node_2=child(div_6);const expression=user_derived(()=>({value:address()}));Copy(node_2,{get target(){return get$1(expression)},className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"});reset(div_6);reset(div_4);reset(div_3);next(2);template_effect(()=>{set_attribute(p,"title",address());set_text(text2,address())});append($$anchor3,fragment_1)};var alternate=$$anchor3=>{var div_7=root_3$3();append($$anchor3,div_7)};if_block(node,$$render=>{if($yakklCurrentlySelectedStore()&&strict_equals($yakklCurrentlySelectedStore().shortcuts.address,YAKKL_ZERO_ADDRESS,false))$$render(consequent);else $$render(alternate,false)})}reset(div);append($$anchor2,div)}),$$slots:{default:true}})}var $$pop=pop({...legacy_api()});$$cleanup();return $$pop}const _BuyService=class _BuyService extends BaseService{constructor(){super()}static getInstance(){if(!_BuyService.instance){_BuyService.instance=new _BuyService}return _BuyService.instance}async getBuyQuote(amount,currency="USD",cryptoCurrency="ETH"){try{const account=get(currentAccount);if(!account){return{success:false,error:{hasError:true,message:"No account selected"}}}const response=await this.sendMessage({method:"yakkl_getBuyQuote",params:[{amount:amount,currency:currency,cryptoCurrency:cryptoCurrency,userAddress:account.address}]});if(response.success&&response.data){const quote={amount:amount,currency:currency,cryptoAmount:response.data.cryptoAmount,cryptoCurrency:cryptoCurrency,rate:response.data.rate,fees:response.data.fees,total:response.data.total,estimatedTime:response.data.estimatedTime,provider:response.data.provider||"Stripe",validUntil:Date.now()+10*60*1e3};return{success:true,data:quote}}return this.getMockBuyQuote(amount,currency,cryptoCurrency)}catch(error){return{success:false,error:this.handleError(error)}}}async executeBuyOrder(quote,paymentMethodId){try{const account=get(currentAccount);if(!account){return{success:false,error:{hasError:true,message:"No account selected"}}}if(Date.now()>quote.validUntil){return{success:false,error:{hasError:true,message:"Quote expired, please get a new quote"}}}const response=await this.sendMessage({method:"yakkl_executeBuyOrder",params:[{quote:quote,paymentMethodId:paymentMethodId,userAddress:account.address}]});if(response.success&&response.data){const order={id:response.data.orderId,amount:quote.amount,currency:quote.currency,cryptoAmount:quote.cryptoAmount,cryptoCurrency:quote.cryptoCurrency,status:"pending",paymentMethod:paymentMethodId,provider:quote.provider,createdAt:Date.now()};return{success:true,data:order}}return response}catch(error){return{success:false,error:this.handleError(error)}}}async getPaymentMethods(){try{const account=get(currentAccount);if(!account){return{success:false,error:{hasError:true,message:"No account selected"}}}const response=await this.sendMessage({method:"yakkl_getPaymentMethods",params:[account.address]});if(response.success&&response.data){return response}return{success:true,data:[]}}catch(error){return{success:false,error:this.handleError(error)}}}async addPaymentMethod(type,details){try{const account=get(currentAccount);if(!account){return{success:false,error:{hasError:true,message:"No account selected"}}}const response=await this.sendMessage({method:"yakkl_addPaymentMethod",params:[{type:type,details:details,userAddress:account.address}]});return response}catch(error){return{success:false,error:this.handleError(error)}}}async getBuyLimits(){try{const account=get(currentAccount);if(!account){return{success:false,error:{hasError:true,message:"No account selected"}}}const response=await this.sendMessage({method:"yakkl_getBuyLimits",params:[account.address]});if(response.success&&response.data){return response}return{success:true,data:{min:10,max:1e3,daily:1e3,monthly:1e4,currency:"USD"}}}catch(error){return{success:false,error:this.handleError(error)}}}async getBuyHistory(limit=10){try{const account=get(currentAccount);if(!account){return{success:false,error:{hasError:true,message:"No account selected"}}}const response=await this.sendMessage({method:"yakkl_getBuyHistory",params:[account.address,limit]});if(response.success&&response.data){return response}return{success:true,data:[]}}catch(error){return{success:false,error:this.handleError(error)}}}async getSupportedCurrencies(){try{const response=await this.sendMessage({method:"yakkl_getSupportedCurrencies"});if(response.success&&response.data){return response}return{success:true,data:["USD","EUR","GBP","CAD","AUD"]}}catch(error){return{success:false,error:this.handleError(error)}}}async getSupportedCryptoCurrencies(){try{const response=await this.sendMessage({method:"yakkl_getSupportedCryptoCurrencies"});if(response.success&&response.data){return response}return{success:true,data:["ETH","BTC","USDC","USDT","DAI"]}}catch(error){return{success:false,error:this.handleError(error)}}}async getMockBuyQuote(amount,currency,cryptoCurrency){const rates={ETH:2500,BTC:45e3,USDC:1,USDT:1,DAI:1};const rate=rates[cryptoCurrency]||2500;const networkFee=5;const serviceFee=amount*.029;const totalFees=networkFee+serviceFee;const total=amount+totalFees;const cryptoAmount=amount/rate;const quote={amount:amount,currency:currency,cryptoAmount:cryptoAmount,cryptoCurrency:cryptoCurrency,rate:rate,fees:{network:networkFee,service:serviceFee,total:totalFees},total:total,estimatedTime:"5-10 minutes",provider:"Mock Provider",validUntil:Date.now()+10*60*1e3};return{success:true,data:quote}}};__publicField(_BuyService,"instance");let BuyService=_BuyService;BuyModal[FILENAME]="src/routes/preview2/lib/components/BuyModal.svelte";async function getQuote(_,validateAmount,loading,error,buyService,amount,currency,cryptoCurrency,quote,step){var _a;if(!validateAmount())return;set(loading,true);set(error,"");try{const response=await buyService.getBuyQuote(parseFloat(get$1(amount)),get$1(currency),get$1(cryptoCurrency));if(response.success&&response.data){set(quote,response.data,true);set(step,"payment")}else{set(error,((_a=response.error)==null?void 0:_a.message)||"Failed to get quote",true)}}catch(err){set(error,"Failed to get quote")}finally{set(loading,false)}}async function executePurchase(__1,quote,selectedPaymentMethod,loading,error,buyService,order,step){var _a;if(!get$1(quote)||!get$1(selectedPaymentMethod))return;set(loading,true);set(error,"");try{const response=await buyService.executeBuyOrder(get$1(quote),get$1(selectedPaymentMethod).id);if(response.success&&response.data){set(order,response.data,true);set(step,"success");uiStore.showSuccess("Purchase Initiated",`Your order for ${get$1(quote).cryptoAmount} ${get$1(quote).cryptoCurrency} has been placed.`)}else{set(error,((_a=response.error)==null?void 0:_a.message)||"Purchase failed",true)}}catch(err){set(error,"Purchase failed")}finally{set(loading,false)}}var on_keydown=(e,closeModal)=>strict_equals(e.key,"Escape")&&closeModal();var on_click$2=e=>e.stopPropagation();var on_keydown_1=e=>e.stopPropagation();var root_2$4=add_locations(from_html(`<div class="text-center py-8"><div class="text-4xl mb-4">🔒</div> <h3 class="text-lg font-semibold mb-2">Pro Feature</h3> <p class="text-gray-600 dark:text-gray-400 mb-4">Buying crypto with fiat requires a Pro subscription</p> <button class="yakkl-btn-primary">Upgrade to Pro</button></div>`),BuyModal[FILENAME],[[166,8,[[167,10],[168,10],[169,10],[172,10]]]]);var root_4$4=add_locations(from_html(`<div class="text-center py-8 text-gray-500 dark:text-gray-400"><p>No account selected</p></div>`),BuyModal[FILENAME],[[178,8,[[179,10]]]]);var root_7$3=add_locations(from_html(`<option> </option>`),BuyModal[FILENAME],[[204,20]]);var root_8$2=add_locations(from_html(`<option> </option>`),BuyModal[FILENAME],[[222,18]]);var root_9$2=add_locations(from_html(`<div class="flex items-center justify-center gap-2"><div class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div> Getting Quote...</div>`),BuyModal[FILENAME],[[234,16,[[235,18]]]]);var root_6$3=add_locations(from_html(`<div class="space-y-4"><div><label for="buy-amount-input" class="block text-sm font-medium mb-2">Amount to Spend</label> <div class="flex gap-2"><input id="buy-amount-input" type="number" placeholder="100" aria-describedby="amount-limits"/> <select class="px-3 py-3 bg-zinc-100 dark:bg-zinc-800 rounded-lg text-zinc-900 dark:text-white" aria-label="Select currency"></select></div> <div id="amount-limits" class="text-xs text-gray-500 mt-1"> </div></div> <div><label for="crypto-select" class="block text-sm font-medium mb-2">Cryptocurrency</label> <select id="crypto-select" class="w-full p-3 bg-zinc-100 dark:bg-zinc-800 rounded-lg text-zinc-900 dark:text-white"></select></div> <button class="w-full p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-60"><!></button></div>`),BuyModal[FILENAME],[[184,10,[[186,12,[[187,14],[188,14,[[189,16],[198,16]]],[208,14]]],[214,12,[[215,14],[216,14]]],[228,12]]]]);var root_12$2=add_locations(from_html(`<div class="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-4"><h4 class="font-semibold mb-2">Quote</h4> <div class="space-y-1 text-sm"><div class="flex justify-between"><span>Amount:</span> <span> </span></div> <div class="flex justify-between"><span>You'll receive:</span> <span class="font-semibold"> </span></div> <div class="flex justify-between"><span>Rate:</span> <span> </span></div> <div class="flex justify-between"><span>Fees:</span> <span> </span></div> <hr class="my-2"/> <div class="flex justify-between font-semibold"><span>Total:</span> <span> </span></div></div></div>`),BuyModal[FILENAME],[[250,14,[[251,16],[252,16,[[253,18,[[254,20],[255,20]]],[257,18,[[258,20],[259,20]]],[261,18,[[262,20],[263,20]]],[265,18,[[266,20],[267,20]]],[269,18],[270,18,[[271,20],[272,20]]]]]]]]);var root_13$1=add_locations(from_html(`<div class="text-center py-4 text-gray-500"><p class="mb-2">No payment methods found</p> <button class="text-blue-500 hover:text-blue-600 text-sm">Add Payment Method</button></div>`),BuyModal[FILENAME],[[282,16,[[283,18],[284,18]]]]);var on_click_1$2=(__2,selectedPaymentMethod,method)=>set(selectedPaymentMethod,get$1(method),true);var root_16=add_locations(from_html(`<div class="text-sm text-gray-500"> </div>`),BuyModal[FILENAME],[[301,28]]);var root_15$2=add_locations(from_html(`<button><div class="flex items-center justify-between"><div><div class="font-medium"> </div> <!></div> <div class="text-sm text-gray-500"> </div></div></button>`),BuyModal[FILENAME],[[291,20,[[297,22,[[298,24,[[299,26]]],[304,24]]]]]]);var root_14$1=add_locations(from_html(`<div class="space-y-2"></div>`),BuyModal[FILENAME],[[289,16]]);var on_click_2$1=(__3,goToStep)=>goToStep("amount");var root_11=add_locations(from_html(`<div class="space-y-4"><!> <div><label class="block text-sm font-medium mb-2">Payment Method</label> <!></div> <div class="flex gap-3"><button class="flex-1 p-3 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">Back</button> <button class="flex-1 p-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors disabled:opacity-60"><!></button></div></div>`),BuyModal[FILENAME],[[247,10,[[279,12,[[280,14]]],[315,12,[[316,14],[322,14]]]]]]);var root_20=add_locations(from_html(`<p class="text-gray-600 dark:text-gray-400 mb-4"> </p> <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mb-4"><div class="text-sm space-y-1"><div><strong>Order ID:</strong> </div> <div><strong>Status:</strong> </div> <div><strong>Estimated Time:</strong> 5-10 minutes</div></div></div>`,1),BuyModal[FILENAME],[[343,14],[346,14,[[347,16,[[348,18,[[348,23]]],[349,18,[[349,23]]],[350,18,[[350,23]]]]]]]]);var root_19=add_locations(from_html(`<div class="text-center py-8"><div class="text-6xl mb-4">✅</div> <h3 class="text-xl font-semibold mb-2">Purchase Successful!</h3> <!> <button class="w-full p-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold">Done</button></div>`),BuyModal[FILENAME],[[339,10,[[340,12],[341,12],[354,12]]]]);var root_21=add_locations(from_html(`<div class="text-sm text-red-500 bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"> </div>`),BuyModal[FILENAME],[[365,10]]);var root_22=add_locations(from_html(`<div class="text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg"><strong>Secure Purchase:</strong><br/> • Powered by Stripe for secure payment processing<br/> • Crypto delivered directly to your wallet<br/> • Industry-standard encryption and security</div>`),BuyModal[FILENAME],[[372,10,[[373,12],[373,45],[374,61],[375,54]]]]);var root_5$2=add_locations(from_html(`<!> <!> <!> <!> <!>`,1),BuyModal[FILENAME],[]);var root_1$3=add_locations(from_html(`<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm animate-in fade-in" role="dialog" aria-modal="true" aria-label="Buy crypto modal"><div class="relative bg-white dark:bg-zinc-900 rounded-2xl shadow-xl p-6 min-w-[380px] w-full max-w-md flex flex-col gap-4 animate-in slide-in-from-bottom-10 max-h-[90vh] overflow-y-auto"><div class="flex items-center justify-between mb-2"><div class="flex items-center gap-2"><span class="text-xl">💳</span> <span class="font-bold text-lg">Buy Crypto</span></div> <button class="text-2xl text-gray-400 hover:text-red-500 transition-colors" aria-label="Close modal">×</button></div> <!></div></div>`),BuyModal[FILENAME],[[139,2,[[145,4,[[150,6,[[151,8,[[152,10],[153,10]]],[155,8]]]]]]]]);function BuyModal($$anchor,$$props){check_target(new.target);push($$props,true,BuyModal);const[$$stores,$$cleanup]=setup_stores();const $currentAccount=()=>(validate_store(currentAccount,"currentAccount"),store_get(currentAccount,"$currentAccount",$$stores));let show=prop($$props,"show",11,false),onClose=prop($$props,"onClose",3,null);const buyService=BuyService.getInstance();let step=tag(state("amount"),"step");let amount=tag(state("100"),"amount");let currency=tag(state("USD"),"currency");let cryptoCurrency=tag(state("ETH"),"cryptoCurrency");let selectedPaymentMethod=tag(state(null),"selectedPaymentMethod");let quote=tag(state(null),"quote");let order=tag(state(null),"order");let loading=tag(state(false),"loading");let error=tag(state(""),"error");let supportedCurrencies=tag(state(proxy(["USD","EUR","GBP","CAD"])),"supportedCurrencies");let supportedCryptoCurrencies=tag(state(proxy(["ETH","BTC","USDC","USDT"])),"supportedCryptoCurrencies");let paymentMethods=tag(state(proxy([])),"paymentMethods");let limits=tag(state(proxy({min:10,max:1e3,daily:1e3,monthly:1e4,currency:"USD"})),"limits");let account=tag(user_derived($currentAccount),"account");let canBuy=tag(user_derived(()=>canUseFeature("buy_crypto_card")),"canBuy");user_effect(()=>{if(show()&&get$1(canBuy)){loadInitialData()}});async function loadInitialData(){set(loading,true);try{const[currenciesRes,cryptosRes,paymentMethodsRes,limitsRes]=await Promise.all([buyService.getSupportedCurrencies(),buyService.getSupportedCryptoCurrencies(),buyService.getPaymentMethods(),buyService.getBuyLimits()]);if(currenciesRes.success&&currenciesRes.data){set(supportedCurrencies,currenciesRes.data,true)}if(cryptosRes.success&&cryptosRes.data){set(supportedCryptoCurrencies,cryptosRes.data,true)}if(paymentMethodsRes.success&&paymentMethodsRes.data){set(paymentMethods,paymentMethodsRes.data,true)}if(limitsRes.success&&limitsRes.data){set(limits,limitsRes.data,true)}}catch(err){set(error,"Failed to load buy options")}finally{set(loading,false)}}function validateAmount(){const amt=parseFloat(get$1(amount));if(isNaN(amt)||amt<=0){set(error,"Please enter a valid amount");return false}if(amt<get$1(limits).min){set(error,`Minimum amount is ${get$1(limits).min} ${get$1(limits).currency}`);return false}if(amt>get$1(limits).max){set(error,`Maximum amount is ${get$1(limits).max} ${get$1(limits).currency}`);return false}return true}function closeModal(){set(step,"amount");set(amount,"100");set(selectedPaymentMethod,null);set(quote,null);set(order,null);set(error,"");if(onClose())onClose()()}function goToStep(newStep){set(step,newStep,true);set(error,"")}function formatCurrency(value,curr="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:curr}).format(value)}var fragment=comment();var node=first_child(fragment);{var consequent_13=$$anchor2=>{var div=root_1$3();div.__click=closeModal;div.__keydown=[on_keydown,closeModal];var div_1=child(div);div_1.__click=[on_click$2];div_1.__keydown=[on_keydown_1];var div_2=child(div_1);var button=sibling(child(div_2),2);button.__click=closeModal;reset(div_2);var node_1=sibling(div_2,2);{var consequent=$$anchor3=>{var div_3=root_2$4();append($$anchor3,div_3)};var alternate=($$anchor3,$$elseif)=>{{var consequent_1=$$anchor4=>{var div_4=root_4$4();append($$anchor4,div_4)};var alternate_1=$$anchor4=>{var fragment_1=root_5$2();var node_2=first_child(fragment_1);{var consequent_3=$$anchor5=>{var div_5=root_6$3();var div_6=child(div_5);var div_7=sibling(child(div_6),2);var input=child(div_7);remove_input_defaults(input);var select=sibling(input,2);each(select,21,()=>get$1(supportedCurrencies),index,($$anchor6,curr)=>{var option=root_7$3();var option_value={};var text2=child(option,true);reset(option);template_effect(()=>{if(option_value!==(option_value=get$1(curr))){option.value=(option.__value=get$1(curr))??""}set_text(text2,get$1(curr))});append($$anchor6,option)});reset(select);reset(div_7);var div_8=sibling(div_7,2);var text_1=child(div_8);reset(div_8);reset(div_6);var div_9=sibling(div_6,2);var select_1=sibling(child(div_9),2);each(select_1,21,()=>get$1(supportedCryptoCurrencies),index,($$anchor6,crypto)=>{var option_1=root_8$2();var option_1_value={};var text_2=child(option_1,true);reset(option_1);template_effect(()=>{if(option_1_value!==(option_1_value=get$1(crypto))){option_1.value=(option_1.__value=get$1(crypto))??""}set_text(text_2,get$1(crypto))});append($$anchor6,option_1)});reset(select_1);reset(div_9);var button_1=sibling(div_9,2);button_1.__click=[getQuote,validateAmount,loading,error,buyService,amount,currency,cryptoCurrency,quote,step];var node_3=child(button_1);{var consequent_2=$$anchor6=>{var div_10=root_9$2();append($$anchor6,div_10)};var alternate_2=$$anchor6=>{var text_3=text("Get Quote");append($$anchor6,text_3)};if_block(node_3,$$render=>{if(get$1(loading))$$render(consequent_2);else $$render(alternate_2,false)})}reset(button_1);reset(div_5);template_effect(($0,$1,$2,$3,$4)=>{set_class(input,1,`flex-1 p-3 bg-zinc-100 dark:bg-zinc-800 rounded-lg text-zinc-900 dark:text-white border ${$0??""}`);set_attribute(input,"aria-invalid",$1);set_text(text_1,`Limits: ${$2??""} - ${$3??""}`);button_1.disabled=$4},[()=>get$1(error)&&!validateAmount()?"border-red-400":"border-transparent",()=>get$1(error)&&!validateAmount(),()=>formatCurrency(get$1(limits).min),()=>formatCurrency(get$1(limits).max),()=>get$1(loading)||!validateAmount()]);bind_value(input,()=>get$1(amount),$$value=>set(amount,$$value));bind_select_value(select,()=>get$1(currency),$$value=>set(currency,$$value));bind_select_value(select_1,()=>get$1(cryptoCurrency),$$value=>set(cryptoCurrency,$$value));append($$anchor5,div_5)};if_block(node_2,$$render=>{if(strict_equals(get$1(step),"amount"))$$render(consequent_3)})}var node_4=sibling(node_2,2);{var consequent_8=$$anchor5=>{var div_11=root_11();var node_5=child(div_11);{var consequent_4=$$anchor6=>{var div_12=root_12$2();var div_13=sibling(child(div_12),2);var div_14=child(div_13);var span=sibling(child(div_14),2);var text_4=child(span,true);reset(span);reset(div_14);var div_15=sibling(div_14,2);var span_1=sibling(child(div_15),2);var text_5=child(span_1);reset(span_1);reset(div_15);var div_16=sibling(div_15,2);var span_2=sibling(child(div_16),2);var text_6=child(span_2);reset(span_2);reset(div_16);var div_17=sibling(div_16,2);var span_3=sibling(child(div_17),2);var text_7=child(span_3,true);reset(span_3);reset(div_17);var div_18=sibling(div_17,4);var span_4=sibling(child(div_18),2);var text_8=child(span_4,true);reset(span_4);reset(div_18);reset(div_13);reset(div_12);template_effect(($0,$1,$2,$3,$4)=>{set_text(text_4,$0);set_text(text_5,`${$1??""} ${get$1(quote).cryptoCurrency??""}`);set_text(text_6,`${$2??""} per ${get$1(quote).cryptoCurrency??""}`);set_text(text_7,$3);set_text(text_8,$4)},[()=>formatCurrency(get$1(quote).amount,get$1(quote).currency),()=>get$1(quote).cryptoAmount.toFixed(6),()=>formatCurrency(get$1(quote).rate),()=>formatCurrency(get$1(quote).fees.total),()=>formatCurrency(get$1(quote).total)]);append($$anchor6,div_12)};if_block(node_5,$$render=>{if(get$1(quote))$$render(consequent_4)})}var div_19=sibling(node_5,2);var node_6=sibling(child(div_19),2);{var consequent_5=$$anchor6=>{var div_20=root_13$1();append($$anchor6,div_20)};var alternate_3=$$anchor6=>{var div_21=root_14$1();each(div_21,21,()=>get$1(paymentMethods),index,($$anchor7,method)=>{var button_2=root_15$2();button_2.__click=[on_click_1$2,selectedPaymentMethod,method];var div_22=child(button_2);var div_23=child(div_22);var div_24=child(div_23);var text_9=child(div_24,true);reset(div_24);var node_7=sibling(div_24,2);{var consequent_6=$$anchor8=>{var div_25=root_16();var text_10=child(div_25);reset(div_25);template_effect(()=>set_text(text_10,`•••• ${get$1(method).last4??""}`));append($$anchor8,div_25)};if_block(node_7,$$render=>{if(get$1(method).last4)$$render(consequent_6)})}reset(div_23);var div_26=sibling(div_23,2);var text_11=child(div_26,true);reset(div_26);reset(div_22);reset(button_2);template_effect($0=>{var _a,_b;set_class(button_2,1,`w-full p-3 border rounded-lg text-left hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${strict_equals((_a=get$1(selectedPaymentMethod))==null?void 0:_a.id,get$1(method).id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700"}`);set_attribute(button_2,"aria-pressed",strict_equals((_b=get$1(selectedPaymentMethod))==null?void 0:_b.id,get$1(method).id));set_attribute(button_2,"aria-label",`Select ${get$1(method).name??""} payment method`);set_text(text_9,get$1(method).name);set_text(text_11,$0)},[()=>get$1(method).type.toUpperCase()]);append($$anchor7,button_2)});reset(div_21);append($$anchor6,div_21)};if_block(node_6,$$render=>{if(strict_equals(get$1(paymentMethods).length,0))$$render(consequent_5);else $$render(alternate_3,false)})}reset(div_19);var div_27=sibling(div_19,2);var button_3=child(div_27);button_3.__click=[on_click_2$1,goToStep];var button_4=sibling(button_3,2);button_4.__click=[executePurchase,quote,selectedPaymentMethod,loading,error,buyService,order,step];var node_8=child(button_4);{var consequent_7=$$anchor6=>{var text_12=text("Processing...");append($$anchor6,text_12)};var alternate_4=$$anchor6=>{var text_13=text("Buy Now");append($$anchor6,text_13)};if_block(node_8,$$render=>{if(get$1(loading))$$render(consequent_7);else $$render(alternate_4,false)})}reset(button_4);reset(div_27);reset(div_11);template_effect(()=>button_4.disabled=!get$1(selectedPaymentMethod)||get$1(loading));append($$anchor5,div_11)};if_block(node_4,$$render=>{if(strict_equals(get$1(step),"payment"))$$render(consequent_8)})}var node_9=sibling(node_4,2);{var consequent_10=$$anchor5=>{var div_28=root_19();var node_10=sibling(child(div_28),4);{var consequent_9=$$anchor6=>{var fragment_2=root_20();var p=first_child(fragment_2);var text_14=child(p);reset(p);var div_29=sibling(p,2);var div_30=child(div_29);var div_31=child(div_30);var text_15=sibling(child(div_31));reset(div_31);var div_32=sibling(div_31,2);var text_16=sibling(child(div_32));reset(div_32);next(2);reset(div_30);reset(div_29);template_effect(()=>{set_text(text_14,`Your order for ${get$1(order).cryptoAmount??""} ${get$1(order).cryptoCurrency??""} has been placed.`);set_text(text_15,` ${get$1(order).id??""}`);set_text(text_16,` ${get$1(order).status??""}`)});append($$anchor6,fragment_2)};if_block(node_10,$$render=>{if(get$1(order))$$render(consequent_9)})}var button_5=sibling(node_10,2);button_5.__click=closeModal;reset(div_28);append($$anchor5,div_28)};if_block(node_9,$$render=>{if(strict_equals(get$1(step),"success"))$$render(consequent_10)})}var node_11=sibling(node_9,2);{var consequent_11=$$anchor5=>{var div_33=root_21();var text_17=child(div_33,true);reset(div_33);template_effect(()=>set_text(text_17,get$1(error)));append($$anchor5,div_33)};if_block(node_11,$$render=>{if(get$1(error))$$render(consequent_11)})}var node_12=sibling(node_11,2);{var consequent_12=$$anchor5=>{var div_34=root_22();append($$anchor5,div_34)};if_block(node_12,$$render=>{if(strict_equals(get$1(step),"amount"))$$render(consequent_12)})}append($$anchor4,fragment_1)};if_block($$anchor3,$$render=>{if(!get$1(account))$$render(consequent_1);else $$render(alternate_1,false)},$$elseif)}};if_block(node_1,$$render=>{if(!get$1(canBuy))$$render(consequent);else $$render(alternate,false)})}reset(div_1);reset(div);append($$anchor2,div)};if_block(node,$$render=>{if(show())$$render(consequent_13)})}append($$anchor,fragment);var $$pop=pop({...legacy_api()});$$cleanup();return $$pop}delegate(["click","keydown"]);TokenPortfolio[FILENAME]="src/routes/preview2/lib/components/TokenPortfolio.svelte";var root_2$3=add_locations(from_html(`<div class="rounded-xl shadow bg-zinc-100 dark:bg-zinc-700 p-3 animate-pulse"><div class="w-8 h-8 mb-1 rounded-full bg-zinc-300 dark:bg-zinc-600 mx-auto"></div> <div class="h-4 bg-zinc-300 dark:bg-zinc-600 rounded mt-2"></div> <div class="h-3 bg-zinc-300 dark:bg-zinc-600 rounded mt-1 w-3/4 mx-auto"></div> <div class="h-3 bg-zinc-300 dark:bg-zinc-600 rounded mt-1 w-1/2 mx-auto"></div></div>`),TokenPortfolio[FILENAME],[[31,8,[[32,10],[33,10],[34,10],[35,10]]]]);var root_1$2=add_locations(from_html(`<div class="grid grid-cols-2 gap-3"></div>`),TokenPortfolio[FILENAME],[[29,4]]);var root_4$3=add_locations(from_html(`<div class="text-center py-8 text-gray-500 dark:text-gray-400"><p>No tokens found</p> <p class="text-sm mt-2">Add tokens to see them here</p></div>`),TokenPortfolio[FILENAME],[[40,4,[[41,6],[42,6]]]]);var root_7$2=add_locations(from_html(`<img class="w-8 h-8 mb-1 rounded-full"/>`),TokenPortfolio[FILENAME],[[49,12]]);var root_8$1=add_locations(from_html(`<div> </div>`),TokenPortfolio[FILENAME],[[51,12]]);var root_9$1=add_locations(from_html(`<div class="text-xs text-zinc-400 dark:text-zinc-200 truncate max-w-[96px] text-center cursor-help mt-0.5"> </div>`),TokenPortfolio[FILENAME],[[57,12]]);var root_10$1=add_locations(from_html(`<div class="text-sm text-zinc-600 dark:text-zinc-300 truncate max-w-[96px] text-center cursor-help"> </div>`),TokenPortfolio[FILENAME],[[62,12]]);var root_6$2=add_locations(from_html(`<div class="rounded-xl shadow flex flex-col items-center justify-center bg-zinc-100 dark:bg-zinc-700 p-3 transition hover:ring-2 hover:ring-indigo-400 dark:hover:ring-indigo-300 min-w-0"><!> <div class="font-bold text-base text-center mt-1"> </div> <!> <!></div>`),TokenPortfolio[FILENAME],[[47,8,[[55,10]]]]);var root_5$1=add_locations(from_html(`<div class="grid grid-cols-2 gap-3 overflow-auto"></div> <!>`,1),TokenPortfolio[FILENAME],[[45,4]]);var root$2=add_locations(from_html(`<div><div class="text-sm font-semibold mb-2 text-zinc-700 dark:text-zinc-200">Token Portfolio</div> <!></div>`),TokenPortfolio[FILENAME],[[25,0,[[26,2]]]]);function TokenPortfolio($$anchor,$$props){check_target(new.target);push($$props,true,TokenPortfolio);let tokens2=prop($$props,"tokens",19,()=>[]),className=prop($$props,"className",3,""),maxRows=prop($$props,"maxRows",3,4),loading=prop($$props,"loading",3,false);let expanded=tag(state(false),"expanded");let visible=tag(state(proxy(tokens2().slice(0,maxRows()))),"visible");let hidden=tag(state(proxy(tokens2().slice(maxRows()))),"hidden");user_effect(()=>{set(visible,get$1(expanded)?tokens2():tokens2().slice(0,maxRows()),true);set(hidden,get$1(expanded)?[]:tokens2().slice(maxRows()),true)});function needsEllipsis(val){return String(val??"").length>9}function formatValue(val){if(!val)return"0.00";return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(val)}var div=root$2();var node=sibling(child(div),2);{var consequent=$$anchor2=>{var div_1=root_1$2();each(div_1,20,()=>Array(4),index,($$anchor3,_)=>{var div_2=root_2$3();append($$anchor3,div_2)});reset(div_1);append($$anchor2,div_1)};var alternate=($$anchor2,$$elseif)=>{{var consequent_1=$$anchor3=>{var div_3=root_4$3();append($$anchor3,div_3)};var alternate_1=$$anchor3=>{var fragment=root_5$1();var div_4=first_child(fragment);each(div_4,21,()=>get$1(visible),index,($$anchor4,token)=>{var div_5=root_6$2();var node_1=child(div_5);{var consequent_2=$$anchor5=>{var img=root_7$2();template_effect(()=>{set_attribute(img,"src",get$1(token).icon);set_attribute(img,"alt",get$1(token).symbol)});append($$anchor5,img)};var alternate_2=$$anchor5=>{var div_6=root_8$1();var text2=child(div_6,true);reset(div_6);template_effect(()=>{set_class(div_6,1,`w-8 h-8 mb-1 rounded-full flex items-center justify-center ${get$1(token).color||"bg-gray-400"} text-white font-bold text-lg`);set_text(text2,get$1(token).icon||get$1(token).symbol[0])});append($$anchor5,div_6)};if_block(node_1,$$render=>{var _a,_b;if(((_a=get$1(token).icon)==null?void 0:_a.startsWith("/"))||((_b=get$1(token).icon)==null?void 0:_b.startsWith("http")))$$render(consequent_2);else $$render(alternate_2,false)})}var div_7=sibling(node_1,2);var text_1=child(div_7,true);reset(div_7);var node_2=sibling(div_7,2);const expression=user_derived(()=>`${get$1(token).qty||0} ${get$1(token).symbol}`);SimpleTooltip(node_2,{get content(){return get$1(expression)},children:wrap_snippet(TokenPortfolio,($$anchor5,$$slotProps)=>{var div_8=root_9$1();var text_2=child(div_8,true);reset(div_8);template_effect($0=>set_text(text_2,$0),[()=>needsEllipsis(get$1(token).qty)?`${get$1(token).qty}`.slice(0,9)+"…":get$1(token).qty||0]);append($$anchor5,div_8)}),$$slots:{default:true}});var node_3=sibling(node_2,2);const expression_1=user_derived(()=>formatValue(get$1(token).value));SimpleTooltip(node_3,{get content(){return get$1(expression_1)},children:wrap_snippet(TokenPortfolio,($$anchor5,$$slotProps)=>{var div_9=root_10$1();var text_3=child(div_9,true);reset(div_9);template_effect($0=>set_text(text_3,$0),[()=>formatValue(get$1(token).value)]);append($$anchor5,div_9)}),$$slots:{default:true}});reset(div_5);template_effect(()=>set_text(text_1,get$1(token).symbol));append($$anchor4,div_5)});reset(div_4);var node_4=sibling(div_4,2);{var consequent_3=$$anchor4=>{MoreLess($$anchor4,{get count(){return get$1(hidden).length},text:"more",lessText:"less",get expanded(){return get$1(expanded)},className:"mt-2",onclick:()=>set(expanded,!get$1(expanded))})};if_block(node_4,$$render=>{if(get$1(hidden).length)$$render(consequent_3)})}append($$anchor3,fragment)};if_block($$anchor2,$$render=>{if(strict_equals(tokens2().length,0))$$render(consequent_1);else $$render(alternate_1,false)},$$elseif)}};if_block(node,$$render=>{if(loading())$$render(consequent);else $$render(alternate,false)})}reset(div);template_effect(()=>set_class(div,1,`bg-white/70 dark:bg-zinc-800 p-4 rounded-2xl shadow space-y-2 relative z-10 ${className()}`));append($$anchor,div);return pop({...legacy_api()})}const yakklCombinedTokenStore={subscribe:()=>()=>{},get:()=>[]};const _TokenService=class _TokenService extends BaseService{constructor(){super()}static getInstance(){if(!_TokenService.instance){_TokenService.instance=new _TokenService}return _TokenService.instance}async getTokens(address){try{const combinedTokens=yakklCombinedTokenStore.get();if(!combinedTokens||combinedTokens.length===0){return{success:true,data:[]}}const preview2Tokens=combinedTokens.map(token=>({symbol:token.symbol,name:token.name,icon:token.logo||this.getDefaultIcon(token.symbol),value:parseFloat(token.totalValue||"0"),qty:parseFloat(token.totalQuantity||"0"),price:parseFloat(token.price||"0"),change24h:token.priceChange24h,address:token.address,decimals:token.decimals,color:this.getTokenColor(token.symbol)}));preview2Tokens.sort((a,b)=>b.value-a.value);return{success:true,data:preview2Tokens}}catch(error){return{success:false,error:this.handleError(error)}}}async getTokenBalance(tokenAddress,walletAddress){try{const response=await this.sendMessage({method:"eth_call",params:[{to:tokenAddress,data:`0x70a08231000000000000000000000000${walletAddress.slice(2)}`},"latest"]});return response}catch(error){return{success:false,error:this.handleError(error)}}}async refreshTokenPrices(){try{const response=await this.sendMessage({method:"yakkl_refreshTokenPrices"});return response}catch(error){return{success:false,error:this.handleError(error)}}}getDefaultIcon(symbol){const iconMap={ETH:"/images/eth.svg",BTC:"₿",USDT:"💵",USDC:"💰",DAI:"🏦",LINK:"🔗",UNI:"🦄",AAVE:"👻",COMP:"🏛️",MKR:"🏭",SUSHI:"🍣",YFI:"🌾",PEPE:"🐸"};return iconMap[symbol.toUpperCase()]||"🪙"}getTokenColor(symbol){const colorMap={ETH:"bg-blue-400",BTC:"bg-orange-400",USDT:"bg-green-400",USDC:"bg-blue-500",DAI:"bg-yellow-400",LINK:"bg-indigo-400",UNI:"bg-pink-400",AAVE:"bg-purple-400",COMP:"bg-teal-400",MKR:"bg-cyan-400",SUSHI:"bg-rose-400",YFI:"bg-amber-400",PEPE:"bg-green-500"};return colorMap[symbol.toUpperCase()]||"bg-gray-400"}};__publicField(_TokenService,"instance");let TokenService=_TokenService;function createTokenStore(){const tokenService=TokenService.getInstance();const{subscribe:subscribe,set:set2,update:update}=writable({tokens:[],loading:{isLoading:false},error:{hasError:false},lastUpdate:null});currentAccount.subscribe(async account=>{if(account){await loadTokens(account.address)}});async function loadTokens(address){update(state2=>({...state2,loading:{isLoading:true,message:"Loading tokens..."}}));const response=await tokenService.getTokens(address);if(response.success&&response.data){update(state2=>({...state2,tokens:response.data,loading:{isLoading:false},error:{hasError:false},lastUpdate:new Date}))}else{update(state2=>({...state2,loading:{isLoading:false},error:response.error||{hasError:true,message:"Failed to load tokens"}}))}}return{subscribe:subscribe,async refresh(){const account=get(currentAccount);if(account){await loadTokens(account.address)}},async refreshPrices(){update(state2=>({...state2,loading:{isLoading:true,message:"Updating prices..."}}));const response=await tokenService.refreshTokenPrices();if(response.success){const account=get(currentAccount);if(account){await loadTokens(account.address)}}else{update(state2=>({...state2,loading:{isLoading:false},error:response.error||{hasError:true,message:"Failed to update prices"}}))}},reset(){set2({tokens:[],loading:{isLoading:false},error:{hasError:false},lastUpdate:null})}}}const tokenStore=createTokenStore();const tokens=derived(tokenStore,$store=>$store.tokens);const totalPortfolioValue=derived(tokenStore,$store=>$store.tokens.reduce((sum,token)=>sum+token.value,0));const isLoadingTokens=derived(tokenStore,$store=>$store.loading.isLoading);derived(tokenStore,$store=>[...$store.tokens].sort((a,b)=>b.value-a.value));const lastTokenUpdate=derived(tokenStore,$store=>$store.lastUpdate);const token_store=Object.freeze(Object.defineProperty({__proto__:null,isLoadingTokens:isLoadingTokens,lastTokenUpdate:lastTokenUpdate,tokenStore:tokenStore,tokens:tokens,totalPortfolioValue:totalPortfolioValue},Symbol.toStringTag,{value:"Module"}));AdvancedAnalytics[FILENAME]="src/routes/preview2/lib/components/pro/AdvancedAnalytics.svelte";var root_1$1=add_locations(from_html(`<div><div class="p-6 text-center"><div class="mb-4"><svg class="w-12 h-12 mx-auto text-indigo-500 dark:text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg></div> <h3 class="text-lg font-semibold text-zinc-900 dark:text-white mb-2">Advanced Portfolio Analytics</h3> <p class="text-sm text-zinc-600 dark:text-zinc-400 mb-4">Get detailed performance insights, risk analysis, and personalized recommendations</p> <button class="yakkl-btn-primary bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700">Upgrade to Pro</button></div></div>`),AdvancedAnalytics[FILENAME],[[72,2,[[73,4,[[74,6,[[75,8,[[76,10]]]]],[79,6],[80,6],[83,6]]]]]]);var root_3$2=add_locations(from_html(`<div class="flex items-center justify-between p-3 bg-zinc-50 dark:bg-zinc-800/50 rounded-lg"><div class="flex items-center gap-3"><div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white text-xs font-bold"> </div> <div><div class="font-medium text-zinc-900 dark:text-white"> </div> <div class="text-sm text-zinc-500 dark:text-zinc-400"> </div></div></div> <div class="text-green-600 dark:text-green-400 font-bold"> </div></div>`),AdvancedAnalytics[FILENAME],[[154,12,[[155,14,[[156,16],[159,16,[[160,18],[161,18]]]]],[164,14]]]]);var root_4$2=add_locations(from_html(`<div class="flex items-start gap-3 p-3 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-lg"><svg class="w-5 h-5 text-indigo-600 dark:text-indigo-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <p class="text-sm text-zinc-700 dark:text-zinc-300"> </p></div>`),AdvancedAnalytics[FILENAME],[[175,12,[[176,14,[[177,16]]],[179,14]]]]);var root_2$2=add_locations(from_html(`<div><div class="p-6"><div class="flex items-center gap-2 mb-6"><svg class="w-6 h-6 text-indigo-600 dark:text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg> <h3 class="text-xl font-bold text-zinc-900 dark:text-white">Advanced Analytics</h3> <span class="px-2 py-1 bg-gradient-to-r from-indigo-500 to-purple-600 text-white text-xs rounded-full font-semibold">PRO</span></div> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"><div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 p-4 rounded-xl"><div class="text-xs font-medium text-green-700 dark:text-green-300 mb-1">24h Change</div> <div> </div></div> <div class="bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 p-4 rounded-xl"><div class="text-xs font-medium text-blue-700 dark:text-blue-300 mb-1">7d Change</div> <div> </div></div> <div class="bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-4 rounded-xl"><div class="text-xs font-medium text-purple-700 dark:text-purple-300 mb-1">30d Change</div> <div> </div></div> <div class="bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 p-4 rounded-xl"><div class="text-xs font-medium text-amber-700 dark:text-amber-300 mb-1">1y Change</div> <div> </div></div></div> <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"><div class="bg-zinc-50 dark:bg-zinc-800/50 p-4 rounded-xl"><div class="text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2">Risk Profile</div> <div class="text-lg font-bold text-zinc-900 dark:text-white"> </div></div> <div class="bg-zinc-50 dark:bg-zinc-800/50 p-4 rounded-xl"><div class="text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2">Diversification</div> <div class="text-lg font-bold text-zinc-900 dark:text-white"> </div></div> <div class="bg-zinc-50 dark:bg-zinc-800/50 p-4 rounded-xl"><div class="text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2">Sharpe Ratio</div> <div class="text-lg font-bold text-zinc-900 dark:text-white"> </div></div></div> <div class="mb-6"><h4 class="text-lg font-semibold text-zinc-900 dark:text-white mb-3">Top Performers</h4> <div class="space-y-2"></div></div> <div><h4 class="text-lg font-semibold text-zinc-900 dark:text-white mb-3">AI Recommendations</h4> <div class="space-y-3"></div></div></div></div>`),AdvancedAnalytics[FILENAME],[[90,2,[[91,4,[[92,6,[[93,8,[[94,10]]],[96,8],[97,8]]],[101,6,[[102,8,[[103,10],[104,10]]],[109,8,[[110,10],[111,10]]],[116,8,[[117,10],[118,10]]],[123,8,[[124,10],[125,10]]]]],[132,6,[[133,8,[[134,10],[135,10]]],[138,8,[[139,10],[140,10]]],[143,8,[[144,10],[145,10]]]]],[150,6,[[151,8],[152,8]]],[171,6,[[172,8],[173,8]]]]]]]]);function AdvancedAnalytics($$anchor,$$props){check_target(new.target);push($$props,true,AdvancedAnalytics);const[$$stores,$$cleanup]=setup_stores();const $totalPortfolioValue=()=>(validate_store(totalPortfolioValue,"totalPortfolioValue"),store_get(totalPortfolioValue,"$totalPortfolioValue",$$stores));const $tokens=()=>(validate_store(tokens,"tokens"),store_get(tokens,"$tokens",$$stores));let className=prop($$props,"className",3,"");let performanceData=tag(state(proxy({dayChange:0,weekChange:0,monthChange:0,yearChange:0,volatility:0,sharpeRatio:0})),"performanceData");let diversificationScore=tag(state(0),"diversificationScore");let riskProfile=tag(state("Conservative"),"riskProfile");let topPerformers=tag(state(proxy([])),"topPerformers");let recommendations=tag(state(proxy([])),"recommendations");tag(user_derived($totalPortfolioValue),"portfolioValue");tag(user_derived($tokens),"tokenList");onMount(()=>{if(canUseFeature$1("advanced_analytics")){loadAdvancedAnalytics()}});async function loadAdvancedAnalytics(){try{set(performanceData,{dayChange:2.4,weekChange:-1.2,monthChange:8.7,yearChange:34.2,volatility:15.8,sharpeRatio:1.23},true);set(diversificationScore,72);set(riskProfile,calculateRiskProfile(),true);set(topPerformers,getTopPerformers(),true);set(recommendations,generateRecommendations(),true)}catch(error){console.error(...log_if_contains_state("error","Failed to load advanced analytics:",error))}}function calculateRiskProfile(){if(get$1(performanceData).volatility<10)return"Conservative";if(get$1(performanceData).volatility<20)return"Moderate";return"Aggressive"}function getTopPerformers(){return[{symbol:"ETH",change:"+12.4%",value:"$1,234"},{symbol:"BTC",change:"+8.2%",value:"$5,678"},{symbol:"SOL",change:"+15.1%",value:"$890"}]}function generateRecommendations(){return["Consider rebalancing your portfolio - ETH allocation is above target","Low diversification detected - consider adding more asset classes","Your DeFi exposure could be optimized with yield farming strategies"]}function formatChange(change){const sign=change>=0?"+":"";return`${sign}${change.toFixed(1)}%`}function getChangeColor(change){return change>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}var fragment=comment();var node=first_child(fragment);{var consequent=$$anchor2=>{var div=root_1$1();template_effect(()=>set_class(div,1,`yakkl-card ${className()}`));append($$anchor2,div)};var alternate=$$anchor2=>{var div_1=root_2$2();var div_2=child(div_1);var div_3=sibling(child(div_2),2);var div_4=child(div_3);var div_5=sibling(child(div_4),2);var text2=child(div_5,true);reset(div_5);reset(div_4);var div_6=sibling(div_4,2);var div_7=sibling(child(div_6),2);var text_1=child(div_7,true);reset(div_7);reset(div_6);var div_8=sibling(div_6,2);var div_9=sibling(child(div_8),2);var text_2=child(div_9,true);reset(div_9);reset(div_8);var div_10=sibling(div_8,2);var div_11=sibling(child(div_10),2);var text_3=child(div_11,true);reset(div_11);reset(div_10);reset(div_3);var div_12=sibling(div_3,2);var div_13=child(div_12);var div_14=sibling(child(div_13),2);var text_4=child(div_14,true);reset(div_14);reset(div_13);var div_15=sibling(div_13,2);var div_16=sibling(child(div_15),2);var text_5=child(div_16);reset(div_16);reset(div_15);var div_17=sibling(div_15,2);var div_18=sibling(child(div_17),2);var text_6=child(div_18,true);reset(div_18);reset(div_17);reset(div_12);var div_19=sibling(div_12,2);var div_20=sibling(child(div_19),2);each(div_20,21,()=>get$1(topPerformers),index,($$anchor3,performer)=>{var div_21=root_3$2();var div_22=child(div_21);var div_23=child(div_22);var text_7=child(div_23,true);reset(div_23);var div_24=sibling(div_23,2);var div_25=child(div_24);var text_8=child(div_25,true);reset(div_25);var div_26=sibling(div_25,2);var text_9=child(div_26,true);reset(div_26);reset(div_24);reset(div_22);var div_27=sibling(div_22,2);var text_10=child(div_27,true);reset(div_27);reset(div_21);template_effect($0=>{set_text(text_7,$0);set_text(text_8,get$1(performer).symbol);set_text(text_9,get$1(performer).value);set_text(text_10,get$1(performer).change)},[()=>get$1(performer).symbol.slice(0,2)]);append($$anchor3,div_21)});reset(div_20);reset(div_19);var div_28=sibling(div_19,2);var div_29=sibling(child(div_28),2);each(div_29,21,()=>get$1(recommendations),index,($$anchor3,recommendation)=>{var div_30=root_4$2();var p=sibling(child(div_30),2);var text_11=child(p,true);reset(p);reset(div_30);template_effect(()=>set_text(text_11,get$1(recommendation)));append($$anchor3,div_30)});reset(div_29);reset(div_28);reset(div_2);reset(div_1);template_effect(($0,$1,$2,$3,$4,$5,$6,$7)=>{set_class(div_1,1,`yakkl-card ${className()}`);set_class(div_5,1,$0);set_text(text2,$1);set_class(div_7,1,$2);set_text(text_1,$3);set_class(div_9,1,$4);set_text(text_2,$5);set_class(div_11,1,$6);set_text(text_3,$7);set_text(text_4,get$1(riskProfile));set_text(text_5,`${get$1(diversificationScore)??""}/100`);set_text(text_6,get$1(performanceData).sharpeRatio)},[()=>`text-lg font-bold ${getChangeColor(get$1(performanceData).dayChange)}`,()=>formatChange(get$1(performanceData).dayChange),()=>`text-lg font-bold ${getChangeColor(get$1(performanceData).weekChange)}`,()=>formatChange(get$1(performanceData).weekChange),()=>`text-lg font-bold ${getChangeColor(get$1(performanceData).monthChange)}`,()=>formatChange(get$1(performanceData).monthChange),()=>`text-lg font-bold ${getChangeColor(get$1(performanceData).yearChange)}`,()=>formatChange(get$1(performanceData).yearChange)]);append($$anchor2,div_1)};if_block(node,$$render=>{if(!canUseFeature$1("advanced_analytics"))$$render(consequent);else $$render(alternate,false)})}append($$anchor,fragment);var $$pop=pop({...legacy_api()});$$cleanup();return $$pop}SecureRecovery[FILENAME]="src/routes/preview2/lib/components/private/SecureRecovery.svelte";function createShamirBackup(_,showSecurityWarning){set(showSecurityWarning,true);console.log("Creating Shamir backup...")}function setupHardwareBackup(){console.log("Setting up hardware backup...")}function createAirGappedBackup(){console.log("Creating air-gapped backup...")}function testRecovery(){console.log("Testing recovery process...")}var root_1=add_locations(from_html(`<div><div class="p-6 text-center"><div class="mb-4"><svg class="w-12 h-12 mx-auto text-red-500 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg></div> <h3 class="text-lg font-semibold text-zinc-900 dark:text-white mb-2">Secure Recovery System</h3> <p class="text-sm text-zinc-600 dark:text-zinc-400 mb-4">Military-grade private key backup, Shamir secret sharing, and air-gapped recovery</p> <button class="yakkl-btn-primary bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700">Upgrade to Private</button></div></div>`),SecureRecovery[FILENAME],[[79,2,[[80,4,[[81,6,[[82,8,[[83,10]]]]],[86,6],[87,6],[90,6]]]]]]);var root_4$1=add_locations(from_svg(`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>`),SecureRecovery[FILENAME],[[147,20,[[148,22],[149,22]]]]);var root_6$1=add_locations(from_svg(`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path></svg>`),SecureRecovery[FILENAME],[[152,20,[[153,22]]]]);var root_7$1=add_locations(from_svg(`<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192L5.636 18.364M12 3v2.25m0 13.5V21m9-9h-2.25M4.5 12H3"></path></svg>`),SecureRecovery[FILENAME],[[156,20,[[157,22]]]]);var root_8=add_locations(from_html(`<div class="text-sm text-zinc-500 dark:text-zinc-400"> </div>`),SecureRecovery[FILENAME],[[164,20]]);var root_10=add_locations(from_html(`<div class="text-sm text-zinc-500 dark:text-zinc-400"> </div>`),SecureRecovery[FILENAME],[[168,20]]);var root_12$1=add_locations(from_html(`<div class="text-sm text-zinc-500 dark:text-zinc-400"> </div>`),SecureRecovery[FILENAME],[[170,20]]);var root_3$1=add_locations(from_html(`<div class="flex items-center justify-between p-4 bg-zinc-50 dark:bg-zinc-800/50 rounded-lg"><div class="flex items-center gap-3"><div class="w-10 h-10 bg-gradient-to-br from-red-500 to-rose-600 rounded-lg flex items-center justify-center text-white"><!></div> <div><div class="font-medium text-zinc-900 dark:text-white"> </div> <!></div></div> <span> </span></div>`),SecureRecovery[FILENAME],[[143,12,[[144,14,[[145,16],[161,16,[[162,18]]]]],[174,14]]]]);var root_14=add_locations(from_svg(`<svg class="w-4 h-4 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>`),SecureRecovery[FILENAME],[[196,16,[[197,18]]]]);var root_13=add_locations(from_html(`<div class="flex items-center justify-between p-3 bg-zinc-50 dark:bg-zinc-800/50 rounded-lg"><div class="flex items-center gap-3"><div></div> <div><div class="font-medium text-zinc-900 dark:text-white"> </div> <div class="text-sm text-zinc-500 dark:text-zinc-400"> </div></div></div> <!></div>`),SecureRecovery[FILENAME],[[187,12,[[188,14,[[189,16],[190,16,[[191,18],[192,18]]]]]]]]);var root_2$1=add_locations(from_html(`<div><div class="p-6"><div class="flex items-center gap-2 mb-6"><svg class="w-6 h-6 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg> <h3 class="text-xl font-bold text-zinc-900 dark:text-white">Secure Recovery</h3> <span class="px-2 py-1 bg-gradient-to-r from-red-500 to-rose-600 text-white text-xs rounded-full font-semibold">PRIVATE</span></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"><div class="bg-gradient-to-br from-red-50 to-rose-50 dark:from-red-900/20 dark:to-rose-900/20 p-4 rounded-xl"><div class="flex items-center gap-2 mb-2"><div></div> <div class="text-sm font-medium text-red-700 dark:text-red-300">Backup Status</div></div> <div class="text-lg font-bold text-zinc-900 dark:text-white mb-1"> </div> <div class="text-xs text-zinc-500 dark:text-zinc-400"> </div></div> <div class="bg-gradient-to-br from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 p-4 rounded-xl"><div class="text-sm font-medium text-amber-700 dark:text-amber-300 mb-2">Backup Method</div> <div class="text-lg font-bold text-zinc-900 dark:text-white mb-1"> </div> <div class="flex items-center gap-1"><div></div> <div class="text-xs text-zinc-500 dark:text-zinc-400"> </div></div></div></div> <div class="mb-6"><h4 class="text-lg font-semibold text-zinc-900 dark:text-white mb-3">Recovery Methods</h4> <div class="space-y-3"></div></div> <div class="mb-6"><h4 class="text-lg font-semibold text-zinc-900 dark:text-white mb-3">Hardware Devices</h4> <div class="grid grid-cols-1 md:grid-cols-2 gap-3"></div></div> <div class="flex flex-wrap gap-3"><button class="yakkl-btn-primary bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-sm">Create Shamir Backup</button> <button class="yakkl-btn-secondary text-sm">Setup Hardware Backup</button> <button class="yakkl-btn-secondary text-sm">Air-Gapped Backup</button> <button class="yakkl-btn-secondary text-sm">Test Recovery</button></div></div></div>`),SecureRecovery[FILENAME],[[97,2,[[98,4,[[99,6,[[100,8,[[101,10]]],[103,8],[104,8]]],[108,6,[[109,8,[[110,10,[[111,12],[112,12]]],[114,10],[117,10]]],[122,8,[[123,10],[124,10],[129,10,[[130,12],[131,12]]]]]]],[139,6,[[140,8],[141,8]]],[183,6,[[184,8],[185,8]]],[206,6,[[207,8],[214,8],[221,8],[228,8]]]]]]]]);var on_click$1=(__1,showSecurityWarning)=>set(showSecurityWarning,false);var on_click_1$1=(__2,showSecurityWarning)=>{set(showSecurityWarning,false)};var root_15$1=add_locations(from_html(`<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50"><div class="bg-white dark:bg-zinc-800 rounded-xl p-6 max-w-md mx-4"><div class="flex items-center gap-3 mb-4"><svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.664-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <h3 class="text-lg font-bold text-zinc-900 dark:text-white">Security Warning</h3></div> <p class="text-sm text-zinc-600 dark:text-zinc-400 mb-4">You are about to create a cryptographic backup of your private keys. Ensure you're in a secure environment and follow all security protocols.</p> <div class="flex gap-3"><button class="flex-1 yakkl-btn-secondary text-sm">Cancel</button> <button class="flex-1 yakkl-btn-primary bg-red-600 hover:bg-red-700 text-sm">I Understand</button></div></div></div>`),SecureRecovery[FILENAME],[[241,2,[[242,4,[[243,6,[[244,8,[[245,10]]],[247,8]]],[249,6],[252,6,[[253,8],[259,8]]]]]]]]);var root$1=add_locations(from_html(`<!> <!>`,1),SecureRecovery[FILENAME],[]);function SecureRecovery($$anchor,$$props){check_target(new.target);push($$props,true,SecureRecovery);let className=prop($$props,"className",3,"");let backupStatus=tag(state(proxy({hasSecureBackup:false,lastBackupDate:null,backupMethod:"none",integrityCheck:false})),"backupStatus");let recoveryOptions=tag(state(proxy([])),"recoveryOptions");let hardwareDevices=tag(state(proxy([])),"hardwareDevices");let showSecurityWarning=tag(state(false),"showSecurityWarning");onMount(()=>{if(canUseFeature$1("private_key_backup")){loadSecurityStatus()}});async function loadSecurityStatus(){try{set(backupStatus,{hasSecureBackup:true,lastBackupDate:new Date("2024-01-15"),backupMethod:"shamir",integrityCheck:true},true);set(recoveryOptions,[{method:"Shamir Secret Sharing",status:"active",shards:5,threshold:3},{method:"Hardware Backup",status:"pending",device:"Ledger Nano X"},{method:"Air-Gapped Storage",status:"inactive",location:"Not configured"}],true);set(hardwareDevices,[{name:"Ledger Nano X",status:"connected",backup:true},{name:"Trezor Model T",status:"disconnected",backup:false}],true)}catch(error){console.error(...log_if_contains_state("error","Failed to load security status:",error))}}function formatDate(date){if(!date)return"Never";return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(date)}function getStatusColor(status){switch(status){case"active":return"text-green-600 dark:text-green-400 bg-green-100 dark:bg-green-900/30";case"pending":return"text-amber-600 dark:text-amber-400 bg-amber-100 dark:bg-amber-900/30";case"inactive":return"text-red-600 dark:text-red-400 bg-red-100 dark:bg-red-900/30";default:return"text-zinc-600 dark:text-zinc-400 bg-zinc-100 dark:bg-zinc-800"}}var fragment=root$1();var node=first_child(fragment);{var consequent=$$anchor2=>{var div=root_1();template_effect(()=>set_class(div,1,`yakkl-card ${className()}`));append($$anchor2,div)};var alternate=$$anchor2=>{var div_1=root_2$1();var div_2=child(div_1);var div_3=sibling(child(div_2),2);var div_4=child(div_3);var div_5=child(div_4);var div_6=child(div_5);next(2);reset(div_5);var div_7=sibling(div_5,2);var text2=child(div_7,true);reset(div_7);var div_8=sibling(div_7,2);var text_1=child(div_8);reset(div_8);reset(div_4);var div_9=sibling(div_4,2);var div_10=sibling(child(div_9),2);var text_2=child(div_10,true);reset(div_10);var div_11=sibling(div_10,2);var div_12=child(div_11);var div_13=sibling(div_12,2);var text_3=child(div_13);reset(div_13);reset(div_11);reset(div_9);reset(div_3);var div_14=sibling(div_3,2);var div_15=sibling(child(div_14),2);each(div_15,21,()=>get$1(recoveryOptions),index,($$anchor3,option)=>{var div_16=root_3$1();var div_17=child(div_16);var div_18=child(div_17);var node_1=child(div_18);{var consequent_1=$$anchor4=>{var svg=root_4$1();append($$anchor4,svg)};var alternate_1=($$anchor4,$$elseif)=>{{var consequent_2=$$anchor5=>{var svg_1=root_6$1();append($$anchor5,svg_1)};var alternate_2=$$anchor5=>{var svg_2=root_7$1();append($$anchor5,svg_2)};if_block($$anchor4,$$render=>{if(get$1(option).method.includes("Hardware"))$$render(consequent_2);else $$render(alternate_2,false)},$$elseif)}};if_block(node_1,$$render=>{if(get$1(option).method.includes("Shamir"))$$render(consequent_1);else $$render(alternate_1,false)})}reset(div_18);var div_19=sibling(div_18,2);var div_20=child(div_19);var text_4=child(div_20,true);reset(div_20);var node_2=sibling(div_20,2);{var consequent_3=$$anchor4=>{var div_21=root_8();var text_5=child(div_21);reset(div_21);template_effect(()=>set_text(text_5,`${get$1(option).shards??""} shards, ${get$1(option).threshold??""} required`));append($$anchor4,div_21)};var alternate_3=($$anchor4,$$elseif)=>{{var consequent_4=$$anchor5=>{var div_22=root_10();var text_6=child(div_22,true);reset(div_22);template_effect(()=>set_text(text_6,get$1(option).device));append($$anchor5,div_22)};var alternate_4=($$anchor5,$$elseif2)=>{{var consequent_5=$$anchor6=>{var div_23=root_12$1();var text_7=child(div_23,true);reset(div_23);template_effect(()=>set_text(text_7,get$1(option).location));append($$anchor6,div_23)};if_block($$anchor5,$$render=>{if(get$1(option).location)$$render(consequent_5)},$$elseif2)}};if_block($$anchor4,$$render=>{if(get$1(option).device)$$render(consequent_4);else $$render(alternate_4,false)},$$elseif)}};if_block(node_2,$$render=>{if(get$1(option).shards)$$render(consequent_3);else $$render(alternate_3,false)})}reset(div_19);reset(div_17);var span=sibling(div_17,2);var text_8=child(span,true);reset(span);reset(div_16);template_effect($0=>{set_text(text_4,get$1(option).method);set_class(span,1,$0);set_text(text_8,get$1(option).status)},[()=>`px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(get$1(option).status)}`]);append($$anchor3,div_16)});reset(div_15);reset(div_14);var div_24=sibling(div_14,2);var div_25=sibling(child(div_24),2);each(div_25,21,()=>get$1(hardwareDevices),index,($$anchor3,device)=>{var div_26=root_13();var div_27=child(div_26);var div_28=child(div_27);var div_29=sibling(div_28,2);var div_30=child(div_29);var text_9=child(div_30,true);reset(div_30);var div_31=sibling(div_30,2);var text_10=child(div_31,true);reset(div_31);reset(div_29);reset(div_27);var node_3=sibling(div_27,2);{var consequent_6=$$anchor4=>{var svg_3=root_14();append($$anchor4,svg_3)};if_block(node_3,$$render=>{if(get$1(device).backup)$$render(consequent_6)})}reset(div_26);template_effect(()=>{set_class(div_28,1,`w-3 h-3 rounded-full ${strict_equals(get$1(device).status,"connected")?"bg-green-500":"bg-red-500"}`);set_text(text_9,get$1(device).name);set_text(text_10,get$1(device).status)});append($$anchor3,div_26)});reset(div_25);reset(div_24);var div_32=sibling(div_24,2);var button=child(div_32);button.__click=[createShamirBackup,showSecurityWarning];var button_1=sibling(button,2);button_1.__click=[setupHardwareBackup];var button_2=sibling(button_1,2);button_2.__click=[createAirGappedBackup];var button_3=sibling(button_2,2);button_3.__click=[testRecovery];reset(div_32);reset(div_2);reset(div_1);template_effect($0=>{set_class(div_1,1,`yakkl-card ${className()}`);set_class(div_6,1,`w-3 h-3 rounded-full ${get$1(backupStatus).hasSecureBackup?"bg-green-500":"bg-red-500"}`);set_text(text2,get$1(backupStatus).hasSecureBackup?"Secured":"Not Secured");set_text(text_1,`Last backup: ${$0??""}`);set_text(text_2,strict_equals(get$1(backupStatus).backupMethod,"shamir")?"Shamir Sharing":strict_equals(get$1(backupStatus).backupMethod,"hardware")?"Hardware":strict_equals(get$1(backupStatus).backupMethod,"air_gapped")?"Air-Gapped":"None");set_class(div_12,1,`w-2 h-2 rounded-full ${get$1(backupStatus).integrityCheck?"bg-green-500":"bg-red-500"}`);set_text(text_3,`Integrity ${get$1(backupStatus).integrityCheck?"verified":"failed"}`)},[()=>formatDate(get$1(backupStatus).lastBackupDate)]);append($$anchor2,div_1)};if_block(node,$$render=>{if(!canUseFeature$1("private_key_backup"))$$render(consequent);else $$render(alternate,false)})}var node_4=sibling(node,2);{var consequent_7=$$anchor2=>{var div_33=root_15$1();var div_34=child(div_33);var div_35=sibling(child(div_34),4);var button_4=child(div_35);button_4.__click=[on_click$1,showSecurityWarning];var button_5=sibling(button_4,2);button_5.__click=[on_click_1$1,showSecurityWarning];reset(div_35);reset(div_34);reset(div_33);append($$anchor2,div_33)};if_block(node_4,$$render=>{if(get$1(showSecurityWarning))$$render(consequent_7)})}append($$anchor,fragment);return pop({...legacy_api()})}delegate(["click"]);const getSettings=async()=>({plan:{type:"basic"}});const setSettings=async settings=>true;async function enablePreview2(){const settings=await getSettings();await setSettings({...settings});console.log("Preview2 enabled in development mode")}async function isMigrationNeeded(){const settings=await getSettings();return!settings.preview2Enabled&&!settings.migrationCompleted}delegate(["click"]);_page[FILENAME]="src/routes/preview2/+page.svelte";function handleReceive(_,showReceiveModal){set(showReceiveModal,true)}var root_2=add_locations(from_html(`<div class="text-lg font-semibold tracking-wide"> </div> <div class="text-xs text-gray-500 dark:text-gray-400"> </div>`,1),_page[FILENAME],[[245,8],[246,8]]);var root_3=add_locations(from_html(`<div class="text-lg font-semibold tracking-wide">No account</div>`),_page[FILENAME],[[248,8]]);var root_4=add_locations(from_html(`<div class="text-sm bg-green-100 dark:bg-green-900 dark:text-green-200 text-green-800 px-2 py-1 rounded font-bold"> </div>`),_page[FILENAME],[[254,8]]);var root_5=add_locations(from_html(`<div class="animate-pulse h-8 w-32 bg-white/20 rounded"></div>`),_page[FILENAME],[[265,6]]);var root_6=add_locations(from_html(`<span class="text-3xl font-bold tracking-tight text-zinc-900 dark:text-white group-hover:scale-105 transition-transform duration-200"> </span>`),_page[FILENAME],[[267,6]]);var on_click=(__1,refreshAllData)=>refreshAllData();var root_7=add_locations(from_html(`<button class="text-xs text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 transition-colors p-1 rounded" title="Refresh portfolio"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button>`),_page[FILENAME],[[273,8,[[278,10,[[279,12]]]]]]);var on_click_1=(__2,showSendModal)=>set(showSendModal,true);var on_click_2=(__3,showUpgradeModal)=>set(showUpgradeModal,true);var root_9=add_locations(from_html(`<div class="yakkl-card relative z-10 p-6 text-center border-2 border-dashed border-gray-300 dark:border-gray-600"><div class="text-gray-400 dark:text-gray-500 mb-3"><svg class="w-12 h-12 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg> <h3 class="text-lg font-medium mb-2">Advanced Analytics</h3> <p class="text-sm mb-4">Get detailed portfolio insights, performance metrics, and market analysis.</p> <button class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">Upgrade to Pro</button></div></div>`),_page[FILENAME],[[337,4,[[338,6,[[339,8,[[340,10]]],[342,8],[343,8],[344,8]]]]]]);var on_click_3=(__4,showUpgradeModal)=>set(showUpgradeModal,true);var root_12=add_locations(from_html(`<div class="yakkl-card relative z-10 p-6 text-center border-2 border-dashed border-orange-300 dark:border-orange-600"><div class="text-orange-400 dark:text-orange-500 mb-3"><svg class="w-12 h-12 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg> <h3 class="text-lg font-medium mb-2">Secure Recovery</h3> <p class="text-sm mb-4">Maximum security features including air-gapped signing and zero-knowledge proofs.</p> <button class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">Upgrade to Private</button></div></div>`),_page[FILENAME],[[359,4,[[360,6,[[361,8,[[362,10]]],[364,8],[365,8],[366,8]]]]]]);var on_click_4=(__5,showUpgradeModal)=>set(showUpgradeModal,true);var root_15=add_locations(from_html(`<div class="fixed bottom-12 right-4 z-50"><button class="yakkl-circle-button text-xl opacity-60 hover:opacity-80 transition-opacity" title="AI Assistant (Pro Feature - Upgrade Required)">🤖</button></div>`),_page[FILENAME],[[396,4,[[397,6]]]]);var root=add_locations(from_html(`<!> <!> <!> <!> <div class="max-w-[400px] mx-auto p-5 space-y-5 mt-1 pt-2 relative"><div class="absolute inset-0 flex items-center justify-center pointer-events-none select-none"><img src="/images/logoBullFav128x128.png" class="w-44 h-44 opacity-10 dark:opacity-15" alt="logo"/></div> <div class="flex items-center justify-between relative z-10"><div><div class="text-xs text-gray-400 dark:text-gray-500">Account</div> <!> <a href="/preview2/accounts" class="text-blue-500 dark:text-blue-400 text-xs hover:underline">Switch Account</a></div> <div class="flex flex-col items-end"><!></div></div> <div class="rounded-2xl bg-gradient-to-br from-indigo-100 to-purple-100 dark:from-indigo-700 dark:to-purple-900 shadow-md flex flex-col items-center justify-center p-6 relative z-10 group hover:shadow-lg transition-all duration-300"><span class="uppercase text-xs text-gray-500 dark:text-gray-300 tracking-widest mb-1">Total Portfolio</span> <!> <div class="flex items-center gap-2 mt-2"><span class="text-xs text-gray-400"> </span> <!></div></div> <div class="grid grid-cols-4 gap-3 relative z-10"><button class="yakkl-btn-primary yakkl-btn-send text-sm">Send</button> <button class="yakkl-btn-primary bg-blue-600 hover:bg-blue-700 text-sm">Receive</button> <button> </button> <button> </button></div> <!> <!> <!> <!> <!> <div class="text-center pt-4 pb-2 relative z-10"><div class="inline-flex items-center gap-2 bg-gradient-to-r from-purple-500 to-indigo-600 text-white px-3 py-1 rounded-full text-xs font-medium shadow-md"><svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> Preview 2.0</div></div></div> <!> <!>`,1),_page[FILENAME],[[234,0,[[236,2,[[237,4]]],[241,2,[[242,4,[[243,6],[250,6]]],[252,4]]],[262,2,[[263,4],[269,4,[[270,6]]]]],[287,2,[[288,4],[296,4],[304,4],[313,4]]],[380,2,[[381,4,[[382,6,[[383,8]]]]]]]]]]);function _page($$anchor,$$props){check_target(new.target);push($$props,true,_page);const[$$stores,$$cleanup]=setup_stores();const $isModalOpen=()=>(validate_store(isModalOpen,"isModalOpen"),store_get(isModalOpen,"$isModalOpen",$$stores));const $currentAccount=()=>(validate_store(currentAccount,"currentAccount"),store_get(currentAccount,"$currentAccount",$$stores));const $currentChain=()=>(validate_store(currentChain,"currentChain"),store_get(currentChain,"$currentChain",$$stores));const $tokens=()=>(validate_store(tokens,"tokens"),store_get(tokens,"$tokens",$$stores));const $totalPortfolioValue=()=>(validate_store(totalPortfolioValue,"totalPortfolioValue"),store_get(totalPortfolioValue,"$totalPortfolioValue",$$stores));const $isLoadingTokens=()=>(validate_store(isLoadingTokens,"isLoadingTokens"),store_get(isLoadingTokens,"$isLoadingTokens",$$stores));const $lastTokenUpdate=()=>(validate_store(lastTokenUpdate,"lastTokenUpdate"),store_get(lastTokenUpdate,"$lastTokenUpdate",$$stores));let showSendModal=tag(state(false),"showSendModal");let showSwapModal=tag(state(false),"showSwapModal");let showReceiveModal=tag(state(false),"showReceiveModal");let showBuyModal=tag(state(false),"showBuyModal");let showMigrationBanner=tag(state(false),"showMigrationBanner");let showUpgradeModal=tag(state(false),"showUpgradeModal");let modalOpen=tag(user_derived($isModalOpen),"modalOpen");user_effect(()=>{if(get$1(showUpgradeModal)){modalStore.openModal("upgrade")}else{modalStore.closeModal()}});let account=tag(user_derived($currentAccount),"account");let chain=tag(user_derived($currentChain),"chain");let tokenList=tag(user_derived($tokens),"tokenList");let portfolioValue=tag(user_derived($totalPortfolioValue),"portfolioValue");let loading=tag(user_derived($isLoadingTokens),"loading");let lastUpdate=tag(user_derived($lastTokenUpdate),"lastUpdate");async function refreshAllData(){const{accountStore:accountStore}=await __vitePreload(async()=>{const{accountStore:accountStore2}=await import("../chunks/BO6zr7mn.js").then(n=>n.f);return{accountStore:accountStore2}},true?__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]):void 0,import.meta.url);const{chainStore:chainStore}=await __vitePreload(async()=>{const{chainStore:chainStore2}=await import("../chunks/BO6zr7mn.js").then(n=>n.e);return{chainStore:chainStore2}},true?__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]):void 0,import.meta.url);const{tokenStore:tokenStore2}=await __vitePreload(async()=>{const{tokenStore:tokenStore3}=await Promise.resolve().then(()=>token_store);return{tokenStore:tokenStore3}},true?void 0:void 0,import.meta.url);const{planStore:planStore}=await __vitePreload(async()=>{const{planStore:planStore2}=await import("../chunks/CoXEMRXA.js").then(n=>n.e);return{planStore:planStore2}},true?__vite__mapDeps([10,1,2,3,11,12,13,4,14,15,16,17,18,5,19,6,7,8,20,21,22,23,24]):void 0,import.meta.url);await Promise.all([accountStore.loadAccounts(),chainStore.loadChains(),tokenStore2.refresh(),planStore.loadPlan()])}onMount(async()=>{uiStore.setGlobalLoading(true,"Initializing Preview 2.0...");try{const{getSettings:getSettings2,syncStorageToStore:syncStorageToStore}=await __vitePreload(async()=>{const{getSettings:getSettings3,syncStorageToStore:syncStorageToStore2}=await import("../chunks/Cb2naUpm.js").then(n=>n.dg);return{getSettings:getSettings3,syncStorageToStore:syncStorageToStore2}},true?__vite__mapDeps([21,22,23,8,2,24]):void 0,import.meta.url);const settings=await getSettings2();console.log(...log_if_contains_state("log","Preview2 auth check:",{settings:!!settings,isLocked:settings==null?void 0:settings.isLocked,init:settings==null?void 0:settings.init}));const isAuthenticated=settings&&strict_equals(settings.isLocked,false)&&settings.init;console.log(...log_if_contains_state("log","isAuthenticated:",isAuthenticated));const isPreview2Session=strict_equals(sessionStorage.getItem("preview2-authenticated"),"true");const referrer=document.referrer;const cameFromPreview2=referrer&&referrer.includes("/preview2/")&&!referrer.includes("/preview2/login");if(!isAuthenticated&&!isPreview2Session&&!cameFromPreview2){const{goto:goto}=await __vitePreload(async()=>{const{goto:goto2}=await import("../chunks/CkqS9PXN.js").then(n=>n.n);return{goto:goto2}},true?__vite__mapDeps([27,2,24,8]):void 0,import.meta.url);console.log("Redirecting to login...");return await goto("/preview2/login")}if(isAuthenticated||cameFromPreview2){sessionStorage.setItem("preview2-authenticated","true")}console.log("User authenticated, ensuring stores are synchronized...");await syncStorageToStore();console.log("Preview2: Stores synchronized from persistent storage");const migrationNeeded=await isMigrationNeeded();set(showMigrationBanner,migrationNeeded,true);if(!migrationNeeded){await enablePreview2()}initializeCore().catch(err=>{console.warn(...log_if_contains_state("warn","YAKKL Core initialization failed:",err))});await refreshAllData();if(migrationNeeded){uiStore.showInfo("Welcome to Preview 2.0!","Complete migration to access the new wallet experience")}else{uiStore.showSuccess("Preview 2.0 Ready!","Welcome to the enhanced wallet experience")}}catch(error){console.error(...log_if_contains_state("error","Preview 2.0 initialization failed:",error));uiStore.showError("Initialization Failed","Some features may not work properly. Please refresh the page.");await enablePreview2()}finally{uiStore.setGlobalLoading(false)}});function handleSend(tx){set(showSendModal,false);console.log(...log_if_contains_state("log","Transaction sent:",tx));uiStore.showTransactionPending(tx.hash);setTimeout(()=>{refreshAllData()},2e3)}function handleSwap(tx){set(showSwapModal,false);console.log(...log_if_contains_state("log","Swap requested:",tx));uiStore.showSuccess("Swap Initiated!","Your token swap is being processed");setTimeout(()=>{refreshAllData()},2e3)}function handleBuySell(){if(!canUseFeature$1("buy_crypto")){uiStore.showInfo("Pro Feature Required","Upgrade to Pro to buy crypto with your credit card");return}set(showBuyModal,true)}function handleSwapClick(){if(!canUseFeature$1("swap_tokens")){uiStore.showInfo("Pro Feature Required","Upgrade to Pro to swap tokens with better rates");return}set(showSwapModal,true)}function shortAddr(addr){if(!addr)return"";return`${addr.slice(0,6)}...${addr.slice(-4)}`}function formatCurrency(value){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(value)}function formatTime(date){if(!date)return"Never";return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",hour12:true}).format(date)}function showUpgradePrompt(feature,requiredPlan){set(showUpgradeModal,true)}var fragment=root();var node=first_child(fragment);SendModal(node,{get show(){return get$1(showSendModal)},onClose:()=>set(showSendModal,false),onSend:handleSend,get tokens(){return get$1(tokenList)},get chain(){return get$1(chain)},mode:"send"});var node_1=sibling(node,2);{var consequent=$$anchor2=>{SendModal($$anchor2,{get show(){return get$1(showSwapModal)},onClose:()=>set(showSwapModal,false),onSend:handleSwap,get tokens(){return get$1(tokenList)},get chain(){return get$1(chain)},mode:"swap"})};if_block(node_1,$$render=>{if(canUseFeature$1("swap_tokens"))$$render(consequent)})}var node_2=sibling(node_1,2);Receive(node_2,{get show(){return get$1(showReceiveModal)},set show($$value){set(showReceiveModal,$$value,true)}});var node_3=sibling(node_2,2);BuyModal(node_3,{get show(){return get$1(showBuyModal)},onClose:()=>set(showBuyModal,false)});var div=sibling(node_3,2);var div_1=sibling(child(div),2);var div_2=child(div_1);var node_4=sibling(child(div_2),2);{var consequent_1=$$anchor2=>{var fragment_2=root_2();var div_3=first_child(fragment_2);var text2=child(div_3,true);reset(div_3);var div_4=sibling(div_3,2);var text_1=child(div_4,true);reset(div_4);template_effect($0=>{set_text(text2,get$1(account).ens||get$1(account).username||"");set_text(text_1,$0)},[()=>shortAddr(get$1(account).address)]);append($$anchor2,fragment_2)};var alternate=$$anchor2=>{var div_5=root_3();append($$anchor2,div_5)};if_block(node_4,$$render=>{if(get$1(account))$$render(consequent_1);else $$render(alternate,false)})}next(2);reset(div_2);var div_6=sibling(div_2,2);var node_5=child(div_6);{var consequent_2=$$anchor2=>{var div_7=root_4();var text_2=child(div_7,true);reset(div_7);template_effect(()=>set_text(text_2,get$1(chain).isTestnet?"TESTNET":"LIVE"));append($$anchor2,div_7)};if_block(node_5,$$render=>{if(get$1(chain))$$render(consequent_2)})}reset(div_6);reset(div_1);var div_8=sibling(div_1,2);var node_6=sibling(child(div_8),2);{var consequent_3=$$anchor2=>{var div_9=root_5();append($$anchor2,div_9)};var alternate_1=$$anchor2=>{var span=root_6();var text_3=child(span,true);reset(span);template_effect($0=>set_text(text_3,$0),[()=>formatCurrency(get$1(portfolioValue))]);append($$anchor2,span)};if_block(node_6,$$render=>{if(get$1(loading))$$render(consequent_3);else $$render(alternate_1,false)})}var div_10=sibling(node_6,2);var span_1=child(div_10);var text_4=child(span_1);reset(span_1);var node_7=sibling(span_1,2);{var consequent_4=$$anchor2=>{var button=root_7();button.__click=[on_click,refreshAllData];append($$anchor2,button)};if_block(node_7,$$render=>{if(!get$1(loading))$$render(consequent_4)})}reset(div_10);reset(div_8);var div_11=sibling(div_8,2);var button_1=child(div_11);button_1.__click=[on_click_1,showSendModal];var button_2=sibling(button_1,2);button_2.__click=[handleReceive,showReceiveModal];var button_3=sibling(button_2,2);var event_handler=user_derived(()=>canUseFeature$1("swap_tokens")?handleSwapClick:()=>showUpgradePrompt());button_3.__click=function(...$$args){apply(()=>get$1(event_handler),this,$$args,_page,[306,15])};var text_5=child(button_3,true);reset(button_3);var button_4=sibling(button_3,2);var event_handler_1=user_derived(()=>canUseFeature$1("buy_crypto")?handleBuySell:()=>showUpgradePrompt());button_4.__click=function(...$$args){apply(()=>get$1(event_handler_1),this,$$args,_page,[315,15])};var text_6=child(button_4,true);reset(button_4);reset(div_11);var node_8=sibling(div_11,2);RecentActivity(node_8,{className:"yakkl-card relative z-10"});var node_9=sibling(node_8,2);TokenPortfolio(node_9,{get tokens(){return get$1(tokenList)},get loading(){return get$1(loading)},className:"yakkl-card relative z-10"});var node_10=sibling(node_9,2);{var consequent_5=$$anchor2=>{AdvancedAnalytics($$anchor2,{className:"relative z-10"})};var alternate_2=$$anchor2=>{var div_12=root_9();var div_13=child(div_12);var button_5=sibling(child(div_13),6);button_5.__click=[on_click_2,showUpgradeModal];reset(div_13);reset(div_12);append($$anchor2,div_12)};if_block(node_10,$$render=>{if(canUseFeature$1("advanced_analytics"))$$render(consequent_5);else $$render(alternate_2,false)})}var node_11=sibling(node_10,2);{var consequent_6=$$anchor2=>{SecureRecovery($$anchor2,{className:"relative z-10"})};var alternate_3=($$anchor2,$$elseif)=>{{var consequent_7=$$anchor3=>{var div_14=root_12();var div_15=child(div_14);var button_6=sibling(child(div_15),6);button_6.__click=[on_click_3,showUpgradeModal];reset(div_15);reset(div_14);append($$anchor3,div_14)};if_block($$anchor2,$$render=>{if(canUseFeature$1("advanced_analytics"))$$render(consequent_7)},$$elseif)}};if_block(node_11,$$render=>{if(canUseFeature$1("secure_recovery"))$$render(consequent_6);else $$render(alternate_3,false)})}var node_12=sibling(node_11,2);ModDashboard(node_12,{className:"yakkl-card relative z-10"});next(2);reset(div);var node_13=sibling(div,2);{var consequent_9=$$anchor2=>{var fragment_5=comment();var node_14=first_child(fragment_5);{var consequent_8=$$anchor3=>{AIHelpButton($$anchor3,{className:"fixed bottom-12 right-4"})};var alternate_4=$$anchor3=>{var div_16=root_15();var button_7=child(div_16);button_7.__click=[on_click_4,showUpgradeModal];reset(div_16);append($$anchor3,div_16)};if_block(node_14,$$render=>{if(canUseFeature$1("ai_assistant"))$$render(consequent_8);else $$render(alternate_4,false)})}append($$anchor2,fragment_5)};if_block(node_13,$$render=>{if(!get$1(modalOpen))$$render(consequent_9)})}var node_15=sibling(node_13,2);Upgrade(node_15,{onComplete:()=>{set(showUpgradeModal,false);refreshAllData()},onCancel:()=>set(showUpgradeModal,false),get show(){return get$1(showUpgradeModal)},set show($$value){set(showUpgradeModal,$$value,true)}});template_effect(($0,$1,$2,$3,$4,$5,$6,$7,$8)=>{set_text(text_4,`Last updated: ${$0??""}`);button_1.disabled=$1;button_2.disabled=$2;set_class(button_3,1,`yakkl-btn-primary yakkl-swap text-sm ${$3??""}`);button_3.disabled=!get$1(account);set_attribute(button_3,"title",$4);set_text(text_5,$5);set_class(button_4,1,`yakkl-btn-primary yakkl-btn-buy text-sm ${$6??""}`);button_4.disabled=!get$1(account);set_attribute(button_4,"title",$7);set_text(text_6,$8)},[()=>formatTime(get$1(lastUpdate)),()=>!get$1(account)||!canUseFeature$1("send_tokens"),()=>!get$1(account)||!canUseFeature$1("receive_tokens"),()=>!canUseFeature$1("swap_tokens")?"opacity-75":"",()=>!canUseFeature$1("swap_tokens")?"Upgrade to Pro to unlock token swapping":"Swap tokens",()=>canUseFeature$1("swap_tokens")?"Swap":"🔒 Swap",()=>!canUseFeature$1("buy_crypto")?"opacity-75":"",()=>!canUseFeature$1("buy_crypto")?"Upgrade to Pro to unlock buy/sell features":"Buy and sell crypto",()=>canUseFeature$1("buy_crypto")?"Buy/Sell":"🔒 Buy/Sell"]);append($$anchor,fragment);var $$pop=pop({...legacy_api()});$$cleanup();return $$pop}delegate(["click"]);export{_page as component};
//# sourceMappingURL=69.DouZrxeU.js.map
