{"version":3,"file":"BGcrmAjg.js","sources":["../../../../../../src/lib/managers/ErrorHandler.ts"],"sourcesContent":["import { log } from '$lib/common/logger-wrapper';\n\n// Check if we're in browser environment without using SvelteKit imports\nconst isBrowser = typeof window !== 'undefined';\n\ninterface ExtendedPerformance extends Performance {\n\tmemory?: {\n\t\tusedJSHeapSize: number;\n\t\tjsHeapSizeLimit: number;\n\t\ttotalJSHeapSize: number;\n\t};\n}\n\ninterface GlobalError {\n\tmessage?: string;\n\tsource?: string;\n\tlineno?: number;\n\tcolno?: number;\n\terror?: Error;\n\ttimestamp: string;\n\ttype: 'error' | 'unhandledrejection' | 'event';\n}\n\ninterface MemorySnapshot {\n\ttime: number;\n\tmemory?: number;\n\tnodes: number;\n\teventListeners: number;\n\tlocation: string;\n}\n\ninterface StateSnapshot {\n\ttimestamp: number;\n\troute: string;\n\tactiveModals: Array<{\n\t\tid: string;\n\t\tclass: string;\n\t\tvisible: boolean;\n\t}>;\n\tcomponentStack: string[];\n\teventQueue: string[];\n\tlastActions: Array<{ time: number; action: string }>;\n\tmemoryUsage: any;\n}\n\ninterface ComponentError {\n\tcomponent: string;\n\terror: any;\n\tprops?: any;\n\tstate?: any;\n}\n\nconst MEMORY_THRESHOLDS = {\n\theap: 100 * 1024 * 1024, // 100MB\n\tnodes: 5000, // Max DOM nodes\n\teventListeners: 1000 // Max event listeners\n};\n\nexport class ErrorHandler {\n\tprivate static instance: ErrorHandler | null = null;\n\tprivate memorySnapshots: MemorySnapshot[] = [];\n\tprivate stateSnapshots: StateSnapshot[] = [];\n\tprivate lastActions: Array<{ time: number; action: string }> = [];\n\tprivate lastComponentErrors: ComponentError[] = [];\n\tprivate mountTime: number = Date.now();\n\tprivate lastLocation: string = '';\n\tprivate resourceCheckInterval: number | null = null;\n\tprivate memoryCheckInterval: number | null = null;\n\tprivate isInitialized: boolean = false;\n\tprivate isClosing: boolean = false;\n\tprivate readonly MAX_ACTION_HISTORY = 50;\n\n\tprivate constructor() {\n\t\tif (!isBrowser) return;\n\t\tsetTimeout(() => {\n\t\t\tthis.initialize();\n\t\t}, 0);\n\t}\n\n\tprivate async initialize(): Promise<void> {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tif (this.isInitialized) return;\n\n\t\t\tthis.initializeErrorHandlers();\n\t\t\tthis.initializeUIMonitoring();\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.initializeResourceMonitoring();\n\t\t\t}, 1000);\n\t\t\tthis.initializeStateRecovery();\n\t\t\tthis.checkPreviousError();\n\n\t\t\tthis.isInitialized = true;\n\t\t} catch (error) {\n\t\t\tlog.error('ErrorHandler initialization failed', false, error);\n\t\t}\n\t}\n\n\tpublic static getInstance(): ErrorHandler {\n\t\tif (!ErrorHandler.instance) {\n\t\t\tErrorHandler.instance = new ErrorHandler();\n\t\t}\n\t\treturn ErrorHandler.instance;\n\t}\n\n\thandleError(error: Error): void {\n\t\tif (!isBrowser) return;\n\t\tlog.error('Error handled by ErrorHandler:', false, error);\n\t}\n\n\tprivate initializeErrorHandlers(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tlet lastError: any = null;\n\t\t\tconst performance = window.performance as ExtendedPerformance;\n\n\t\t\tObject.defineProperty(window, 'lastError', {\n\t\t\t\tget: () => lastError,\n\t\t\t\tset: (error) => {\n\t\t\t\t\tlastError = error;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\t'lastFatalError',\n\t\t\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\t\t\terror: error?.toString(),\n\t\t\t\t\t\t\t\tstack: error?.stack,\n\t\t\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\t\tmemory: performance?.memory?.usedJSHeapSize,\n\t\t\t\t\t\t\t\tlastLocation: this.lastLocation,\n\t\t\t\t\t\t\t\tstateSnapshot: this.captureStateSnapshot(),\n\t\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Fail silently\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Track all clicks\n\t\t\tdocument.addEventListener(\n\t\t\t\t'click',\n\t\t\t\t(event) => {\n\t\t\t\t\tconst target = event.target as HTMLElement;\n\t\t\t\t\tconst action = {\n\t\t\t\t\t\ttime: Date.now(),\n\t\t\t\t\t\taction: `Click: ${target.tagName} ${target.className} ${target.id}`\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.lastActions.unshift(action);\n\t\t\t\t\tif (this.lastActions.length > this.MAX_ACTION_HISTORY) {\n\t\t\t\t\t\tthis.lastActions.pop();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Capture state after each click\n\t\t\t\t\tthis.stateSnapshots.push(this.captureStateSnapshot());\n\t\t\t\t\tif (this.stateSnapshots.length > 10) {\n\t\t\t\t\t\tthis.stateSnapshots.shift();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\n\t\t\twindow.onerror = (message, source, lineno, colno, error) => {\n\t\t\t\tconst messageText = message instanceof Event ? message.type : String(message);\n\n\t\t\t\tif (messageText?.includes('ResizeObserver loop')) {\n\t\t\t\t\treturn; // Ignore ResizeObserver errors\n\t\t\t\t}\n\n\t\t\t\tif (!this.isClosing) {\n\t\t\t\t\tconst errorInfo = {\n\t\t\t\t\t\tmessage: messageText,\n\t\t\t\t\t\tsource,\n\t\t\t\t\t\tlineno,\n\t\t\t\t\t\tcolno,\n\t\t\t\t\t\terror,\n\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\ttimeSinceMount: Date.now() - this.mountTime,\n\t\t\t\t\t\tmemoryUsage: performance?.memory?.usedJSHeapSize,\n\t\t\t\t\t\tlastLocation: this.lastLocation,\n\t\t\t\t\t\tstateSnapshots: this.stateSnapshots,\n\t\t\t\t\t\tlastActions: this.lastActions,\n\t\t\t\t\t\tcomponentErrors: this.lastComponentErrors,\n\t\t\t\t\t\tfinalSnapshot: this.captureStateSnapshot()\n\t\t\t\t\t};\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlocalStorage.setItem('lastFatalError', JSON.stringify(errorInfo));\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Ignore storage errors\n\t\t\t\t\t}\n\n\t\t\t\t\tlog.error('Fatal error caught', true, errorInfo);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\twindow.addEventListener('error', (event) => {\n\t\t\t\tconst errorDetails: GlobalError = {\n\t\t\t\t\tmessage: event.message,\n\t\t\t\t\tsource: event.filename,\n\t\t\t\t\tlineno: event.lineno,\n\t\t\t\t\tcolno: event.colno,\n\t\t\t\t\terror: event.error,\n\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\ttype: 'event'\n\t\t\t\t};\n\n\t\t\t\tlog.error('Error Event Caught', true, {\n\t\t\t\t\t...errorDetails,\n\t\t\t\t\tevent: {\n\t\t\t\t\t\ttype: event.type,\n\t\t\t\t\t\ttarget: event.target?.toString(),\n\t\t\t\t\t\ttimeStamp: event.timeStamp\n\t\t\t\t\t},\n\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\tmemorySnapshot: this.getMemorySnapshot(),\n\t\t\t\t\tstateSnapshot: this.captureStateSnapshot(),\n\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t});\n\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\n\t\t\twindow.addEventListener('unhandledrejection', (event) => {\n\t\t\t\tconst errorDetails: GlobalError = {\n\t\t\t\t\tmessage: event.reason?.message || event.reason,\n\t\t\t\t\terror: event.reason instanceof Error ? event.reason : new Error(String(event.reason)),\n\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\ttype: 'unhandledrejection'\n\t\t\t\t};\n\n\t\t\t\tlog.error('Unhandled Promise Rejection', true, {\n\t\t\t\t\t...errorDetails,\n\t\t\t\t\treason: event.reason,\n\t\t\t\t\tpromise: event.promise,\n\t\t\t\t\tstack: event.reason?.stack,\n\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\tmemorySnapshot: this.getMemorySnapshot(),\n\t\t\t\t\tstateSnapshot: this.captureStateSnapshot(),\n\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t});\n\n\t\t\t\tevent.preventDefault();\n\t\t\t});\n\n\t\t\ttry {\n\t\t\t\t// @ts-ignore\n\t\t\t\twindow.addEventListener('beforeunload', (event) => {\n\t\t\t\t\tthis.isClosing = true;\n\t\t\t\t\tconst finalSnapshot = this.captureStateSnapshot();\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\t\t\t'lastStateBeforeClose',\n\t\t\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\t\t\tsnapshot: finalSnapshot,\n\t\t\t\t\t\t\t\tactions: this.lastActions,\n\t\t\t\t\t\t\t\terrors: this.lastComponentErrors,\n\t\t\t\t\t\t\t\ttimestamp: Date.now()\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Ignore storage errors\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} catch (e) {\n\t\t\t\t// Ignore error\n\t\t\t}\n\n\t\t\tdocument.addEventListener('visibilitychange', () => {\n\t\t\t\tconst snapshot = this.captureStateSnapshot();\n\t\t\t\tlog.info('Visibility change', true, {\n\t\t\t\t\tstate: document.visibilityState,\n\t\t\t\t\tsnapshot,\n\t\t\t\t\tlastActions: this.lastActions.slice(0, 10),\n\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Track pathname changes\n\t\t\tlet lastPathname = window.location.pathname;\n\t\t\tconst observer = new MutationObserver(() => {\n\t\t\t\tconst currentPathname = window.location.pathname;\n\t\t\t\tif (lastPathname !== currentPathname) {\n\t\t\t\t\tlog.info('Navigation occurred', true, {\n\t\t\t\t\t\tfrom: lastPathname,\n\t\t\t\t\t\tto: currentPathname,\n\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\tstateSnapshot: this.captureStateSnapshot()\n\t\t\t\t\t});\n\t\t\t\t\tlastPathname = currentPathname;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tobserver.observe(document, {\n\t\t\t\tsubtree: true,\n\t\t\t\tchildList: true\n\t\t\t});\n\t\t} catch (error) {\n\t\t\tlog.error('Failed to initialize error handlers', false, error);\n\t\t}\n\t}\n\n\tprivate initializeUIMonitoring(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\t// Monitor DOM mutations for modal dialogs\n\t\t\tconst modalObserver = new MutationObserver((mutations) => {\n\t\t\t\tmutations.forEach((mutation) => {\n\t\t\t\t\tmutation.addedNodes.forEach((node) => {\n\t\t\t\t\t\tif (node instanceof HTMLElement) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tnode.getAttribute('role') === 'dialog' ||\n\t\t\t\t\t\t\t\tnode.classList.contains('modal') ||\n\t\t\t\t\t\t\t\tnode.getAttribute('aria-modal') === 'true'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tlog.info('Modal dialog opened', true, {\n\t\t\t\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\t\t\tmodalId: node.id,\n\t\t\t\t\t\t\t\t\tmodalClasses: node.className,\n\t\t\t\t\t\t\t\t\tmemorySnapshot: this.getMemorySnapshot(),\n\t\t\t\t\t\t\t\t\tstateSnapshot: this.captureStateSnapshot()\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tmutation.removedNodes.forEach((node) => {\n\t\t\t\t\t\tif (node instanceof HTMLElement) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tnode.getAttribute('role') === 'dialog' ||\n\t\t\t\t\t\t\t\tnode.classList.contains('modal') ||\n\t\t\t\t\t\t\t\tnode.getAttribute('aria-modal') === 'true'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tlog.info('Modal dialog closed', true, {\n\t\t\t\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\t\t\tmodalId: node.id,\n\t\t\t\t\t\t\t\t\tmodalClasses: node.className,\n\t\t\t\t\t\t\t\t\tmemorySnapshot: this.getMemorySnapshot(),\n\t\t\t\t\t\t\t\t\tstateSnapshot: this.captureStateSnapshot()\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tmodalObserver.observe(document.body, {\n\t\t\t\tchildList: true,\n\t\t\t\tsubtree: true,\n\t\t\t\tattributes: true,\n\t\t\t\tattributeFilter: ['class', 'style', 'hidden']\n\t\t\t});\n\n\t\t\t// Monitor Send button\n\t\t\tconst sendButtonObserver = new MutationObserver((mutations) => {\n\t\t\t\tmutations.forEach((mutation) => {\n\t\t\t\t\tif (mutation.type === 'attributes' && mutation.attributeName === 'disabled') {\n\t\t\t\t\t\tconst button = mutation.target as HTMLElement;\n\t\t\t\t\t\tlog.info('Send button state changed', true, {\n\t\t\t\t\t\t\tdisabled: button.hasAttribute('disabled'),\n\t\t\t\t\t\t\ttimestamp: Date.now(),\n\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\tsnapshot: this.captureStateSnapshot(),\n\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Observe the Send button once it's available\n\t\t\tconst observeSendButton = () => {\n\t\t\t\tconst sendButton = document.querySelector('[data-testid=\"send-button\"]');\n\t\t\t\tif (sendButton) {\n\t\t\t\t\tsendButtonObserver.observe(sendButton, {\n\t\t\t\t\t\tattributes: true,\n\t\t\t\t\t\tattributeFilter: ['disabled']\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// Check periodically for the Send button\n\t\t\tconst buttonCheckInterval = setInterval(() => {\n\t\t\t\tobserveSendButton();\n\t\t\t}, 1000);\n\n\t\t\t// Clean up interval when done\n\t\t\tsetTimeout(() => {\n\t\t\t\tclearInterval(buttonCheckInterval);\n\t\t\t}, 10000); // Stop checking after 10 seconds\n\t\t} catch (error) {\n\t\t\tlog.error('Failed to initialize UI monitoring', false, error);\n\t\t}\n\t}\n\n\tprivate initializeResourceMonitoring(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tconst performance = window.performance as ExtendedPerformance;\n\n\t\t\tthis.memoryCheckInterval = window.setInterval(() => {\n\t\t\t\ttry {\n\t\t\t\t\tconst snapshot = this.getMemorySnapshot();\n\t\t\t\t\tthis.memorySnapshots.push(snapshot);\n\n\t\t\t\t\tif (this.memorySnapshots.length > 3) {\n\t\t\t\t\t\tthis.memorySnapshots.shift();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.memorySnapshots.length === 3) {\n\t\t\t\t\t\t// Calculate percentage increase\n\t\t\t\t\t\tconst firstMemory = this.memorySnapshots[0].memory || 0;\n\t\t\t\t\t\tconst lastMemory = this.memorySnapshots[2].memory || 0;\n\t\t\t\t\t\tconst percentageIncrease = ((lastMemory - firstMemory) / firstMemory) * 100;\n\n\t\t\t\t\t\t// Only warn if there's significant growth (more than 20% across samples)\n\t\t\t\t\t\tif (percentageIncrease > 20) {\n\t\t\t\t\t\t\tlog.warn('Significant memory growth detected', true, {\n\t\t\t\t\t\t\t\tsnapshots: this.memorySnapshots,\n\t\t\t\t\t\t\t\tpercentageIncrease: percentageIncrease.toFixed(2) + '%',\n\t\t\t\t\t\t\t\tlocation: window.location.href,\n\t\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (snapshot.memory && snapshot.memory > MEMORY_THRESHOLDS.heap) {\n\t\t\t\t\t\tlog.warn('High memory usage detected', true, {\n\t\t\t\t\t\t\t...snapshot,\n\t\t\t\t\t\t\tthreshold: MEMORY_THRESHOLDS.heap,\n\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (snapshot.nodes > MEMORY_THRESHOLDS.nodes) {\n\t\t\t\t\t\tlog.warn('High DOM node count detected', true, {\n\t\t\t\t\t\t\t...snapshot,\n\t\t\t\t\t\t\tthreshold: MEMORY_THRESHOLDS.nodes,\n\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tif (snapshot.eventListeners > MEMORY_THRESHOLDS.eventListeners) {\n\t\t\t\t\t\tlog.warn('High event listener count detected', true, {\n\t\t\t\t\t\t\t...snapshot,\n\t\t\t\t\t\t\tthreshold: MEMORY_THRESHOLDS.eventListeners,\n\t\t\t\t\t\t\tlastActions: this.lastActions.slice(0, 10)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tlog.error('Memory monitoring error', false, error);\n\t\t\t\t}\n\t\t\t}, 30000); // 30 second interval\n\t\t} catch (error) {\n\t\t\tlog.error('Failed to initialize resource monitoring', false, error);\n\t\t}\n\t}\n\n\tprivate initializeStateRecovery(): void {\n\t\tif (!isBrowser) return;\n\n\t\tconst lastFatalError = localStorage.getItem('lastFatalError');\n\t\tif (lastFatalError) {\n\t\t\ttry {\n\t\t\t\tconst error = JSON.parse(lastFatalError);\n\t\t\t\tlog.error('Recovered from previous crash', true, {\n\t\t\t\t\tpreviousError: error,\n\t\t\t\t\ttimeSince: Date.now() - new Date(error.timestamp).getTime()\n\t\t\t\t});\n\t\t\t\tlocalStorage.removeItem('lastFatalError');\n\t\t\t} catch (e) {\n\t\t\t\t// Handle parse error\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate checkPreviousError(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tconst lastError = localStorage.getItem('lastFatalError');\n\t\t\tconst lastState = localStorage.getItem('lastStateBeforeClose');\n\n\t\t\tif (lastError) {\n\t\t\t\tconst errorData = JSON.parse(lastError);\n\t\t\t\tlog.error('Recovered error from previous session', true, errorData);\n\t\t\t\tlocalStorage.removeItem('lastFatalError');\n\t\t\t}\n\n\t\t\tif (lastState) {\n\t\t\t\tconst stateData = JSON.parse(lastState);\n\t\t\t\tlocalStorage.removeItem('lastStateBeforeClose');\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// Ignore recovery errors\n\t\t}\n\t}\n\n\tprivate getMemorySnapshot(): MemorySnapshot {\n\t\tif (!isBrowser) return { time: Date.now(), nodes: 0, eventListeners: 0, location: '' };\n\n\t\tconst performance = window.performance as ExtendedPerformance;\n\t\treturn {\n\t\t\ttime: Date.now(),\n\t\t\tmemory: performance?.memory?.usedJSHeapSize,\n\t\t\tnodes: document.getElementsByTagName('*').length,\n\t\t\teventListeners: this.getEventListenerCount(),\n\t\t\tlocation: window.location.href\n\t\t};\n\t}\n\n\tprivate captureStateSnapshot(): StateSnapshot {\n\t\tif (!isBrowser)\n\t\t\treturn {\n\t\t\t\ttimestamp: Date.now(),\n\t\t\t\troute: '',\n\t\t\t\tactiveModals: [],\n\t\t\t\tcomponentStack: [],\n\t\t\t\teventQueue: [],\n\t\t\t\tlastActions: [],\n\t\t\t\tmemoryUsage: {}\n\t\t\t};\n\n\t\tconst performance = window.performance as ExtendedPerformance;\n\n\t\treturn {\n\t\t\ttimestamp: Date.now(),\n\t\t\troute: window.location.pathname,\n\t\t\tactiveModals: Array.from(\n\t\t\t\tdocument.querySelectorAll('[role=\"dialog\"], .modal, [aria-modal=\"true\"]')\n\t\t\t).map((el) => ({\n\t\t\t\tid: el.id,\n\t\t\t\tclass: (el as HTMLElement).className,\n\t\t\t\tvisible: (el as HTMLElement).style.display !== 'none'\n\t\t\t})),\n\t\t\tcomponentStack: this.captureComponentStack(),\n\t\t\teventQueue: this.getEventListeners(),\n\t\t\tlastActions: [...this.lastActions],\n\t\t\tmemoryUsage: {\n\t\t\t\tjsHeapSize: performance?.memory?.usedJSHeapSize,\n\t\t\t\ttotalNodes: document.getElementsByTagName('*').length,\n\t\t\t\teventListeners: this.getEventListenerCount()\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate captureComponentStack(): string[] {\n\t\tif (!isBrowser) return [];\n\n\t\tconst stack: string[] = [];\n\t\tlet element = document.activeElement;\n\n\t\twhile (element && element !== document.body) {\n\t\t\tconst componentName =\n\t\t\t\telement.getAttribute('data-component') || element.getAttribute('class') || element.tagName;\n\t\t\tstack.push(componentName);\n\t\t\telement = element.parentElement;\n\t\t}\n\n\t\treturn stack;\n\t}\n\n\tprivate getEventListeners(): string[] {\n\t\tif (!isBrowser) return [];\n\n\t\t// Basic estimation of event types\n\t\tconst elements = document.getElementsByTagName('*');\n\t\tconst listeners: string[] = [];\n\n\t\tfor (const element of elements) {\n\t\t\tconst eventAttributes = Array.from(element.attributes)\n\t\t\t\t.filter((attr) => attr.name.startsWith('on'))\n\t\t\t\t.map((attr) => attr.name);\n\t\t\tlisteners.push(...eventAttributes);\n\t\t}\n\n\t\treturn listeners;\n\t}\n\n\tprivate getEventListenerCount(): number {\n\t\tif (!isBrowser) return 0;\n\n\t\tconst elements = document.getElementsByTagName('*');\n\t\tlet count = 0;\n\t\tfor (const element of elements) {\n\t\t\tcount += Object.keys(element).filter((key) => key.startsWith('on')).length;\n\t\t}\n\t\treturn count;\n\t}\n\n\tpublic isReady(): boolean {\n\t\treturn this.isInitialized;\n\t}\n\n\tpublic destroy(): void {\n\t\tif (!isBrowser) return;\n\n\t\ttry {\n\t\t\tif (this.resourceCheckInterval) {\n\t\t\t\tclearInterval(this.resourceCheckInterval);\n\t\t\t}\n\t\t\tif (this.memoryCheckInterval) {\n\t\t\t\tclearInterval(this.memoryCheckInterval);\n\t\t\t}\n\t\t\tthis.isInitialized = false;\n\t\t} catch (error) {\n\t\t\tlog.error('Error during ErrorHandler cleanup', false, error);\n\t\t}\n\t}\n}\n"],"names":["isBrowser","window","MEMORY_THRESHOLDS","heap","nodes","eventListeners","_ErrorHandler","constructor","__publicField","this","Date","now","setTimeout","initialize","isInitialized","initializeErrorHandlers","initializeUIMonitoring","initializeResourceMonitoring","initializeStateRecovery","checkPreviousError","error","log","getInstance","instance","handleError","lastError","performance","Object","defineProperty","get","set","localStorage","setItem","JSON","stringify","toString","stack","timestamp","toISOString","location","href","memory","_a","usedJSHeapSize","lastLocation","stateSnapshot","captureStateSnapshot","lastActions","slice","e","document","addEventListener","event","target","action","time","tagName","className","id","unshift","length","MAX_ACTION_HISTORY","pop","stateSnapshots","push","shift","onerror","message","source","lineno","colno","messageText","Event","type","String","includes","isClosing","errorInfo","timeSinceMount","mountTime","memoryUsage","componentErrors","lastComponentErrors","finalSnapshot","errorDetails","filename","timeStamp","memorySnapshot","getMemorySnapshot","preventDefault","reason","Error","promise","_b","snapshot","actions","errors","info","state","visibilityState","lastPathname","pathname","observer","MutationObserver","currentPathname","from","to","observe","subtree","childList","modalObserver","mutations","forEach","mutation","addedNodes","node","HTMLElement","getAttribute","classList","contains","modalId","modalClasses","removedNodes","body","attributes","attributeFilter","sendButtonObserver","attributeName","button","disabled","hasAttribute","observeSendButton","sendButton","querySelector","buttonCheckInterval","setInterval","clearInterval","memoryCheckInterval","memorySnapshots","firstMemory","lastMemory","percentageIncrease","warn","snapshots","toFixed","threshold","lastFatalError","getItem","parse","previousError","timeSince","getTime","removeItem","lastState","errorData","stateData","getElementsByTagName","getEventListenerCount","route","activeModals","componentStack","eventQueue","Array","querySelectorAll","map","el","class","visible","style","display","captureComponentStack","getEventListeners","jsHeapSize","totalNodes","element","activeElement","componentName","parentElement","elements","listeners","eventAttributes","filter","attr","name","startsWith","count","keys","key","isReady","destroy","resourceCheckInterval","ErrorHandler"],"mappings":"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"}