{"version":3,"file":"WDN37msH.js","sources":["../../../../../../../../node_modules/.pnpm/vite-plugin-node-polyfills@0.22.0_rollup@4.43.0_vite@6.3.5_@types+node@20.19.1_jiti@1.21.7_terser@5.43.0_yaml@2.7.0_/node_modules/vite-plugin-node-polyfills/shims/process/dist/index.js","../../../../../../../../node_modules/.pnpm/idb@8.0.3/node_modules/idb/build/index.js","../../../../../../../../node_modules/.pnpm/dexie@4.0.11/node_modules/dexie/dist/dexie.js","../../../../../../../../node_modules/.pnpm/dexie@4.0.11/node_modules/dexie/import-wrapper.mjs","../../../../../../src/lib/managers/Logger.ts"],"sourcesContent":["function getDefaultExportFromCjs (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nvar browser = {exports: {}};\n\n// shim for using process in browser\nvar process = browser.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ());\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] };\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\nvar browserExports = browser.exports;\nconst process$1 = /*@__PURE__*/getDefaultExportFromCjs(browserExports);\n\nexport { process$1 as default, process$1 as process };\n//# sourceMappingURL=index.js.map\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst transactionDoneMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    // This mapping exists in reverseTransformCache but doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(this.request);\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nconst advanceMethodProps = ['continue', 'continuePrimaryKey', 'advance'];\nconst methodMap = {};\nconst advanceResults = new WeakMap();\nconst ittrProxiedCursorToOriginalProxy = new WeakMap();\nconst cursorIteratorTraps = {\n    get(target, prop) {\n        if (!advanceMethodProps.includes(prop))\n            return target[prop];\n        let cachedFunc = methodMap[prop];\n        if (!cachedFunc) {\n            cachedFunc = methodMap[prop] = function (...args) {\n                advanceResults.set(this, ittrProxiedCursorToOriginalProxy.get(this)[prop](...args));\n            };\n        }\n        return cachedFunc;\n    },\n};\nasync function* iterate(...args) {\n    // tslint:disable-next-line:no-this-assignment\n    let cursor = this;\n    if (!(cursor instanceof IDBCursor)) {\n        cursor = await cursor.openCursor(...args);\n    }\n    if (!cursor)\n        return;\n    cursor = cursor;\n    const proxiedCursor = new Proxy(cursor, cursorIteratorTraps);\n    ittrProxiedCursorToOriginalProxy.set(proxiedCursor, cursor);\n    // Map this double-proxy back to the original, so other cursor methods work.\n    reverseTransformCache.set(proxiedCursor, unwrap(cursor));\n    while (cursor) {\n        yield proxiedCursor;\n        // If one of the advancing methods was not called, call continue().\n        cursor = await (advanceResults.get(proxiedCursor) || cursor.continue());\n        advanceResults.delete(proxiedCursor);\n    }\n}\nfunction isIteratorProp(target, prop) {\n    return ((prop === Symbol.asyncIterator &&\n        instanceOfAny(target, [IDBIndex, IDBObjectStore, IDBCursor])) ||\n        (prop === 'iterate' && instanceOfAny(target, [IDBIndex, IDBObjectStore])));\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get(target, prop, receiver) {\n        if (isIteratorProp(target, prop))\n            return iterate;\n        return oldTraps.get(target, prop, receiver);\n    },\n    has(target, prop) {\n        return isIteratorProp(target, prop) || oldTraps.has(target, prop);\n    },\n}));\n\nexport { deleteDB, openDB, unwrap, wrap };\n","/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * By David Fahlander, david.fahlander@gmail.com\n *\n * Version 4.0.11, Wed Jan 15 2025\n *\n * https://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\n */\n \n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Dexie = factory());\n})(this, (function () { 'use strict';\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */\n    var extendStatics = function(d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    function __extends(d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n    var __assign = function() {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n    function __spreadArray(to, from, pack) {\n        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n            if (ar || !(i in from)) {\n                if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n                ar[i] = from[i];\n            }\n        }\n        return to.concat(ar || Array.prototype.slice.call(from));\n    }\n\n    var _global = typeof globalThis !== 'undefined' ? globalThis :\n        typeof self !== 'undefined' ? self :\n            typeof window !== 'undefined' ? window :\n                global;\n\n    var keys = Object.keys;\n    var isArray = Array.isArray;\n    if (typeof Promise !== 'undefined' && !_global.Promise) {\n        _global.Promise = Promise;\n    }\n    function extend(obj, extension) {\n        if (typeof extension !== 'object')\n            return obj;\n        keys(extension).forEach(function (key) {\n            obj[key] = extension[key];\n        });\n        return obj;\n    }\n    var getProto = Object.getPrototypeOf;\n    var _hasOwn = {}.hasOwnProperty;\n    function hasOwn(obj, prop) {\n        return _hasOwn.call(obj, prop);\n    }\n    function props(proto, extension) {\n        if (typeof extension === 'function')\n            extension = extension(getProto(proto));\n        (typeof Reflect === \"undefined\" ? keys : Reflect.ownKeys)(extension).forEach(function (key) {\n            setProp(proto, key, extension[key]);\n        });\n    }\n    var defineProperty = Object.defineProperty;\n    function setProp(obj, prop, functionOrGetSet, options) {\n        defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ?\n            { get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true } :\n            { value: functionOrGetSet, configurable: true, writable: true }, options));\n    }\n    function derive(Child) {\n        return {\n            from: function (Parent) {\n                Child.prototype = Object.create(Parent.prototype);\n                setProp(Child.prototype, \"constructor\", Child);\n                return {\n                    extend: props.bind(null, Child.prototype)\n                };\n            }\n        };\n    }\n    var getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n    function getPropertyDescriptor(obj, prop) {\n        var pd = getOwnPropertyDescriptor(obj, prop);\n        var proto;\n        return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n    }\n    var _slice = [].slice;\n    function slice(args, start, end) {\n        return _slice.call(args, start, end);\n    }\n    function override(origFunc, overridedFactory) {\n        return overridedFactory(origFunc);\n    }\n    function assert(b) {\n        if (!b)\n            throw new Error(\"Assertion Failed\");\n    }\n    function asap$1(fn) {\n        if (_global.setImmediate)\n            setImmediate(fn);\n        else\n            setTimeout(fn, 0);\n    }\n    function arrayToObject(array, extractor) {\n        return array.reduce(function (result, item, i) {\n            var nameAndValue = extractor(item, i);\n            if (nameAndValue)\n                result[nameAndValue[0]] = nameAndValue[1];\n            return result;\n        }, {});\n    }\n    function getByKeyPath(obj, keyPath) {\n        if (typeof keyPath === 'string' && hasOwn(obj, keyPath))\n            return obj[keyPath];\n        if (!keyPath)\n            return obj;\n        if (typeof keyPath !== 'string') {\n            var rv = [];\n            for (var i = 0, l = keyPath.length; i < l; ++i) {\n                var val = getByKeyPath(obj, keyPath[i]);\n                rv.push(val);\n            }\n            return rv;\n        }\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var innerObj = obj[keyPath.substr(0, period)];\n            return innerObj == null ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n        }\n        return undefined;\n    }\n    function setByKeyPath(obj, keyPath, value) {\n        if (!obj || keyPath === undefined)\n            return;\n        if ('isFrozen' in Object && Object.isFrozen(obj))\n            return;\n        if (typeof keyPath !== 'string' && 'length' in keyPath) {\n            assert(typeof value !== 'string' && 'length' in value);\n            for (var i = 0, l = keyPath.length; i < l; ++i) {\n                setByKeyPath(obj, keyPath[i], value[i]);\n            }\n        }\n        else {\n            var period = keyPath.indexOf('.');\n            if (period !== -1) {\n                var currentKeyPath = keyPath.substr(0, period);\n                var remainingKeyPath = keyPath.substr(period + 1);\n                if (remainingKeyPath === \"\")\n                    if (value === undefined) {\n                        if (isArray(obj) && !isNaN(parseInt(currentKeyPath)))\n                            obj.splice(currentKeyPath, 1);\n                        else\n                            delete obj[currentKeyPath];\n                    }\n                    else\n                        obj[currentKeyPath] = value;\n                else {\n                    var innerObj = obj[currentKeyPath];\n                    if (!innerObj || !hasOwn(obj, currentKeyPath))\n                        innerObj = (obj[currentKeyPath] = {});\n                    setByKeyPath(innerObj, remainingKeyPath, value);\n                }\n            }\n            else {\n                if (value === undefined) {\n                    if (isArray(obj) && !isNaN(parseInt(keyPath)))\n                        obj.splice(keyPath, 1);\n                    else\n                        delete obj[keyPath];\n                }\n                else\n                    obj[keyPath] = value;\n            }\n        }\n    }\n    function delByKeyPath(obj, keyPath) {\n        if (typeof keyPath === 'string')\n            setByKeyPath(obj, keyPath, undefined);\n        else if ('length' in keyPath)\n            [].map.call(keyPath, function (kp) {\n                setByKeyPath(obj, kp, undefined);\n            });\n    }\n    function shallowClone(obj) {\n        var rv = {};\n        for (var m in obj) {\n            if (hasOwn(obj, m))\n                rv[m] = obj[m];\n        }\n        return rv;\n    }\n    var concat = [].concat;\n    function flatten(a) {\n        return concat.apply([], a);\n    }\n    var intrinsicTypeNames = \"BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey\"\n        .split(',').concat(flatten([8, 16, 32, 64].map(function (num) { return [\"Int\", \"Uint\", \"Float\"].map(function (t) { return t + num + \"Array\"; }); }))).filter(function (t) { return _global[t]; });\n    var intrinsicTypes = new Set(intrinsicTypeNames.map(function (t) { return _global[t]; }));\n    function cloneSimpleObjectTree(o) {\n        var rv = {};\n        for (var k in o)\n            if (hasOwn(o, k)) {\n                var v = o[k];\n                rv[k] = !v || typeof v !== 'object' || intrinsicTypes.has(v.constructor) ? v : cloneSimpleObjectTree(v);\n            }\n        return rv;\n    }\n    function objectIsEmpty(o) {\n        for (var k in o)\n            if (hasOwn(o, k))\n                return false;\n        return true;\n    }\n    var circularRefs = null;\n    function deepClone(any) {\n        circularRefs = new WeakMap();\n        var rv = innerDeepClone(any);\n        circularRefs = null;\n        return rv;\n    }\n    function innerDeepClone(x) {\n        if (!x || typeof x !== 'object')\n            return x;\n        var rv = circularRefs.get(x);\n        if (rv)\n            return rv;\n        if (isArray(x)) {\n            rv = [];\n            circularRefs.set(x, rv);\n            for (var i = 0, l = x.length; i < l; ++i) {\n                rv.push(innerDeepClone(x[i]));\n            }\n        }\n        else if (intrinsicTypes.has(x.constructor)) {\n            rv = x;\n        }\n        else {\n            var proto = getProto(x);\n            rv = proto === Object.prototype ? {} : Object.create(proto);\n            circularRefs.set(x, rv);\n            for (var prop in x) {\n                if (hasOwn(x, prop)) {\n                    rv[prop] = innerDeepClone(x[prop]);\n                }\n            }\n        }\n        return rv;\n    }\n    var toString = {}.toString;\n    function toStringTag(o) {\n        return toString.call(o).slice(8, -1);\n    }\n    var iteratorSymbol = typeof Symbol !== 'undefined' ?\n        Symbol.iterator :\n        '@@iterator';\n    var getIteratorOf = typeof iteratorSymbol === \"symbol\" ? function (x) {\n        var i;\n        return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n    } : function () { return null; };\n    function delArrayItem(a, x) {\n        var i = a.indexOf(x);\n        if (i >= 0)\n            a.splice(i, 1);\n        return i >= 0;\n    }\n    var NO_CHAR_ARRAY = {};\n    function getArrayOf(arrayLike) {\n        var i, a, x, it;\n        if (arguments.length === 1) {\n            if (isArray(arrayLike))\n                return arrayLike.slice();\n            if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string')\n                return [arrayLike];\n            if ((it = getIteratorOf(arrayLike))) {\n                a = [];\n                while ((x = it.next()), !x.done)\n                    a.push(x.value);\n                return a;\n            }\n            if (arrayLike == null)\n                return [arrayLike];\n            i = arrayLike.length;\n            if (typeof i === 'number') {\n                a = new Array(i);\n                while (i--)\n                    a[i] = arrayLike[i];\n                return a;\n            }\n            return [arrayLike];\n        }\n        i = arguments.length;\n        a = new Array(i);\n        while (i--)\n            a[i] = arguments[i];\n        return a;\n    }\n    var isAsyncFunction = typeof Symbol !== 'undefined'\n        ? function (fn) { return fn[Symbol.toStringTag] === 'AsyncFunction'; }\n        : function () { return false; };\n\n    var dexieErrorNames = [\n        'Modify',\n        'Bulk',\n        'OpenFailed',\n        'VersionChange',\n        'Schema',\n        'Upgrade',\n        'InvalidTable',\n        'MissingAPI',\n        'NoSuchDatabase',\n        'InvalidArgument',\n        'SubTransaction',\n        'Unsupported',\n        'Internal',\n        'DatabaseClosed',\n        'PrematureCommit',\n        'ForeignAwait'\n    ];\n    var idbDomErrorNames = [\n        'Unknown',\n        'Constraint',\n        'Data',\n        'TransactionInactive',\n        'ReadOnly',\n        'Version',\n        'NotFound',\n        'InvalidState',\n        'InvalidAccess',\n        'Abort',\n        'Timeout',\n        'QuotaExceeded',\n        'Syntax',\n        'DataClone'\n    ];\n    var errorList = dexieErrorNames.concat(idbDomErrorNames);\n    var defaultTexts = {\n        VersionChanged: \"Database version changed by other database connection\",\n        DatabaseClosed: \"Database has been closed\",\n        Abort: \"Transaction aborted\",\n        TransactionInactive: \"Transaction has already completed or failed\",\n        MissingAPI: \"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb\"\n    };\n    function DexieError(name, msg) {\n        this.name = name;\n        this.message = msg;\n    }\n    derive(DexieError).from(Error).extend({\n        toString: function () { return this.name + \": \" + this.message; }\n    });\n    function getMultiErrorMessage(msg, failures) {\n        return msg + \". Errors: \" + Object.keys(failures)\n            .map(function (key) { return failures[key].toString(); })\n            .filter(function (v, i, s) { return s.indexOf(v) === i; })\n            .join('\\n');\n    }\n    function ModifyError(msg, failures, successCount, failedKeys) {\n        this.failures = failures;\n        this.failedKeys = failedKeys;\n        this.successCount = successCount;\n        this.message = getMultiErrorMessage(msg, failures);\n    }\n    derive(ModifyError).from(DexieError);\n    function BulkError(msg, failures) {\n        this.name = \"BulkError\";\n        this.failures = Object.keys(failures).map(function (pos) { return failures[pos]; });\n        this.failuresByPos = failures;\n        this.message = getMultiErrorMessage(msg, this.failures);\n    }\n    derive(BulkError).from(DexieError);\n    var errnames = errorList.reduce(function (obj, name) { return (obj[name] = name + \"Error\", obj); }, {});\n    var BaseException = DexieError;\n    var exceptions = errorList.reduce(function (obj, name) {\n        var fullName = name + \"Error\";\n        function DexieError(msgOrInner, inner) {\n            this.name = fullName;\n            if (!msgOrInner) {\n                this.message = defaultTexts[name] || fullName;\n                this.inner = null;\n            }\n            else if (typeof msgOrInner === 'string') {\n                this.message = \"\".concat(msgOrInner).concat(!inner ? '' : '\\n ' + inner);\n                this.inner = inner || null;\n            }\n            else if (typeof msgOrInner === 'object') {\n                this.message = \"\".concat(msgOrInner.name, \" \").concat(msgOrInner.message);\n                this.inner = msgOrInner;\n            }\n        }\n        derive(DexieError).from(BaseException);\n        obj[name] = DexieError;\n        return obj;\n    }, {});\n    exceptions.Syntax = SyntaxError;\n    exceptions.Type = TypeError;\n    exceptions.Range = RangeError;\n    var exceptionMap = idbDomErrorNames.reduce(function (obj, name) {\n        obj[name + \"Error\"] = exceptions[name];\n        return obj;\n    }, {});\n    function mapError(domError, message) {\n        if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name])\n            return domError;\n        var rv = new exceptionMap[domError.name](message || domError.message, domError);\n        if (\"stack\" in domError) {\n            setProp(rv, \"stack\", { get: function () {\n                    return this.inner.stack;\n                } });\n        }\n        return rv;\n    }\n    var fullNameExceptions = errorList.reduce(function (obj, name) {\n        if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1)\n            obj[name + \"Error\"] = exceptions[name];\n        return obj;\n    }, {});\n    fullNameExceptions.ModifyError = ModifyError;\n    fullNameExceptions.DexieError = DexieError;\n    fullNameExceptions.BulkError = BulkError;\n\n    function nop() { }\n    function mirror(val) { return val; }\n    function pureFunctionChain(f1, f2) {\n        if (f1 == null || f1 === mirror)\n            return f2;\n        return function (val) {\n            return f2(f1(val));\n        };\n    }\n    function callBoth(on1, on2) {\n        return function () {\n            on1.apply(this, arguments);\n            on2.apply(this, arguments);\n        };\n    }\n    function hookCreatingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            var res = f1.apply(this, arguments);\n            if (res !== undefined)\n                arguments[0] = res;\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = null;\n            this.onerror = null;\n            var res2 = f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n            return res2 !== undefined ? res2 : res;\n        };\n    }\n    function hookDeletingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            f1.apply(this, arguments);\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = this.onerror = null;\n            f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        };\n    }\n    function hookUpdatingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function (modifications) {\n            var res = f1.apply(this, arguments);\n            extend(modifications, res);\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = null;\n            this.onerror = null;\n            var res2 = f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n            return res === undefined ?\n                (res2 === undefined ? undefined : res2) :\n                (extend(res, res2));\n        };\n    }\n    function reverseStoppableEventChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            if (f2.apply(this, arguments) === false)\n                return false;\n            return f1.apply(this, arguments);\n        };\n    }\n    function promisableChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            var res = f1.apply(this, arguments);\n            if (res && typeof res.then === 'function') {\n                var thiz = this, i = arguments.length, args = new Array(i);\n                while (i--)\n                    args[i] = arguments[i];\n                return res.then(function () {\n                    return f2.apply(thiz, args);\n                });\n            }\n            return f2.apply(this, arguments);\n        };\n    }\n\n    var debug = typeof location !== 'undefined' &&\n        /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\n    function setDebug(value, filter) {\n        debug = value;\n    }\n\n    var INTERNAL = {};\n    var ZONE_ECHO_LIMIT = 100, _a$1 = typeof Promise === 'undefined' ?\n        [] :\n        (function () {\n            var globalP = Promise.resolve();\n            if (typeof crypto === 'undefined' || !crypto.subtle)\n                return [globalP, getProto(globalP), globalP];\n            var nativeP = crypto.subtle.digest(\"SHA-512\", new Uint8Array([0]));\n            return [\n                nativeP,\n                getProto(nativeP),\n                globalP\n            ];\n        })(), resolvedNativePromise = _a$1[0], nativePromiseProto = _a$1[1], resolvedGlobalPromise = _a$1[2], nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\n    var NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\n    var patchGlobalPromise = !!resolvedGlobalPromise;\n    function schedulePhysicalTick() {\n        queueMicrotask(physicalTick);\n    }\n    var asap = function (callback, args) {\n        microtickQueue.push([callback, args]);\n        if (needsNewPhysicalTick) {\n            schedulePhysicalTick();\n            needsNewPhysicalTick = false;\n        }\n    };\n    var isOutsideMicroTick = true,\n    needsNewPhysicalTick = true,\n    unhandledErrors = [],\n    rejectingErrors = [],\n    rejectionMapper = mirror;\n    var globalPSD = {\n        id: 'global',\n        global: true,\n        ref: 0,\n        unhandleds: [],\n        onunhandled: nop,\n        pgp: false,\n        env: {},\n        finalize: nop\n    };\n    var PSD = globalPSD;\n    var microtickQueue = [];\n    var numScheduledCalls = 0;\n    var tickFinalizers = [];\n    function DexiePromise(fn) {\n        if (typeof this !== 'object')\n            throw new TypeError('Promises must be constructed via new');\n        this._listeners = [];\n        this._lib = false;\n        var psd = (this._PSD = PSD);\n        if (typeof fn !== 'function') {\n            if (fn !== INTERNAL)\n                throw new TypeError('Not a function');\n            this._state = arguments[1];\n            this._value = arguments[2];\n            if (this._state === false)\n                handleRejection(this, this._value);\n            return;\n        }\n        this._state = null;\n        this._value = null;\n        ++psd.ref;\n        executePromiseTask(this, fn);\n    }\n    var thenProp = {\n        get: function () {\n            var psd = PSD, microTaskId = totalEchoes;\n            function then(onFulfilled, onRejected) {\n                var _this = this;\n                var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n                var cleanup = possibleAwait && !decrementExpectedAwaits();\n                var rv = new DexiePromise(function (resolve, reject) {\n                    propagateToListener(_this, new Listener(nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait, cleanup), nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait, cleanup), resolve, reject, psd));\n                });\n                if (this._consoleTask)\n                    rv._consoleTask = this._consoleTask;\n                return rv;\n            }\n            then.prototype = INTERNAL;\n            return then;\n        },\n        set: function (value) {\n            setProp(this, 'then', value && value.prototype === INTERNAL ?\n                thenProp :\n                {\n                    get: function () {\n                        return value;\n                    },\n                    set: thenProp.set\n                });\n        }\n    };\n    props(DexiePromise.prototype, {\n        then: thenProp,\n        _then: function (onFulfilled, onRejected) {\n            propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));\n        },\n        catch: function (onRejected) {\n            if (arguments.length === 1)\n                return this.then(null, onRejected);\n            var type = arguments[0], handler = arguments[1];\n            return typeof type === 'function' ? this.then(null, function (err) {\n                return err instanceof type ? handler(err) : PromiseReject(err);\n            })\n                : this.then(null, function (err) {\n                    return err && err.name === type ? handler(err) : PromiseReject(err);\n                });\n        },\n        finally: function (onFinally) {\n            return this.then(function (value) {\n                return DexiePromise.resolve(onFinally()).then(function () { return value; });\n            }, function (err) {\n                return DexiePromise.resolve(onFinally()).then(function () { return PromiseReject(err); });\n            });\n        },\n        timeout: function (ms, msg) {\n            var _this = this;\n            return ms < Infinity ?\n                new DexiePromise(function (resolve, reject) {\n                    var handle = setTimeout(function () { return reject(new exceptions.Timeout(msg)); }, ms);\n                    _this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n                }) : this;\n        }\n    });\n    if (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n        setProp(DexiePromise.prototype, Symbol.toStringTag, 'Dexie.Promise');\n    globalPSD.env = snapShot();\n    function Listener(onFulfilled, onRejected, resolve, reject, zone) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n        this.psd = zone;\n    }\n    props(DexiePromise, {\n        all: function () {\n            var values = getArrayOf.apply(null, arguments)\n                .map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve, reject) {\n                if (values.length === 0)\n                    resolve([]);\n                var remaining = values.length;\n                values.forEach(function (a, i) { return DexiePromise.resolve(a).then(function (x) {\n                    values[i] = x;\n                    if (!--remaining)\n                        resolve(values);\n                }, reject); });\n            });\n        },\n        resolve: function (value) {\n            if (value instanceof DexiePromise)\n                return value;\n            if (value && typeof value.then === 'function')\n                return new DexiePromise(function (resolve, reject) {\n                    value.then(resolve, reject);\n                });\n            var rv = new DexiePromise(INTERNAL, true, value);\n            return rv;\n        },\n        reject: PromiseReject,\n        race: function () {\n            var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve, reject) {\n                values.map(function (value) { return DexiePromise.resolve(value).then(resolve, reject); });\n            });\n        },\n        PSD: {\n            get: function () { return PSD; },\n            set: function (value) { return PSD = value; }\n        },\n        totalEchoes: { get: function () { return totalEchoes; } },\n        newPSD: newScope,\n        usePSD: usePSD,\n        scheduler: {\n            get: function () { return asap; },\n            set: function (value) { asap = value; }\n        },\n        rejectionMapper: {\n            get: function () { return rejectionMapper; },\n            set: function (value) { rejectionMapper = value; }\n        },\n        follow: function (fn, zoneProps) {\n            return new DexiePromise(function (resolve, reject) {\n                return newScope(function (resolve, reject) {\n                    var psd = PSD;\n                    psd.unhandleds = [];\n                    psd.onunhandled = reject;\n                    psd.finalize = callBoth(function () {\n                        var _this = this;\n                        run_at_end_of_this_or_next_physical_tick(function () {\n                            _this.unhandleds.length === 0 ? resolve() : reject(_this.unhandleds[0]);\n                        });\n                    }, psd.finalize);\n                    fn();\n                }, zoneProps, resolve, reject);\n            });\n        }\n    });\n    if (NativePromise) {\n        if (NativePromise.allSettled)\n            setProp(DexiePromise, \"allSettled\", function () {\n                var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n                return new DexiePromise(function (resolve) {\n                    if (possiblePromises.length === 0)\n                        resolve([]);\n                    var remaining = possiblePromises.length;\n                    var results = new Array(remaining);\n                    possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return results[i] = { status: \"fulfilled\", value: value }; }, function (reason) { return results[i] = { status: \"rejected\", reason: reason }; })\n                        .then(function () { return --remaining || resolve(results); }); });\n                });\n            });\n        if (NativePromise.any && typeof AggregateError !== 'undefined')\n            setProp(DexiePromise, \"any\", function () {\n                var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n                return new DexiePromise(function (resolve, reject) {\n                    if (possiblePromises.length === 0)\n                        reject(new AggregateError([]));\n                    var remaining = possiblePromises.length;\n                    var failures = new Array(remaining);\n                    possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return resolve(value); }, function (failure) {\n                        failures[i] = failure;\n                        if (!--remaining)\n                            reject(new AggregateError(failures));\n                    }); });\n                });\n            });\n        if (NativePromise.withResolvers)\n            DexiePromise.withResolvers = NativePromise.withResolvers;\n    }\n    function executePromiseTask(promise, fn) {\n        try {\n            fn(function (value) {\n                if (promise._state !== null)\n                    return;\n                if (value === promise)\n                    throw new TypeError('A promise cannot be resolved with itself.');\n                var shouldExecuteTick = promise._lib && beginMicroTickScope();\n                if (value && typeof value.then === 'function') {\n                    executePromiseTask(promise, function (resolve, reject) {\n                        value instanceof DexiePromise ?\n                            value._then(resolve, reject) :\n                            value.then(resolve, reject);\n                    });\n                }\n                else {\n                    promise._state = true;\n                    promise._value = value;\n                    propagateAllListeners(promise);\n                }\n                if (shouldExecuteTick)\n                    endMicroTickScope();\n            }, handleRejection.bind(null, promise));\n        }\n        catch (ex) {\n            handleRejection(promise, ex);\n        }\n    }\n    function handleRejection(promise, reason) {\n        rejectingErrors.push(reason);\n        if (promise._state !== null)\n            return;\n        var shouldExecuteTick = promise._lib && beginMicroTickScope();\n        reason = rejectionMapper(reason);\n        promise._state = false;\n        promise._value = reason;\n        addPossiblyUnhandledError(promise);\n        propagateAllListeners(promise);\n        if (shouldExecuteTick)\n            endMicroTickScope();\n    }\n    function propagateAllListeners(promise) {\n        var listeners = promise._listeners;\n        promise._listeners = [];\n        for (var i = 0, len = listeners.length; i < len; ++i) {\n            propagateToListener(promise, listeners[i]);\n        }\n        var psd = promise._PSD;\n        --psd.ref || psd.finalize();\n        if (numScheduledCalls === 0) {\n            ++numScheduledCalls;\n            asap(function () {\n                if (--numScheduledCalls === 0)\n                    finalizePhysicalTick();\n            }, []);\n        }\n    }\n    function propagateToListener(promise, listener) {\n        if (promise._state === null) {\n            promise._listeners.push(listener);\n            return;\n        }\n        var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n        if (cb === null) {\n            return (promise._state ? listener.resolve : listener.reject)(promise._value);\n        }\n        ++listener.psd.ref;\n        ++numScheduledCalls;\n        asap(callListener, [cb, promise, listener]);\n    }\n    function callListener(cb, promise, listener) {\n        try {\n            var ret, value = promise._value;\n            if (!promise._state && rejectingErrors.length)\n                rejectingErrors = [];\n            ret = debug && promise._consoleTask ? promise._consoleTask.run(function () { return cb(value); }) : cb(value);\n            if (!promise._state && rejectingErrors.indexOf(value) === -1) {\n                markErrorAsHandled(promise);\n            }\n            listener.resolve(ret);\n        }\n        catch (e) {\n            listener.reject(e);\n        }\n        finally {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n            --listener.psd.ref || listener.psd.finalize();\n        }\n    }\n    function physicalTick() {\n        usePSD(globalPSD, function () {\n            beginMicroTickScope() && endMicroTickScope();\n        });\n    }\n    function beginMicroTickScope() {\n        var wasRootExec = isOutsideMicroTick;\n        isOutsideMicroTick = false;\n        needsNewPhysicalTick = false;\n        return wasRootExec;\n    }\n    function endMicroTickScope() {\n        var callbacks, i, l;\n        do {\n            while (microtickQueue.length > 0) {\n                callbacks = microtickQueue;\n                microtickQueue = [];\n                l = callbacks.length;\n                for (i = 0; i < l; ++i) {\n                    var item = callbacks[i];\n                    item[0].apply(null, item[1]);\n                }\n            }\n        } while (microtickQueue.length > 0);\n        isOutsideMicroTick = true;\n        needsNewPhysicalTick = true;\n    }\n    function finalizePhysicalTick() {\n        var unhandledErrs = unhandledErrors;\n        unhandledErrors = [];\n        unhandledErrs.forEach(function (p) {\n            p._PSD.onunhandled.call(null, p._value, p);\n        });\n        var finalizers = tickFinalizers.slice(0);\n        var i = finalizers.length;\n        while (i)\n            finalizers[--i]();\n    }\n    function run_at_end_of_this_or_next_physical_tick(fn) {\n        function finalizer() {\n            fn();\n            tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n        }\n        tickFinalizers.push(finalizer);\n        ++numScheduledCalls;\n        asap(function () {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n        }, []);\n    }\n    function addPossiblyUnhandledError(promise) {\n        if (!unhandledErrors.some(function (p) { return p._value === promise._value; }))\n            unhandledErrors.push(promise);\n    }\n    function markErrorAsHandled(promise) {\n        var i = unhandledErrors.length;\n        while (i)\n            if (unhandledErrors[--i]._value === promise._value) {\n                unhandledErrors.splice(i, 1);\n                return;\n            }\n    }\n    function PromiseReject(reason) {\n        return new DexiePromise(INTERNAL, false, reason);\n    }\n    function wrap(fn, errorCatcher) {\n        var psd = PSD;\n        return function () {\n            var wasRootExec = beginMicroTickScope(), outerScope = PSD;\n            try {\n                switchToZone(psd, true);\n                return fn.apply(this, arguments);\n            }\n            catch (e) {\n                errorCatcher && errorCatcher(e);\n            }\n            finally {\n                switchToZone(outerScope, false);\n                if (wasRootExec)\n                    endMicroTickScope();\n            }\n        };\n    }\n    var task = { awaits: 0, echoes: 0, id: 0 };\n    var taskCounter = 0;\n    var zoneStack = [];\n    var zoneEchoes = 0;\n    var totalEchoes = 0;\n    var zone_id_counter = 0;\n    function newScope(fn, props, a1, a2) {\n        var parent = PSD, psd = Object.create(parent);\n        psd.parent = parent;\n        psd.ref = 0;\n        psd.global = false;\n        psd.id = ++zone_id_counter;\n        globalPSD.env;\n        psd.env = patchGlobalPromise ? {\n            Promise: DexiePromise,\n            PromiseProp: { value: DexiePromise, configurable: true, writable: true },\n            all: DexiePromise.all,\n            race: DexiePromise.race,\n            allSettled: DexiePromise.allSettled,\n            any: DexiePromise.any,\n            resolve: DexiePromise.resolve,\n            reject: DexiePromise.reject,\n        } : {};\n        if (props)\n            extend(psd, props);\n        ++parent.ref;\n        psd.finalize = function () {\n            --this.parent.ref || this.parent.finalize();\n        };\n        var rv = usePSD(psd, fn, a1, a2);\n        if (psd.ref === 0)\n            psd.finalize();\n        return rv;\n    }\n    function incrementExpectedAwaits() {\n        if (!task.id)\n            task.id = ++taskCounter;\n        ++task.awaits;\n        task.echoes += ZONE_ECHO_LIMIT;\n        return task.id;\n    }\n    function decrementExpectedAwaits() {\n        if (!task.awaits)\n            return false;\n        if (--task.awaits === 0)\n            task.id = 0;\n        task.echoes = task.awaits * ZONE_ECHO_LIMIT;\n        return true;\n    }\n    if (('' + nativePromiseThen).indexOf('[native code]') === -1) {\n        incrementExpectedAwaits = decrementExpectedAwaits = nop;\n    }\n    function onPossibleParallellAsync(possiblePromise) {\n        if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n            incrementExpectedAwaits();\n            return possiblePromise.then(function (x) {\n                decrementExpectedAwaits();\n                return x;\n            }, function (e) {\n                decrementExpectedAwaits();\n                return rejection(e);\n            });\n        }\n        return possiblePromise;\n    }\n    function zoneEnterEcho(targetZone) {\n        ++totalEchoes;\n        if (!task.echoes || --task.echoes === 0) {\n            task.echoes = task.awaits = task.id = 0;\n        }\n        zoneStack.push(PSD);\n        switchToZone(targetZone, true);\n    }\n    function zoneLeaveEcho() {\n        var zone = zoneStack[zoneStack.length - 1];\n        zoneStack.pop();\n        switchToZone(zone, false);\n    }\n    function switchToZone(targetZone, bEnteringZone) {\n        var currentZone = PSD;\n        if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (!--zoneEchoes || targetZone !== PSD)) {\n            queueMicrotask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n        }\n        if (targetZone === PSD)\n            return;\n        PSD = targetZone;\n        if (currentZone === globalPSD)\n            globalPSD.env = snapShot();\n        if (patchGlobalPromise) {\n            var GlobalPromise = globalPSD.env.Promise;\n            var targetEnv = targetZone.env;\n            if (currentZone.global || targetZone.global) {\n                Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n                GlobalPromise.all = targetEnv.all;\n                GlobalPromise.race = targetEnv.race;\n                GlobalPromise.resolve = targetEnv.resolve;\n                GlobalPromise.reject = targetEnv.reject;\n                if (targetEnv.allSettled)\n                    GlobalPromise.allSettled = targetEnv.allSettled;\n                if (targetEnv.any)\n                    GlobalPromise.any = targetEnv.any;\n            }\n        }\n    }\n    function snapShot() {\n        var GlobalPromise = _global.Promise;\n        return patchGlobalPromise ? {\n            Promise: GlobalPromise,\n            PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n            all: GlobalPromise.all,\n            race: GlobalPromise.race,\n            allSettled: GlobalPromise.allSettled,\n            any: GlobalPromise.any,\n            resolve: GlobalPromise.resolve,\n            reject: GlobalPromise.reject,\n        } : {};\n    }\n    function usePSD(psd, fn, a1, a2, a3) {\n        var outerScope = PSD;\n        try {\n            switchToZone(psd, true);\n            return fn(a1, a2, a3);\n        }\n        finally {\n            switchToZone(outerScope, false);\n        }\n    }\n    function nativeAwaitCompatibleWrap(fn, zone, possibleAwait, cleanup) {\n        return typeof fn !== 'function' ? fn : function () {\n            var outerZone = PSD;\n            if (possibleAwait)\n                incrementExpectedAwaits();\n            switchToZone(zone, true);\n            try {\n                return fn.apply(this, arguments);\n            }\n            finally {\n                switchToZone(outerZone, false);\n                if (cleanup)\n                    queueMicrotask(decrementExpectedAwaits);\n            }\n        };\n    }\n    function execInGlobalContext(cb) {\n        if (Promise === NativePromise && task.echoes === 0) {\n            if (zoneEchoes === 0) {\n                cb();\n            }\n            else {\n                enqueueNativeMicroTask(cb);\n            }\n        }\n        else {\n            setTimeout(cb, 0);\n        }\n    }\n    var rejection = DexiePromise.reject;\n\n    function tempTransaction(db, mode, storeNames, fn) {\n        if (!db.idbdb || (!db._state.openComplete && (!PSD.letThrough && !db._vip))) {\n            if (db._state.openComplete) {\n                return rejection(new exceptions.DatabaseClosed(db._state.dbOpenError));\n            }\n            if (!db._state.isBeingOpened) {\n                if (!db._state.autoOpen)\n                    return rejection(new exceptions.DatabaseClosed());\n                db.open().catch(nop);\n            }\n            return db._state.dbReadyPromise.then(function () { return tempTransaction(db, mode, storeNames, fn); });\n        }\n        else {\n            var trans = db._createTransaction(mode, storeNames, db._dbSchema);\n            try {\n                trans.create();\n                db._state.PR1398_maxLoop = 3;\n            }\n            catch (ex) {\n                if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                    console.warn('Dexie: Need to reopen db');\n                    db.close({ disableAutoOpen: false });\n                    return db.open().then(function () { return tempTransaction(db, mode, storeNames, fn); });\n                }\n                return rejection(ex);\n            }\n            return trans._promise(mode, function (resolve, reject) {\n                return newScope(function () {\n                    PSD.trans = trans;\n                    return fn(resolve, reject, trans);\n                });\n            }).then(function (result) {\n                if (mode === 'readwrite')\n                    try {\n                        trans.idbtrans.commit();\n                    }\n                    catch (_a) { }\n                return mode === 'readonly' ? result : trans._completion.then(function () { return result; });\n            });\n        }\n    }\n\n    var DEXIE_VERSION = '4.0.11';\n    var maxString = String.fromCharCode(65535);\n    var minKey = -Infinity;\n    var INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\n    var STRING_EXPECTED = \"String expected.\";\n    var connections = [];\n    var DBNAMES_DB = '__dbnames';\n    var READONLY = 'readonly';\n    var READWRITE = 'readwrite';\n\n    function combine(filter1, filter2) {\n        return filter1 ?\n            filter2 ?\n                function () { return filter1.apply(this, arguments) && filter2.apply(this, arguments); } :\n                filter1 :\n            filter2;\n    }\n\n    var AnyRange = {\n        type: 3 ,\n        lower: -Infinity,\n        lowerOpen: false,\n        upper: [[]],\n        upperOpen: false\n    };\n\n    function workaroundForUndefinedPrimKey(keyPath) {\n        return typeof keyPath === \"string\" && !/\\./.test(keyPath)\n            ? function (obj) {\n                if (obj[keyPath] === undefined && (keyPath in obj)) {\n                    obj = deepClone(obj);\n                    delete obj[keyPath];\n                }\n                return obj;\n            }\n            : function (obj) { return obj; };\n    }\n\n    function Entity() {\n        throw exceptions.Type();\n    }\n\n    function cmp(a, b) {\n        try {\n            var ta = type(a);\n            var tb = type(b);\n            if (ta !== tb) {\n                if (ta === 'Array')\n                    return 1;\n                if (tb === 'Array')\n                    return -1;\n                if (ta === 'binary')\n                    return 1;\n                if (tb === 'binary')\n                    return -1;\n                if (ta === 'string')\n                    return 1;\n                if (tb === 'string')\n                    return -1;\n                if (ta === 'Date')\n                    return 1;\n                if (tb !== 'Date')\n                    return NaN;\n                return -1;\n            }\n            switch (ta) {\n                case 'number':\n                case 'Date':\n                case 'string':\n                    return a > b ? 1 : a < b ? -1 : 0;\n                case 'binary': {\n                    return compareUint8Arrays(getUint8Array(a), getUint8Array(b));\n                }\n                case 'Array':\n                    return compareArrays(a, b);\n            }\n        }\n        catch (_a) { }\n        return NaN;\n    }\n    function compareArrays(a, b) {\n        var al = a.length;\n        var bl = b.length;\n        var l = al < bl ? al : bl;\n        for (var i = 0; i < l; ++i) {\n            var res = cmp(a[i], b[i]);\n            if (res !== 0)\n                return res;\n        }\n        return al === bl ? 0 : al < bl ? -1 : 1;\n    }\n    function compareUint8Arrays(a, b) {\n        var al = a.length;\n        var bl = b.length;\n        var l = al < bl ? al : bl;\n        for (var i = 0; i < l; ++i) {\n            if (a[i] !== b[i])\n                return a[i] < b[i] ? -1 : 1;\n        }\n        return al === bl ? 0 : al < bl ? -1 : 1;\n    }\n    function type(x) {\n        var t = typeof x;\n        if (t !== 'object')\n            return t;\n        if (ArrayBuffer.isView(x))\n            return 'binary';\n        var tsTag = toStringTag(x);\n        return tsTag === 'ArrayBuffer' ? 'binary' : tsTag;\n    }\n    function getUint8Array(a) {\n        if (a instanceof Uint8Array)\n            return a;\n        if (ArrayBuffer.isView(a))\n            return new Uint8Array(a.buffer, a.byteOffset, a.byteLength);\n        return new Uint8Array(a);\n    }\n\n    var Table =  (function () {\n        function Table() {\n        }\n        Table.prototype._trans = function (mode, fn, writeLocked) {\n            var trans = this._tx || PSD.trans;\n            var tableName = this.name;\n            var task = debug && typeof console !== 'undefined' && console.createTask && console.createTask(\"Dexie: \".concat(mode === 'readonly' ? 'read' : 'write', \" \").concat(this.name));\n            function checkTableInTransaction(resolve, reject, trans) {\n                if (!trans.schema[tableName])\n                    throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n                return fn(trans.idbtrans, trans);\n            }\n            var wasRootExec = beginMicroTickScope();\n            try {\n                var p = trans && trans.db._novip === this.db._novip ?\n                    trans === PSD.trans ?\n                        trans._promise(mode, checkTableInTransaction, writeLocked) :\n                        newScope(function () { return trans._promise(mode, checkTableInTransaction, writeLocked); }, { trans: trans, transless: PSD.transless || PSD }) :\n                    tempTransaction(this.db, mode, [this.name], checkTableInTransaction);\n                if (task) {\n                    p._consoleTask = task;\n                    p = p.catch(function (err) {\n                        console.trace(err);\n                        return rejection(err);\n                    });\n                }\n                return p;\n            }\n            finally {\n                if (wasRootExec)\n                    endMicroTickScope();\n            }\n        };\n        Table.prototype.get = function (keyOrCrit, cb) {\n            var _this = this;\n            if (keyOrCrit && keyOrCrit.constructor === Object)\n                return this.where(keyOrCrit).first(cb);\n            if (keyOrCrit == null)\n                return rejection(new exceptions.Type(\"Invalid argument to Table.get()\"));\n            return this._trans('readonly', function (trans) {\n                return _this.core.get({ trans: trans, key: keyOrCrit })\n                    .then(function (res) { return _this.hook.reading.fire(res); });\n            }).then(cb);\n        };\n        Table.prototype.where = function (indexOrCrit) {\n            if (typeof indexOrCrit === 'string')\n                return new this.db.WhereClause(this, indexOrCrit);\n            if (isArray(indexOrCrit))\n                return new this.db.WhereClause(this, \"[\".concat(indexOrCrit.join('+'), \"]\"));\n            var keyPaths = keys(indexOrCrit);\n            if (keyPaths.length === 1)\n                return this\n                    .where(keyPaths[0])\n                    .equals(indexOrCrit[keyPaths[0]]);\n            var compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(function (ix) {\n                if (ix.compound &&\n                    keyPaths.every(function (keyPath) { return ix.keyPath.indexOf(keyPath) >= 0; })) {\n                    for (var i = 0; i < keyPaths.length; ++i) {\n                        if (keyPaths.indexOf(ix.keyPath[i]) === -1)\n                            return false;\n                    }\n                    return true;\n                }\n                return false;\n            }).sort(function (a, b) { return a.keyPath.length - b.keyPath.length; })[0];\n            if (compoundIndex && this.db._maxKey !== maxString) {\n                var keyPathsInValidOrder = compoundIndex.keyPath.slice(0, keyPaths.length);\n                return this\n                    .where(keyPathsInValidOrder)\n                    .equals(keyPathsInValidOrder.map(function (kp) { return indexOrCrit[kp]; }));\n            }\n            if (!compoundIndex && debug)\n                console.warn(\"The query \".concat(JSON.stringify(indexOrCrit), \" on \").concat(this.name, \" would benefit from a \") +\n                    \"compound index [\".concat(keyPaths.join('+'), \"]\"));\n            var idxByName = this.schema.idxByName;\n            function equals(a, b) {\n                return cmp(a, b) === 0;\n            }\n            var _a = keyPaths.reduce(function (_a, keyPath) {\n                var prevIndex = _a[0], prevFilterFn = _a[1];\n                var index = idxByName[keyPath];\n                var value = indexOrCrit[keyPath];\n                return [\n                    prevIndex || index,\n                    prevIndex || !index ?\n                        combine(prevFilterFn, index && index.multi ?\n                            function (x) {\n                                var prop = getByKeyPath(x, keyPath);\n                                return isArray(prop) && prop.some(function (item) { return equals(value, item); });\n                            } : function (x) { return equals(value, getByKeyPath(x, keyPath)); })\n                        : prevFilterFn\n                ];\n            }, [null, null]), idx = _a[0], filterFunction = _a[1];\n            return idx ?\n                this.where(idx.name).equals(indexOrCrit[idx.keyPath])\n                    .filter(filterFunction) :\n                compoundIndex ?\n                    this.filter(filterFunction) :\n                    this.where(keyPaths).equals('');\n        };\n        Table.prototype.filter = function (filterFunction) {\n            return this.toCollection().and(filterFunction);\n        };\n        Table.prototype.count = function (thenShortcut) {\n            return this.toCollection().count(thenShortcut);\n        };\n        Table.prototype.offset = function (offset) {\n            return this.toCollection().offset(offset);\n        };\n        Table.prototype.limit = function (numRows) {\n            return this.toCollection().limit(numRows);\n        };\n        Table.prototype.each = function (callback) {\n            return this.toCollection().each(callback);\n        };\n        Table.prototype.toArray = function (thenShortcut) {\n            return this.toCollection().toArray(thenShortcut);\n        };\n        Table.prototype.toCollection = function () {\n            return new this.db.Collection(new this.db.WhereClause(this));\n        };\n        Table.prototype.orderBy = function (index) {\n            return new this.db.Collection(new this.db.WhereClause(this, isArray(index) ?\n                \"[\".concat(index.join('+'), \"]\") :\n                index));\n        };\n        Table.prototype.reverse = function () {\n            return this.toCollection().reverse();\n        };\n        Table.prototype.mapToClass = function (constructor) {\n            var _a = this, db = _a.db, tableName = _a.name;\n            this.schema.mappedClass = constructor;\n            if (constructor.prototype instanceof Entity) {\n                constructor =  (function (_super) {\n                    __extends(class_1, _super);\n                    function class_1() {\n                        return _super !== null && _super.apply(this, arguments) || this;\n                    }\n                    Object.defineProperty(class_1.prototype, \"db\", {\n                        get: function () { return db; },\n                        enumerable: false,\n                        configurable: true\n                    });\n                    class_1.prototype.table = function () { return tableName; };\n                    return class_1;\n                }(constructor));\n            }\n            var inheritedProps = new Set();\n            for (var proto = constructor.prototype; proto; proto = getProto(proto)) {\n                Object.getOwnPropertyNames(proto).forEach(function (propName) { return inheritedProps.add(propName); });\n            }\n            var readHook = function (obj) {\n                if (!obj)\n                    return obj;\n                var res = Object.create(constructor.prototype);\n                for (var m in obj)\n                    if (!inheritedProps.has(m))\n                        try {\n                            res[m] = obj[m];\n                        }\n                        catch (_) { }\n                return res;\n            };\n            if (this.schema.readHook) {\n                this.hook.reading.unsubscribe(this.schema.readHook);\n            }\n            this.schema.readHook = readHook;\n            this.hook(\"reading\", readHook);\n            return constructor;\n        };\n        Table.prototype.defineClass = function () {\n            function Class(content) {\n                extend(this, content);\n            }\n            return this.mapToClass(Class);\n        };\n        Table.prototype.add = function (obj, key) {\n            var _this = this;\n            var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            var objToAdd = obj;\n            if (keyPath && auto) {\n                objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n            }\n            return this._trans('readwrite', function (trans) {\n                return _this.core.mutate({ trans: trans, type: 'add', keys: key != null ? [key] : null, values: [objToAdd] });\n            }).then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n                .then(function (lastResult) {\n                if (keyPath) {\n                    try {\n                        setByKeyPath(obj, keyPath, lastResult);\n                    }\n                    catch (_) { }\n                }\n                return lastResult;\n            });\n        };\n        Table.prototype.update = function (keyOrObject, modifications) {\n            if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n                var key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n                if (key === undefined)\n                    return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"));\n                return this.where(\":id\").equals(key).modify(modifications);\n            }\n            else {\n                return this.where(\":id\").equals(keyOrObject).modify(modifications);\n            }\n        };\n        Table.prototype.put = function (obj, key) {\n            var _this = this;\n            var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            var objToAdd = obj;\n            if (keyPath && auto) {\n                objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n            }\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'put', values: [objToAdd], keys: key != null ? [key] : null }); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n                .then(function (lastResult) {\n                if (keyPath) {\n                    try {\n                        setByKeyPath(obj, keyPath, lastResult);\n                    }\n                    catch (_) { }\n                }\n                return lastResult;\n            });\n        };\n        Table.prototype.delete = function (key) {\n            var _this = this;\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'delete', keys: [key] }); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; });\n        };\n        Table.prototype.clear = function () {\n            var _this = this;\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'deleteRange', range: AnyRange }); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; });\n        };\n        Table.prototype.bulkGet = function (keys) {\n            var _this = this;\n            return this._trans('readonly', function (trans) {\n                return _this.core.getMany({\n                    keys: keys,\n                    trans: trans\n                }).then(function (result) { return result.map(function (res) { return _this.hook.reading.fire(res); }); });\n            });\n        };\n        Table.prototype.bulkAdd = function (objects, keysOrOptions, options) {\n            var _this = this;\n            var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n            options = options || (keys ? undefined : keysOrOptions);\n            var wantResults = options ? options.allKeys : undefined;\n            return this._trans('readwrite', function (trans) {\n                var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n                if (keyPath && keys)\n                    throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n                if (keys && keys.length !== objects.length)\n                    throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                var numObjects = objects.length;\n                var objectsToAdd = keyPath && auto ?\n                    objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                    objects;\n                return _this.core.mutate({ trans: trans, type: 'add', keys: keys, values: objectsToAdd, wantResults: wantResults })\n                    .then(function (_a) {\n                    var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                    var result = wantResults ? results : lastResult;\n                    if (numFailures === 0)\n                        return result;\n                    throw new BulkError(\"\".concat(_this.name, \".bulkAdd(): \").concat(numFailures, \" of \").concat(numObjects, \" operations failed\"), failures);\n                });\n            });\n        };\n        Table.prototype.bulkPut = function (objects, keysOrOptions, options) {\n            var _this = this;\n            var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n            options = options || (keys ? undefined : keysOrOptions);\n            var wantResults = options ? options.allKeys : undefined;\n            return this._trans('readwrite', function (trans) {\n                var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n                if (keyPath && keys)\n                    throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n                if (keys && keys.length !== objects.length)\n                    throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                var numObjects = objects.length;\n                var objectsToPut = keyPath && auto ?\n                    objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                    objects;\n                return _this.core.mutate({ trans: trans, type: 'put', keys: keys, values: objectsToPut, wantResults: wantResults })\n                    .then(function (_a) {\n                    var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                    var result = wantResults ? results : lastResult;\n                    if (numFailures === 0)\n                        return result;\n                    throw new BulkError(\"\".concat(_this.name, \".bulkPut(): \").concat(numFailures, \" of \").concat(numObjects, \" operations failed\"), failures);\n                });\n            });\n        };\n        Table.prototype.bulkUpdate = function (keysAndChanges) {\n            var _this = this;\n            var coreTable = this.core;\n            var keys = keysAndChanges.map(function (entry) { return entry.key; });\n            var changeSpecs = keysAndChanges.map(function (entry) { return entry.changes; });\n            var offsetMap = [];\n            return this._trans('readwrite', function (trans) {\n                return coreTable.getMany({ trans: trans, keys: keys, cache: 'clone' }).then(function (objs) {\n                    var resultKeys = [];\n                    var resultObjs = [];\n                    keysAndChanges.forEach(function (_a, idx) {\n                        var key = _a.key, changes = _a.changes;\n                        var obj = objs[idx];\n                        if (obj) {\n                            for (var _i = 0, _b = Object.keys(changes); _i < _b.length; _i++) {\n                                var keyPath = _b[_i];\n                                var value = changes[keyPath];\n                                if (keyPath === _this.schema.primKey.keyPath) {\n                                    if (cmp(value, key) !== 0) {\n                                        throw new exceptions.Constraint(\"Cannot update primary key in bulkUpdate()\");\n                                    }\n                                }\n                                else {\n                                    setByKeyPath(obj, keyPath, value);\n                                }\n                            }\n                            offsetMap.push(idx);\n                            resultKeys.push(key);\n                            resultObjs.push(obj);\n                        }\n                    });\n                    var numEntries = resultKeys.length;\n                    return coreTable\n                        .mutate({\n                        trans: trans,\n                        type: 'put',\n                        keys: resultKeys,\n                        values: resultObjs,\n                        updates: {\n                            keys: keys,\n                            changeSpecs: changeSpecs\n                        }\n                    })\n                        .then(function (_a) {\n                        var numFailures = _a.numFailures, failures = _a.failures;\n                        if (numFailures === 0)\n                            return numEntries;\n                        for (var _i = 0, _b = Object.keys(failures); _i < _b.length; _i++) {\n                            var offset = _b[_i];\n                            var mappedOffset = offsetMap[Number(offset)];\n                            if (mappedOffset != null) {\n                                var failure = failures[offset];\n                                delete failures[offset];\n                                failures[mappedOffset] = failure;\n                            }\n                        }\n                        throw new BulkError(\"\".concat(_this.name, \".bulkUpdate(): \").concat(numFailures, \" of \").concat(numEntries, \" operations failed\"), failures);\n                    });\n                });\n            });\n        };\n        Table.prototype.bulkDelete = function (keys) {\n            var _this = this;\n            var numKeys = keys.length;\n            return this._trans('readwrite', function (trans) {\n                return _this.core.mutate({ trans: trans, type: 'delete', keys: keys });\n            }).then(function (_a) {\n                var numFailures = _a.numFailures, lastResult = _a.lastResult, failures = _a.failures;\n                if (numFailures === 0)\n                    return lastResult;\n                throw new BulkError(\"\".concat(_this.name, \".bulkDelete(): \").concat(numFailures, \" of \").concat(numKeys, \" operations failed\"), failures);\n            });\n        };\n        return Table;\n    }());\n\n    function Events(ctx) {\n        var evs = {};\n        var rv = function (eventName, subscriber) {\n            if (subscriber) {\n                var i = arguments.length, args = new Array(i - 1);\n                while (--i)\n                    args[i - 1] = arguments[i];\n                evs[eventName].subscribe.apply(null, args);\n                return ctx;\n            }\n            else if (typeof (eventName) === 'string') {\n                return evs[eventName];\n            }\n        };\n        rv.addEventType = add;\n        for (var i = 1, l = arguments.length; i < l; ++i) {\n            add(arguments[i]);\n        }\n        return rv;\n        function add(eventName, chainFunction, defaultFunction) {\n            if (typeof eventName === 'object')\n                return addConfiguredEvents(eventName);\n            if (!chainFunction)\n                chainFunction = reverseStoppableEventChain;\n            if (!defaultFunction)\n                defaultFunction = nop;\n            var context = {\n                subscribers: [],\n                fire: defaultFunction,\n                subscribe: function (cb) {\n                    if (context.subscribers.indexOf(cb) === -1) {\n                        context.subscribers.push(cb);\n                        context.fire = chainFunction(context.fire, cb);\n                    }\n                },\n                unsubscribe: function (cb) {\n                    context.subscribers = context.subscribers.filter(function (fn) { return fn !== cb; });\n                    context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n                }\n            };\n            evs[eventName] = rv[eventName] = context;\n            return context;\n        }\n        function addConfiguredEvents(cfg) {\n            keys(cfg).forEach(function (eventName) {\n                var args = cfg[eventName];\n                if (isArray(args)) {\n                    add(eventName, cfg[eventName][0], cfg[eventName][1]);\n                }\n                else if (args === 'asap') {\n                    var context = add(eventName, mirror, function fire() {\n                        var i = arguments.length, args = new Array(i);\n                        while (i--)\n                            args[i] = arguments[i];\n                        context.subscribers.forEach(function (fn) {\n                            asap$1(function fireEvent() {\n                                fn.apply(null, args);\n                            });\n                        });\n                    });\n                }\n                else\n                    throw new exceptions.InvalidArgument(\"Invalid event config\");\n            });\n        }\n    }\n\n    function makeClassConstructor(prototype, constructor) {\n        derive(constructor).from({ prototype: prototype });\n        return constructor;\n    }\n\n    function createTableConstructor(db) {\n        return makeClassConstructor(Table.prototype, function Table(name, tableSchema, trans) {\n            this.db = db;\n            this._tx = trans;\n            this.name = name;\n            this.schema = tableSchema;\n            this.hook = db._allTables[name] ? db._allTables[name].hook : Events(null, {\n                \"creating\": [hookCreatingChain, nop],\n                \"reading\": [pureFunctionChain, mirror],\n                \"updating\": [hookUpdatingChain, nop],\n                \"deleting\": [hookDeletingChain, nop]\n            });\n        });\n    }\n\n    function isPlainKeyRange(ctx, ignoreLimitFilter) {\n        return !(ctx.filter || ctx.algorithm || ctx.or) &&\n            (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n    }\n    function addFilter(ctx, fn) {\n        ctx.filter = combine(ctx.filter, fn);\n    }\n    function addReplayFilter(ctx, factory, isLimitFilter) {\n        var curr = ctx.replayFilter;\n        ctx.replayFilter = curr ? function () { return combine(curr(), factory()); } : factory;\n        ctx.justLimit = isLimitFilter && !curr;\n    }\n    function addMatchFilter(ctx, fn) {\n        ctx.isMatch = combine(ctx.isMatch, fn);\n    }\n    function getIndexOrStore(ctx, coreSchema) {\n        if (ctx.isPrimKey)\n            return coreSchema.primaryKey;\n        var index = coreSchema.getIndexByKeyPath(ctx.index);\n        if (!index)\n            throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + coreSchema.name + \" is not indexed\");\n        return index;\n    }\n    function openCursor(ctx, coreTable, trans) {\n        var index = getIndexOrStore(ctx, coreTable.schema);\n        return coreTable.openCursor({\n            trans: trans,\n            values: !ctx.keysOnly,\n            reverse: ctx.dir === 'prev',\n            unique: !!ctx.unique,\n            query: {\n                index: index,\n                range: ctx.range\n            }\n        });\n    }\n    function iter(ctx, fn, coreTrans, coreTable) {\n        var filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n        if (!ctx.or) {\n            return iterate(openCursor(ctx, coreTable, coreTrans), combine(ctx.algorithm, filter), fn, !ctx.keysOnly && ctx.valueMapper);\n        }\n        else {\n            var set_1 = {};\n            var union = function (item, cursor, advance) {\n                if (!filter || filter(cursor, advance, function (result) { return cursor.stop(result); }, function (err) { return cursor.fail(err); })) {\n                    var primaryKey = cursor.primaryKey;\n                    var key = '' + primaryKey;\n                    if (key === '[object ArrayBuffer]')\n                        key = '' + new Uint8Array(primaryKey);\n                    if (!hasOwn(set_1, key)) {\n                        set_1[key] = true;\n                        fn(item, cursor, advance);\n                    }\n                }\n            };\n            return Promise.all([\n                ctx.or._iterate(union, coreTrans),\n                iterate(openCursor(ctx, coreTable, coreTrans), ctx.algorithm, union, !ctx.keysOnly && ctx.valueMapper)\n            ]);\n        }\n    }\n    function iterate(cursorPromise, filter, fn, valueMapper) {\n        var mappedFn = valueMapper ? function (x, c, a) { return fn(valueMapper(x), c, a); } : fn;\n        var wrappedFn = wrap(mappedFn);\n        return cursorPromise.then(function (cursor) {\n            if (cursor) {\n                return cursor.start(function () {\n                    var c = function () { return cursor.continue(); };\n                    if (!filter || filter(cursor, function (advancer) { return c = advancer; }, function (val) { cursor.stop(val); c = nop; }, function (e) { cursor.fail(e); c = nop; }))\n                        wrappedFn(cursor.value, cursor, function (advancer) { return c = advancer; });\n                    c();\n                });\n            }\n        });\n    }\n\n    var PropModification =  (function () {\n        function PropModification(spec) {\n            this[\"@@propmod\"] = spec;\n        }\n        PropModification.prototype.execute = function (value) {\n            var _a;\n            var spec = this[\"@@propmod\"];\n            if (spec.add !== undefined) {\n                var term = spec.add;\n                if (isArray(term)) {\n                    return __spreadArray(__spreadArray([], (isArray(value) ? value : []), true), term, true).sort();\n                }\n                if (typeof term === 'number')\n                    return (Number(value) || 0) + term;\n                if (typeof term === 'bigint') {\n                    try {\n                        return BigInt(value) + term;\n                    }\n                    catch (_b) {\n                        return BigInt(0) + term;\n                    }\n                }\n                throw new TypeError(\"Invalid term \".concat(term));\n            }\n            if (spec.remove !== undefined) {\n                var subtrahend_1 = spec.remove;\n                if (isArray(subtrahend_1)) {\n                    return isArray(value) ? value.filter(function (item) { return !subtrahend_1.includes(item); }).sort() : [];\n                }\n                if (typeof subtrahend_1 === 'number')\n                    return Number(value) - subtrahend_1;\n                if (typeof subtrahend_1 === 'bigint') {\n                    try {\n                        return BigInt(value) - subtrahend_1;\n                    }\n                    catch (_c) {\n                        return BigInt(0) - subtrahend_1;\n                    }\n                }\n                throw new TypeError(\"Invalid subtrahend \".concat(subtrahend_1));\n            }\n            var prefixToReplace = (_a = spec.replacePrefix) === null || _a === void 0 ? void 0 : _a[0];\n            if (prefixToReplace && typeof value === 'string' && value.startsWith(prefixToReplace)) {\n                return spec.replacePrefix[1] + value.substring(prefixToReplace.length);\n            }\n            return value;\n        };\n        return PropModification;\n    }());\n\n    var Collection =  (function () {\n        function Collection() {\n        }\n        Collection.prototype._read = function (fn, cb) {\n            var ctx = this._ctx;\n            return ctx.error ?\n                ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n                ctx.table._trans('readonly', fn).then(cb);\n        };\n        Collection.prototype._write = function (fn) {\n            var ctx = this._ctx;\n            return ctx.error ?\n                ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n                ctx.table._trans('readwrite', fn, \"locked\");\n        };\n        Collection.prototype._addAlgorithm = function (fn) {\n            var ctx = this._ctx;\n            ctx.algorithm = combine(ctx.algorithm, fn);\n        };\n        Collection.prototype._iterate = function (fn, coreTrans) {\n            return iter(this._ctx, fn, coreTrans, this._ctx.table.core);\n        };\n        Collection.prototype.clone = function (props) {\n            var rv = Object.create(this.constructor.prototype), ctx = Object.create(this._ctx);\n            if (props)\n                extend(ctx, props);\n            rv._ctx = ctx;\n            return rv;\n        };\n        Collection.prototype.raw = function () {\n            this._ctx.valueMapper = null;\n            return this;\n        };\n        Collection.prototype.each = function (fn) {\n            var ctx = this._ctx;\n            return this._read(function (trans) { return iter(ctx, fn, trans, ctx.table.core); });\n        };\n        Collection.prototype.count = function (cb) {\n            var _this = this;\n            return this._read(function (trans) {\n                var ctx = _this._ctx;\n                var coreTable = ctx.table.core;\n                if (isPlainKeyRange(ctx, true)) {\n                    return coreTable.count({\n                        trans: trans,\n                        query: {\n                            index: getIndexOrStore(ctx, coreTable.schema),\n                            range: ctx.range\n                        }\n                    }).then(function (count) { return Math.min(count, ctx.limit); });\n                }\n                else {\n                    var count = 0;\n                    return iter(ctx, function () { ++count; return false; }, trans, coreTable)\n                        .then(function () { return count; });\n                }\n            }).then(cb);\n        };\n        Collection.prototype.sortBy = function (keyPath, cb) {\n            var parts = keyPath.split('.').reverse(), lastPart = parts[0], lastIndex = parts.length - 1;\n            function getval(obj, i) {\n                if (i)\n                    return getval(obj[parts[i]], i - 1);\n                return obj[lastPart];\n            }\n            var order = this._ctx.dir === \"next\" ? 1 : -1;\n            function sorter(a, b) {\n                var aVal = getval(a, lastIndex), bVal = getval(b, lastIndex);\n                return cmp(aVal, bVal) * order;\n            }\n            return this.toArray(function (a) {\n                return a.sort(sorter);\n            }).then(cb);\n        };\n        Collection.prototype.toArray = function (cb) {\n            var _this = this;\n            return this._read(function (trans) {\n                var ctx = _this._ctx;\n                if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                    var valueMapper_1 = ctx.valueMapper;\n                    var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                    return ctx.table.core.query({\n                        trans: trans,\n                        limit: ctx.limit,\n                        values: true,\n                        query: {\n                            index: index,\n                            range: ctx.range\n                        }\n                    }).then(function (_a) {\n                        var result = _a.result;\n                        return valueMapper_1 ? result.map(valueMapper_1) : result;\n                    });\n                }\n                else {\n                    var a_1 = [];\n                    return iter(ctx, function (item) { return a_1.push(item); }, trans, ctx.table.core).then(function () { return a_1; });\n                }\n            }, cb);\n        };\n        Collection.prototype.offset = function (offset) {\n            var ctx = this._ctx;\n            if (offset <= 0)\n                return this;\n            ctx.offset += offset;\n            if (isPlainKeyRange(ctx)) {\n                addReplayFilter(ctx, function () {\n                    var offsetLeft = offset;\n                    return function (cursor, advance) {\n                        if (offsetLeft === 0)\n                            return true;\n                        if (offsetLeft === 1) {\n                            --offsetLeft;\n                            return false;\n                        }\n                        advance(function () {\n                            cursor.advance(offsetLeft);\n                            offsetLeft = 0;\n                        });\n                        return false;\n                    };\n                });\n            }\n            else {\n                addReplayFilter(ctx, function () {\n                    var offsetLeft = offset;\n                    return function () { return (--offsetLeft < 0); };\n                });\n            }\n            return this;\n        };\n        Collection.prototype.limit = function (numRows) {\n            this._ctx.limit = Math.min(this._ctx.limit, numRows);\n            addReplayFilter(this._ctx, function () {\n                var rowsLeft = numRows;\n                return function (cursor, advance, resolve) {\n                    if (--rowsLeft <= 0)\n                        advance(resolve);\n                    return rowsLeft >= 0;\n                };\n            }, true);\n            return this;\n        };\n        Collection.prototype.until = function (filterFunction, bIncludeStopEntry) {\n            addFilter(this._ctx, function (cursor, advance, resolve) {\n                if (filterFunction(cursor.value)) {\n                    advance(resolve);\n                    return bIncludeStopEntry;\n                }\n                else {\n                    return true;\n                }\n            });\n            return this;\n        };\n        Collection.prototype.first = function (cb) {\n            return this.limit(1).toArray(function (a) { return a[0]; }).then(cb);\n        };\n        Collection.prototype.last = function (cb) {\n            return this.reverse().first(cb);\n        };\n        Collection.prototype.filter = function (filterFunction) {\n            addFilter(this._ctx, function (cursor) {\n                return filterFunction(cursor.value);\n            });\n            addMatchFilter(this._ctx, filterFunction);\n            return this;\n        };\n        Collection.prototype.and = function (filter) {\n            return this.filter(filter);\n        };\n        Collection.prototype.or = function (indexName) {\n            return new this.db.WhereClause(this._ctx.table, indexName, this);\n        };\n        Collection.prototype.reverse = function () {\n            this._ctx.dir = (this._ctx.dir === \"prev\" ? \"next\" : \"prev\");\n            if (this._ondirectionchange)\n                this._ondirectionchange(this._ctx.dir);\n            return this;\n        };\n        Collection.prototype.desc = function () {\n            return this.reverse();\n        };\n        Collection.prototype.eachKey = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            return this.each(function (val, cursor) { cb(cursor.key, cursor); });\n        };\n        Collection.prototype.eachUniqueKey = function (cb) {\n            this._ctx.unique = \"unique\";\n            return this.eachKey(cb);\n        };\n        Collection.prototype.eachPrimaryKey = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            return this.each(function (val, cursor) { cb(cursor.primaryKey, cursor); });\n        };\n        Collection.prototype.keys = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            var a = [];\n            return this.each(function (item, cursor) {\n                a.push(cursor.key);\n            }).then(function () {\n                return a;\n            }).then(cb);\n        };\n        Collection.prototype.primaryKeys = function (cb) {\n            var ctx = this._ctx;\n            if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                return this._read(function (trans) {\n                    var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                    return ctx.table.core.query({\n                        trans: trans,\n                        values: false,\n                        limit: ctx.limit,\n                        query: {\n                            index: index,\n                            range: ctx.range\n                        }\n                    });\n                }).then(function (_a) {\n                    var result = _a.result;\n                    return result;\n                }).then(cb);\n            }\n            ctx.keysOnly = !ctx.isMatch;\n            var a = [];\n            return this.each(function (item, cursor) {\n                a.push(cursor.primaryKey);\n            }).then(function () {\n                return a;\n            }).then(cb);\n        };\n        Collection.prototype.uniqueKeys = function (cb) {\n            this._ctx.unique = \"unique\";\n            return this.keys(cb);\n        };\n        Collection.prototype.firstKey = function (cb) {\n            return this.limit(1).keys(function (a) { return a[0]; }).then(cb);\n        };\n        Collection.prototype.lastKey = function (cb) {\n            return this.reverse().firstKey(cb);\n        };\n        Collection.prototype.distinct = function () {\n            var ctx = this._ctx, idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n            if (!idx || !idx.multi)\n                return this;\n            var set = {};\n            addFilter(this._ctx, function (cursor) {\n                var strKey = cursor.primaryKey.toString();\n                var found = hasOwn(set, strKey);\n                set[strKey] = true;\n                return !found;\n            });\n            return this;\n        };\n        Collection.prototype.modify = function (changes) {\n            var _this = this;\n            var ctx = this._ctx;\n            return this._write(function (trans) {\n                var modifyer;\n                if (typeof changes === 'function') {\n                    modifyer = changes;\n                }\n                else {\n                    var keyPaths = keys(changes);\n                    var numKeys = keyPaths.length;\n                    modifyer = function (item) {\n                        var anythingModified = false;\n                        for (var i = 0; i < numKeys; ++i) {\n                            var keyPath = keyPaths[i];\n                            var val = changes[keyPath];\n                            var origVal = getByKeyPath(item, keyPath);\n                            if (val instanceof PropModification) {\n                                setByKeyPath(item, keyPath, val.execute(origVal));\n                                anythingModified = true;\n                            }\n                            else if (origVal !== val) {\n                                setByKeyPath(item, keyPath, val);\n                                anythingModified = true;\n                            }\n                        }\n                        return anythingModified;\n                    };\n                }\n                var coreTable = ctx.table.core;\n                var _a = coreTable.schema.primaryKey, outbound = _a.outbound, extractKey = _a.extractKey;\n                var limit = 200;\n                var modifyChunkSize = _this.db._options.modifyChunkSize;\n                if (modifyChunkSize) {\n                    if (typeof modifyChunkSize == 'object') {\n                        limit = modifyChunkSize[coreTable.name] || modifyChunkSize['*'] || 200;\n                    }\n                    else {\n                        limit = modifyChunkSize;\n                    }\n                }\n                var totalFailures = [];\n                var successCount = 0;\n                var failedKeys = [];\n                var applyMutateResult = function (expectedCount, res) {\n                    var failures = res.failures, numFailures = res.numFailures;\n                    successCount += expectedCount - numFailures;\n                    for (var _i = 0, _a = keys(failures); _i < _a.length; _i++) {\n                        var pos = _a[_i];\n                        totalFailures.push(failures[pos]);\n                    }\n                };\n                return _this.clone().primaryKeys().then(function (keys) {\n                    var criteria = isPlainKeyRange(ctx) &&\n                        ctx.limit === Infinity &&\n                        (typeof changes !== 'function' || changes === deleteCallback) && {\n                        index: ctx.index,\n                        range: ctx.range\n                    };\n                    var nextChunk = function (offset) {\n                        var count = Math.min(limit, keys.length - offset);\n                        return coreTable.getMany({\n                            trans: trans,\n                            keys: keys.slice(offset, offset + count),\n                            cache: \"immutable\"\n                        }).then(function (values) {\n                            var addValues = [];\n                            var putValues = [];\n                            var putKeys = outbound ? [] : null;\n                            var deleteKeys = [];\n                            for (var i = 0; i < count; ++i) {\n                                var origValue = values[i];\n                                var ctx_1 = {\n                                    value: deepClone(origValue),\n                                    primKey: keys[offset + i]\n                                };\n                                if (modifyer.call(ctx_1, ctx_1.value, ctx_1) !== false) {\n                                    if (ctx_1.value == null) {\n                                        deleteKeys.push(keys[offset + i]);\n                                    }\n                                    else if (!outbound && cmp(extractKey(origValue), extractKey(ctx_1.value)) !== 0) {\n                                        deleteKeys.push(keys[offset + i]);\n                                        addValues.push(ctx_1.value);\n                                    }\n                                    else {\n                                        putValues.push(ctx_1.value);\n                                        if (outbound)\n                                            putKeys.push(keys[offset + i]);\n                                    }\n                                }\n                            }\n                            return Promise.resolve(addValues.length > 0 &&\n                                coreTable.mutate({ trans: trans, type: 'add', values: addValues })\n                                    .then(function (res) {\n                                    for (var pos in res.failures) {\n                                        deleteKeys.splice(parseInt(pos), 1);\n                                    }\n                                    applyMutateResult(addValues.length, res);\n                                })).then(function () { return (putValues.length > 0 || (criteria && typeof changes === 'object')) &&\n                                coreTable.mutate({\n                                    trans: trans,\n                                    type: 'put',\n                                    keys: putKeys,\n                                    values: putValues,\n                                    criteria: criteria,\n                                    changeSpec: typeof changes !== 'function'\n                                        && changes,\n                                    isAdditionalChunk: offset > 0\n                                }).then(function (res) { return applyMutateResult(putValues.length, res); }); }).then(function () { return (deleteKeys.length > 0 || (criteria && changes === deleteCallback)) &&\n                                coreTable.mutate({\n                                    trans: trans,\n                                    type: 'delete',\n                                    keys: deleteKeys,\n                                    criteria: criteria,\n                                    isAdditionalChunk: offset > 0\n                                }).then(function (res) { return applyMutateResult(deleteKeys.length, res); }); }).then(function () {\n                                return keys.length > offset + count && nextChunk(offset + limit);\n                            });\n                        });\n                    };\n                    return nextChunk(0).then(function () {\n                        if (totalFailures.length > 0)\n                            throw new ModifyError(\"Error modifying one or more objects\", totalFailures, successCount, failedKeys);\n                        return keys.length;\n                    });\n                });\n            });\n        };\n        Collection.prototype.delete = function () {\n            var ctx = this._ctx, range = ctx.range;\n            if (isPlainKeyRange(ctx) &&\n                (ctx.isPrimKey || range.type === 3 ))\n             {\n                return this._write(function (trans) {\n                    var primaryKey = ctx.table.core.schema.primaryKey;\n                    var coreRange = range;\n                    return ctx.table.core.count({ trans: trans, query: { index: primaryKey, range: coreRange } }).then(function (count) {\n                        return ctx.table.core.mutate({ trans: trans, type: 'deleteRange', range: coreRange })\n                            .then(function (_a) {\n                            var failures = _a.failures; _a.lastResult; _a.results; var numFailures = _a.numFailures;\n                            if (numFailures)\n                                throw new ModifyError(\"Could not delete some values\", Object.keys(failures).map(function (pos) { return failures[pos]; }), count - numFailures);\n                            return count - numFailures;\n                        });\n                    });\n                });\n            }\n            return this.modify(deleteCallback);\n        };\n        return Collection;\n    }());\n    var deleteCallback = function (value, ctx) { return ctx.value = null; };\n\n    function createCollectionConstructor(db) {\n        return makeClassConstructor(Collection.prototype, function Collection(whereClause, keyRangeGenerator) {\n            this.db = db;\n            var keyRange = AnyRange, error = null;\n            if (keyRangeGenerator)\n                try {\n                    keyRange = keyRangeGenerator();\n                }\n                catch (ex) {\n                    error = ex;\n                }\n            var whereCtx = whereClause._ctx;\n            var table = whereCtx.table;\n            var readingHook = table.hook.reading.fire;\n            this._ctx = {\n                table: table,\n                index: whereCtx.index,\n                isPrimKey: (!whereCtx.index || (table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name)),\n                range: keyRange,\n                keysOnly: false,\n                dir: \"next\",\n                unique: \"\",\n                algorithm: null,\n                filter: null,\n                replayFilter: null,\n                justLimit: true,\n                isMatch: null,\n                offset: 0,\n                limit: Infinity,\n                error: error,\n                or: whereCtx.or,\n                valueMapper: readingHook !== mirror ? readingHook : null\n            };\n        });\n    }\n\n    function simpleCompare(a, b) {\n        return a < b ? -1 : a === b ? 0 : 1;\n    }\n    function simpleCompareReverse(a, b) {\n        return a > b ? -1 : a === b ? 0 : 1;\n    }\n\n    function fail(collectionOrWhereClause, err, T) {\n        var collection = collectionOrWhereClause instanceof WhereClause ?\n            new collectionOrWhereClause.Collection(collectionOrWhereClause) :\n            collectionOrWhereClause;\n        collection._ctx.error = T ? new T(err) : new TypeError(err);\n        return collection;\n    }\n    function emptyCollection(whereClause) {\n        return new whereClause.Collection(whereClause, function () { return rangeEqual(\"\"); }).limit(0);\n    }\n    function upperFactory(dir) {\n        return dir === \"next\" ?\n            function (s) { return s.toUpperCase(); } :\n            function (s) { return s.toLowerCase(); };\n    }\n    function lowerFactory(dir) {\n        return dir === \"next\" ?\n            function (s) { return s.toLowerCase(); } :\n            function (s) { return s.toUpperCase(); };\n    }\n    function nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n        var length = Math.min(key.length, lowerNeedle.length);\n        var llp = -1;\n        for (var i = 0; i < length; ++i) {\n            var lwrKeyChar = lowerKey[i];\n            if (lwrKeyChar !== lowerNeedle[i]) {\n                if (cmp(key[i], upperNeedle[i]) < 0)\n                    return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n                if (cmp(key[i], lowerNeedle[i]) < 0)\n                    return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n                if (llp >= 0)\n                    return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n                return null;\n            }\n            if (cmp(key[i], lwrKeyChar) < 0)\n                llp = i;\n        }\n        if (length < lowerNeedle.length && dir === \"next\")\n            return key + upperNeedle.substr(key.length);\n        if (length < key.length && dir === \"prev\")\n            return key.substr(0, upperNeedle.length);\n        return (llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1));\n    }\n    function addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n        var upper, lower, compare, upperNeedles, lowerNeedles, direction, nextKeySuffix, needlesLen = needles.length;\n        if (!needles.every(function (s) { return typeof s === 'string'; })) {\n            return fail(whereClause, STRING_EXPECTED);\n        }\n        function initDirection(dir) {\n            upper = upperFactory(dir);\n            lower = lowerFactory(dir);\n            compare = (dir === \"next\" ? simpleCompare : simpleCompareReverse);\n            var needleBounds = needles.map(function (needle) {\n                return { lower: lower(needle), upper: upper(needle) };\n            }).sort(function (a, b) {\n                return compare(a.lower, b.lower);\n            });\n            upperNeedles = needleBounds.map(function (nb) { return nb.upper; });\n            lowerNeedles = needleBounds.map(function (nb) { return nb.lower; });\n            direction = dir;\n            nextKeySuffix = (dir === \"next\" ? \"\" : suffix);\n        }\n        initDirection(\"next\");\n        var c = new whereClause.Collection(whereClause, function () { return createRange(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix); });\n        c._ondirectionchange = function (direction) {\n            initDirection(direction);\n        };\n        var firstPossibleNeedle = 0;\n        c._addAlgorithm(function (cursor, advance, resolve) {\n            var key = cursor.key;\n            if (typeof key !== 'string')\n                return false;\n            var lowerKey = lower(key);\n            if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n                return true;\n            }\n            else {\n                var lowestPossibleCasing = null;\n                for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n                    var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n                    if (casing === null && lowestPossibleCasing === null)\n                        firstPossibleNeedle = i + 1;\n                    else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                        lowestPossibleCasing = casing;\n                    }\n                }\n                if (lowestPossibleCasing !== null) {\n                    advance(function () { cursor.continue(lowestPossibleCasing + nextKeySuffix); });\n                }\n                else {\n                    advance(resolve);\n                }\n                return false;\n            }\n        });\n        return c;\n    }\n    function createRange(lower, upper, lowerOpen, upperOpen) {\n        return {\n            type: 2 ,\n            lower: lower,\n            upper: upper,\n            lowerOpen: lowerOpen,\n            upperOpen: upperOpen\n        };\n    }\n    function rangeEqual(value) {\n        return {\n            type: 1 ,\n            lower: value,\n            upper: value\n        };\n    }\n\n    var WhereClause =  (function () {\n        function WhereClause() {\n        }\n        Object.defineProperty(WhereClause.prototype, \"Collection\", {\n            get: function () {\n                return this._ctx.table.db.Collection;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        WhereClause.prototype.between = function (lower, upper, includeLower, includeUpper) {\n            includeLower = includeLower !== false;\n            includeUpper = includeUpper === true;\n            try {\n                if ((this._cmp(lower, upper) > 0) ||\n                    (this._cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)))\n                    return emptyCollection(this);\n                return new this.Collection(this, function () { return createRange(lower, upper, !includeLower, !includeUpper); });\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n        };\n        WhereClause.prototype.equals = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return rangeEqual(value); });\n        };\n        WhereClause.prototype.above = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(value, undefined, true); });\n        };\n        WhereClause.prototype.aboveOrEqual = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(value, undefined, false); });\n        };\n        WhereClause.prototype.below = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(undefined, value, false, true); });\n        };\n        WhereClause.prototype.belowOrEqual = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(undefined, value); });\n        };\n        WhereClause.prototype.startsWith = function (str) {\n            if (typeof str !== 'string')\n                return fail(this, STRING_EXPECTED);\n            return this.between(str, str + maxString, true, true);\n        };\n        WhereClause.prototype.startsWithIgnoreCase = function (str) {\n            if (str === \"\")\n                return this.startsWith(str);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return x.indexOf(a[0]) === 0; }, [str], maxString);\n        };\n        WhereClause.prototype.equalsIgnoreCase = function (str) {\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return x === a[0]; }, [str], \"\");\n        };\n        WhereClause.prototype.anyOfIgnoreCase = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return emptyCollection(this);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return a.indexOf(x) !== -1; }, set, \"\");\n        };\n        WhereClause.prototype.startsWithAnyOfIgnoreCase = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return emptyCollection(this);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return a.some(function (n) { return x.indexOf(n) === 0; }); }, set, maxString);\n        };\n        WhereClause.prototype.anyOf = function () {\n            var _this = this;\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            var compare = this._cmp;\n            try {\n                set.sort(compare);\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            if (set.length === 0)\n                return emptyCollection(this);\n            var c = new this.Collection(this, function () { return createRange(set[0], set[set.length - 1]); });\n            c._ondirectionchange = function (direction) {\n                compare = (direction === \"next\" ?\n                    _this._ascending :\n                    _this._descending);\n                set.sort(compare);\n            };\n            var i = 0;\n            c._addAlgorithm(function (cursor, advance, resolve) {\n                var key = cursor.key;\n                while (compare(key, set[i]) > 0) {\n                    ++i;\n                    if (i === set.length) {\n                        advance(resolve);\n                        return false;\n                    }\n                }\n                if (compare(key, set[i]) === 0) {\n                    return true;\n                }\n                else {\n                    advance(function () { cursor.continue(set[i]); });\n                    return false;\n                }\n            });\n            return c;\n        };\n        WhereClause.prototype.notEqual = function (value) {\n            return this.inAnyRange([[minKey, value], [value, this.db._maxKey]], { includeLowers: false, includeUppers: false });\n        };\n        WhereClause.prototype.noneOf = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return new this.Collection(this);\n            try {\n                set.sort(this._ascending);\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            var ranges = set.reduce(function (res, val) { return res ?\n                res.concat([[res[res.length - 1][1], val]]) :\n                [[minKey, val]]; }, null);\n            ranges.push([set[set.length - 1], this.db._maxKey]);\n            return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n        };\n        WhereClause.prototype.inAnyRange = function (ranges, options) {\n            var _this = this;\n            var cmp = this._cmp, ascending = this._ascending, descending = this._descending, min = this._min, max = this._max;\n            if (ranges.length === 0)\n                return emptyCollection(this);\n            if (!ranges.every(function (range) {\n                return range[0] !== undefined &&\n                    range[1] !== undefined &&\n                    ascending(range[0], range[1]) <= 0;\n            })) {\n                return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n            }\n            var includeLowers = !options || options.includeLowers !== false;\n            var includeUppers = options && options.includeUppers === true;\n            function addRange(ranges, newRange) {\n                var i = 0, l = ranges.length;\n                for (; i < l; ++i) {\n                    var range = ranges[i];\n                    if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n                        range[0] = min(range[0], newRange[0]);\n                        range[1] = max(range[1], newRange[1]);\n                        break;\n                    }\n                }\n                if (i === l)\n                    ranges.push(newRange);\n                return ranges;\n            }\n            var sortDirection = ascending;\n            function rangeSorter(a, b) { return sortDirection(a[0], b[0]); }\n            var set;\n            try {\n                set = ranges.reduce(addRange, []);\n                set.sort(rangeSorter);\n            }\n            catch (ex) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            var rangePos = 0;\n            var keyIsBeyondCurrentEntry = includeUppers ?\n                function (key) { return ascending(key, set[rangePos][1]) > 0; } :\n                function (key) { return ascending(key, set[rangePos][1]) >= 0; };\n            var keyIsBeforeCurrentEntry = includeLowers ?\n                function (key) { return descending(key, set[rangePos][0]) > 0; } :\n                function (key) { return descending(key, set[rangePos][0]) >= 0; };\n            function keyWithinCurrentRange(key) {\n                return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n            }\n            var checkKey = keyIsBeyondCurrentEntry;\n            var c = new this.Collection(this, function () { return createRange(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers); });\n            c._ondirectionchange = function (direction) {\n                if (direction === \"next\") {\n                    checkKey = keyIsBeyondCurrentEntry;\n                    sortDirection = ascending;\n                }\n                else {\n                    checkKey = keyIsBeforeCurrentEntry;\n                    sortDirection = descending;\n                }\n                set.sort(rangeSorter);\n            };\n            c._addAlgorithm(function (cursor, advance, resolve) {\n                var key = cursor.key;\n                while (checkKey(key)) {\n                    ++rangePos;\n                    if (rangePos === set.length) {\n                        advance(resolve);\n                        return false;\n                    }\n                }\n                if (keyWithinCurrentRange(key)) {\n                    return true;\n                }\n                else if (_this._cmp(key, set[rangePos][1]) === 0 || _this._cmp(key, set[rangePos][0]) === 0) {\n                    return false;\n                }\n                else {\n                    advance(function () {\n                        if (sortDirection === ascending)\n                            cursor.continue(set[rangePos][0]);\n                        else\n                            cursor.continue(set[rangePos][1]);\n                    });\n                    return false;\n                }\n            });\n            return c;\n        };\n        WhereClause.prototype.startsWithAnyOf = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (!set.every(function (s) { return typeof s === 'string'; })) {\n                return fail(this, \"startsWithAnyOf() only works with strings\");\n            }\n            if (set.length === 0)\n                return emptyCollection(this);\n            return this.inAnyRange(set.map(function (str) { return [str, str + maxString]; }));\n        };\n        return WhereClause;\n    }());\n\n    function createWhereClauseConstructor(db) {\n        return makeClassConstructor(WhereClause.prototype, function WhereClause(table, index, orCollection) {\n            this.db = db;\n            this._ctx = {\n                table: table,\n                index: index === \":id\" ? null : index,\n                or: orCollection\n            };\n            this._cmp = this._ascending = cmp;\n            this._descending = function (a, b) { return cmp(b, a); };\n            this._max = function (a, b) { return cmp(a, b) > 0 ? a : b; };\n            this._min = function (a, b) { return cmp(a, b) < 0 ? a : b; };\n            this._IDBKeyRange = db._deps.IDBKeyRange;\n            if (!this._IDBKeyRange)\n                throw new exceptions.MissingAPI();\n        });\n    }\n\n    function eventRejectHandler(reject) {\n        return wrap(function (event) {\n            preventDefault(event);\n            reject(event.target.error);\n            return false;\n        });\n    }\n    function preventDefault(event) {\n        if (event.stopPropagation)\n            event.stopPropagation();\n        if (event.preventDefault)\n            event.preventDefault();\n    }\n\n    var DEXIE_STORAGE_MUTATED_EVENT_NAME = 'storagemutated';\n    var STORAGE_MUTATED_DOM_EVENT_NAME = 'x-storagemutated-1';\n    var globalEvents = Events(null, DEXIE_STORAGE_MUTATED_EVENT_NAME);\n\n    var Transaction =  (function () {\n        function Transaction() {\n        }\n        Transaction.prototype._lock = function () {\n            assert(!PSD.global);\n            ++this._reculock;\n            if (this._reculock === 1 && !PSD.global)\n                PSD.lockOwnerFor = this;\n            return this;\n        };\n        Transaction.prototype._unlock = function () {\n            assert(!PSD.global);\n            if (--this._reculock === 0) {\n                if (!PSD.global)\n                    PSD.lockOwnerFor = null;\n                while (this._blockedFuncs.length > 0 && !this._locked()) {\n                    var fnAndPSD = this._blockedFuncs.shift();\n                    try {\n                        usePSD(fnAndPSD[1], fnAndPSD[0]);\n                    }\n                    catch (e) { }\n                }\n            }\n            return this;\n        };\n        Transaction.prototype._locked = function () {\n            return this._reculock && PSD.lockOwnerFor !== this;\n        };\n        Transaction.prototype.create = function (idbtrans) {\n            var _this = this;\n            if (!this.mode)\n                return this;\n            var idbdb = this.db.idbdb;\n            var dbOpenError = this.db._state.dbOpenError;\n            assert(!this.idbtrans);\n            if (!idbtrans && !idbdb) {\n                switch (dbOpenError && dbOpenError.name) {\n                    case \"DatabaseClosedError\":\n                        throw new exceptions.DatabaseClosed(dbOpenError);\n                    case \"MissingAPIError\":\n                        throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n                    default:\n                        throw new exceptions.OpenFailed(dbOpenError);\n                }\n            }\n            if (!this.active)\n                throw new exceptions.TransactionInactive();\n            assert(this._completion._state === null);\n            idbtrans = this.idbtrans = idbtrans ||\n                (this.db.core\n                    ? this.db.core.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })\n                    : idbdb.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability }));\n            idbtrans.onerror = wrap(function (ev) {\n                preventDefault(ev);\n                _this._reject(idbtrans.error);\n            });\n            idbtrans.onabort = wrap(function (ev) {\n                preventDefault(ev);\n                _this.active && _this._reject(new exceptions.Abort(idbtrans.error));\n                _this.active = false;\n                _this.on(\"abort\").fire(ev);\n            });\n            idbtrans.oncomplete = wrap(function () {\n                _this.active = false;\n                _this._resolve();\n                if ('mutatedParts' in idbtrans) {\n                    globalEvents.storagemutated.fire(idbtrans[\"mutatedParts\"]);\n                }\n            });\n            return this;\n        };\n        Transaction.prototype._promise = function (mode, fn, bWriteLock) {\n            var _this = this;\n            if (mode === 'readwrite' && this.mode !== 'readwrite')\n                return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n            if (!this.active)\n                return rejection(new exceptions.TransactionInactive());\n            if (this._locked()) {\n                return new DexiePromise(function (resolve, reject) {\n                    _this._blockedFuncs.push([function () {\n                            _this._promise(mode, fn, bWriteLock).then(resolve, reject);\n                        }, PSD]);\n                });\n            }\n            else if (bWriteLock) {\n                return newScope(function () {\n                    var p = new DexiePromise(function (resolve, reject) {\n                        _this._lock();\n                        var rv = fn(resolve, reject, _this);\n                        if (rv && rv.then)\n                            rv.then(resolve, reject);\n                    });\n                    p.finally(function () { return _this._unlock(); });\n                    p._lib = true;\n                    return p;\n                });\n            }\n            else {\n                var p = new DexiePromise(function (resolve, reject) {\n                    var rv = fn(resolve, reject, _this);\n                    if (rv && rv.then)\n                        rv.then(resolve, reject);\n                });\n                p._lib = true;\n                return p;\n            }\n        };\n        Transaction.prototype._root = function () {\n            return this.parent ? this.parent._root() : this;\n        };\n        Transaction.prototype.waitFor = function (promiseLike) {\n            var root = this._root();\n            var promise = DexiePromise.resolve(promiseLike);\n            if (root._waitingFor) {\n                root._waitingFor = root._waitingFor.then(function () { return promise; });\n            }\n            else {\n                root._waitingFor = promise;\n                root._waitingQueue = [];\n                var store = root.idbtrans.objectStore(root.storeNames[0]);\n                (function spin() {\n                    ++root._spinCount;\n                    while (root._waitingQueue.length)\n                        (root._waitingQueue.shift())();\n                    if (root._waitingFor)\n                        store.get(-Infinity).onsuccess = spin;\n                }());\n            }\n            var currentWaitPromise = root._waitingFor;\n            return new DexiePromise(function (resolve, reject) {\n                promise.then(function (res) { return root._waitingQueue.push(wrap(resolve.bind(null, res))); }, function (err) { return root._waitingQueue.push(wrap(reject.bind(null, err))); }).finally(function () {\n                    if (root._waitingFor === currentWaitPromise) {\n                        root._waitingFor = null;\n                    }\n                });\n            });\n        };\n        Transaction.prototype.abort = function () {\n            if (this.active) {\n                this.active = false;\n                if (this.idbtrans)\n                    this.idbtrans.abort();\n                this._reject(new exceptions.Abort());\n            }\n        };\n        Transaction.prototype.table = function (tableName) {\n            var memoizedTables = (this._memoizedTables || (this._memoizedTables = {}));\n            if (hasOwn(memoizedTables, tableName))\n                return memoizedTables[tableName];\n            var tableSchema = this.schema[tableName];\n            if (!tableSchema) {\n                throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n            }\n            var transactionBoundTable = new this.db.Table(tableName, tableSchema, this);\n            transactionBoundTable.core = this.db.core.table(tableName);\n            memoizedTables[tableName] = transactionBoundTable;\n            return transactionBoundTable;\n        };\n        return Transaction;\n    }());\n\n    function createTransactionConstructor(db) {\n        return makeClassConstructor(Transaction.prototype, function Transaction(mode, storeNames, dbschema, chromeTransactionDurability, parent) {\n            var _this = this;\n            this.db = db;\n            this.mode = mode;\n            this.storeNames = storeNames;\n            this.schema = dbschema;\n            this.chromeTransactionDurability = chromeTransactionDurability;\n            this.idbtrans = null;\n            this.on = Events(this, \"complete\", \"error\", \"abort\");\n            this.parent = parent || null;\n            this.active = true;\n            this._reculock = 0;\n            this._blockedFuncs = [];\n            this._resolve = null;\n            this._reject = null;\n            this._waitingFor = null;\n            this._waitingQueue = null;\n            this._spinCount = 0;\n            this._completion = new DexiePromise(function (resolve, reject) {\n                _this._resolve = resolve;\n                _this._reject = reject;\n            });\n            this._completion.then(function () {\n                _this.active = false;\n                _this.on.complete.fire();\n            }, function (e) {\n                var wasActive = _this.active;\n                _this.active = false;\n                _this.on.error.fire(e);\n                _this.parent ?\n                    _this.parent._reject(e) :\n                    wasActive && _this.idbtrans && _this.idbtrans.abort();\n                return rejection(e);\n            });\n        });\n    }\n\n    function createIndexSpec(name, keyPath, unique, multi, auto, compound, isPrimKey) {\n        return {\n            name: name,\n            keyPath: keyPath,\n            unique: unique,\n            multi: multi,\n            auto: auto,\n            compound: compound,\n            src: (unique && !isPrimKey ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + nameFromKeyPath(keyPath)\n        };\n    }\n    function nameFromKeyPath(keyPath) {\n        return typeof keyPath === 'string' ?\n            keyPath :\n            keyPath ? ('[' + [].join.call(keyPath, '+') + ']') : \"\";\n    }\n\n    function createTableSchema(name, primKey, indexes) {\n        return {\n            name: name,\n            primKey: primKey,\n            indexes: indexes,\n            mappedClass: null,\n            idxByName: arrayToObject(indexes, function (index) { return [index.name, index]; })\n        };\n    }\n\n    function safariMultiStoreFix(storeNames) {\n        return storeNames.length === 1 ? storeNames[0] : storeNames;\n    }\n    var getMaxKey = function (IdbKeyRange) {\n        try {\n            IdbKeyRange.only([[]]);\n            getMaxKey = function () { return [[]]; };\n            return [[]];\n        }\n        catch (e) {\n            getMaxKey = function () { return maxString; };\n            return maxString;\n        }\n    };\n\n    function getKeyExtractor(keyPath) {\n        if (keyPath == null) {\n            return function () { return undefined; };\n        }\n        else if (typeof keyPath === 'string') {\n            return getSinglePathKeyExtractor(keyPath);\n        }\n        else {\n            return function (obj) { return getByKeyPath(obj, keyPath); };\n        }\n    }\n    function getSinglePathKeyExtractor(keyPath) {\n        var split = keyPath.split('.');\n        if (split.length === 1) {\n            return function (obj) { return obj[keyPath]; };\n        }\n        else {\n            return function (obj) { return getByKeyPath(obj, keyPath); };\n        }\n    }\n\n    function arrayify(arrayLike) {\n        return [].slice.call(arrayLike);\n    }\n    var _id_counter = 0;\n    function getKeyPathAlias(keyPath) {\n        return keyPath == null ?\n            \":id\" :\n            typeof keyPath === 'string' ?\n                keyPath :\n                \"[\".concat(keyPath.join('+'), \"]\");\n    }\n    function createDBCore(db, IdbKeyRange, tmpTrans) {\n        function extractSchema(db, trans) {\n            var tables = arrayify(db.objectStoreNames);\n            return {\n                schema: {\n                    name: db.name,\n                    tables: tables.map(function (table) { return trans.objectStore(table); }).map(function (store) {\n                        var keyPath = store.keyPath, autoIncrement = store.autoIncrement;\n                        var compound = isArray(keyPath);\n                        var outbound = keyPath == null;\n                        var indexByKeyPath = {};\n                        var result = {\n                            name: store.name,\n                            primaryKey: {\n                                name: null,\n                                isPrimaryKey: true,\n                                outbound: outbound,\n                                compound: compound,\n                                keyPath: keyPath,\n                                autoIncrement: autoIncrement,\n                                unique: true,\n                                extractKey: getKeyExtractor(keyPath)\n                            },\n                            indexes: arrayify(store.indexNames).map(function (indexName) { return store.index(indexName); })\n                                .map(function (index) {\n                                var name = index.name, unique = index.unique, multiEntry = index.multiEntry, keyPath = index.keyPath;\n                                var compound = isArray(keyPath);\n                                var result = {\n                                    name: name,\n                                    compound: compound,\n                                    keyPath: keyPath,\n                                    unique: unique,\n                                    multiEntry: multiEntry,\n                                    extractKey: getKeyExtractor(keyPath)\n                                };\n                                indexByKeyPath[getKeyPathAlias(keyPath)] = result;\n                                return result;\n                            }),\n                            getIndexByKeyPath: function (keyPath) { return indexByKeyPath[getKeyPathAlias(keyPath)]; }\n                        };\n                        indexByKeyPath[\":id\"] = result.primaryKey;\n                        if (keyPath != null) {\n                            indexByKeyPath[getKeyPathAlias(keyPath)] = result.primaryKey;\n                        }\n                        return result;\n                    })\n                },\n                hasGetAll: tables.length > 0 && ('getAll' in trans.objectStore(tables[0])) &&\n                    !(typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n                        !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n                        [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604)\n            };\n        }\n        function makeIDBKeyRange(range) {\n            if (range.type === 3 )\n                return null;\n            if (range.type === 4 )\n                throw new Error(\"Cannot convert never type to IDBKeyRange\");\n            var lower = range.lower, upper = range.upper, lowerOpen = range.lowerOpen, upperOpen = range.upperOpen;\n            var idbRange = lower === undefined ?\n                upper === undefined ?\n                    null :\n                    IdbKeyRange.upperBound(upper, !!upperOpen) :\n                upper === undefined ?\n                    IdbKeyRange.lowerBound(lower, !!lowerOpen) :\n                    IdbKeyRange.bound(lower, upper, !!lowerOpen, !!upperOpen);\n            return idbRange;\n        }\n        function createDbCoreTable(tableSchema) {\n            var tableName = tableSchema.name;\n            function mutate(_a) {\n                var trans = _a.trans, type = _a.type, keys = _a.keys, values = _a.values, range = _a.range;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var store = trans.objectStore(tableName);\n                    var outbound = store.keyPath == null;\n                    var isAddOrPut = type === \"put\" || type === \"add\";\n                    if (!isAddOrPut && type !== 'delete' && type !== 'deleteRange')\n                        throw new Error(\"Invalid operation type: \" + type);\n                    var length = (keys || values || { length: 1 }).length;\n                    if (keys && values && keys.length !== values.length) {\n                        throw new Error(\"Given keys array must have same length as given values array.\");\n                    }\n                    if (length === 0)\n                        return resolve({ numFailures: 0, failures: {}, results: [], lastResult: undefined });\n                    var req;\n                    var reqs = [];\n                    var failures = [];\n                    var numFailures = 0;\n                    var errorHandler = function (event) {\n                        ++numFailures;\n                        preventDefault(event);\n                    };\n                    if (type === 'deleteRange') {\n                        if (range.type === 4 )\n                            return resolve({ numFailures: numFailures, failures: failures, results: [], lastResult: undefined });\n                        if (range.type === 3 )\n                            reqs.push(req = store.clear());\n                        else\n                            reqs.push(req = store.delete(makeIDBKeyRange(range)));\n                    }\n                    else {\n                        var _a = isAddOrPut ?\n                            outbound ?\n                                [values, keys] :\n                                [values, null] :\n                            [keys, null], args1 = _a[0], args2 = _a[1];\n                        if (isAddOrPut) {\n                            for (var i = 0; i < length; ++i) {\n                                reqs.push(req = (args2 && args2[i] !== undefined ?\n                                    store[type](args1[i], args2[i]) :\n                                    store[type](args1[i])));\n                                req.onerror = errorHandler;\n                            }\n                        }\n                        else {\n                            for (var i = 0; i < length; ++i) {\n                                reqs.push(req = store[type](args1[i]));\n                                req.onerror = errorHandler;\n                            }\n                        }\n                    }\n                    var done = function (event) {\n                        var lastResult = event.target.result;\n                        reqs.forEach(function (req, i) { return req.error != null && (failures[i] = req.error); });\n                        resolve({\n                            numFailures: numFailures,\n                            failures: failures,\n                            results: type === \"delete\" ? keys : reqs.map(function (req) { return req.result; }),\n                            lastResult: lastResult\n                        });\n                    };\n                    req.onerror = function (event) {\n                        errorHandler(event);\n                        done(event);\n                    };\n                    req.onsuccess = done;\n                });\n            }\n            function openCursor(_a) {\n                var trans = _a.trans, values = _a.values, query = _a.query, reverse = _a.reverse, unique = _a.unique;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var index = query.index, range = query.range;\n                    var store = trans.objectStore(tableName);\n                    var source = index.isPrimaryKey ?\n                        store :\n                        store.index(index.name);\n                    var direction = reverse ?\n                        unique ?\n                            \"prevunique\" :\n                            \"prev\" :\n                        unique ?\n                            \"nextunique\" :\n                            \"next\";\n                    var req = values || !('openKeyCursor' in source) ?\n                        source.openCursor(makeIDBKeyRange(range), direction) :\n                        source.openKeyCursor(makeIDBKeyRange(range), direction);\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = wrap(function (ev) {\n                        var cursor = req.result;\n                        if (!cursor) {\n                            resolve(null);\n                            return;\n                        }\n                        cursor.___id = ++_id_counter;\n                        cursor.done = false;\n                        var _cursorContinue = cursor.continue.bind(cursor);\n                        var _cursorContinuePrimaryKey = cursor.continuePrimaryKey;\n                        if (_cursorContinuePrimaryKey)\n                            _cursorContinuePrimaryKey = _cursorContinuePrimaryKey.bind(cursor);\n                        var _cursorAdvance = cursor.advance.bind(cursor);\n                        var doThrowCursorIsNotStarted = function () { throw new Error(\"Cursor not started\"); };\n                        var doThrowCursorIsStopped = function () { throw new Error(\"Cursor not stopped\"); };\n                        cursor.trans = trans;\n                        cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsNotStarted;\n                        cursor.fail = wrap(reject);\n                        cursor.next = function () {\n                            var _this = this;\n                            var gotOne = 1;\n                            return this.start(function () { return gotOne-- ? _this.continue() : _this.stop(); }).then(function () { return _this; });\n                        };\n                        cursor.start = function (callback) {\n                            var iterationPromise = new Promise(function (resolveIteration, rejectIteration) {\n                                resolveIteration = wrap(resolveIteration);\n                                req.onerror = eventRejectHandler(rejectIteration);\n                                cursor.fail = rejectIteration;\n                                cursor.stop = function (value) {\n                                    cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsStopped;\n                                    resolveIteration(value);\n                                };\n                            });\n                            var guardedCallback = function () {\n                                if (req.result) {\n                                    try {\n                                        callback();\n                                    }\n                                    catch (err) {\n                                        cursor.fail(err);\n                                    }\n                                }\n                                else {\n                                    cursor.done = true;\n                                    cursor.start = function () { throw new Error(\"Cursor behind last entry\"); };\n                                    cursor.stop();\n                                }\n                            };\n                            req.onsuccess = wrap(function (ev) {\n                                req.onsuccess = guardedCallback;\n                                guardedCallback();\n                            });\n                            cursor.continue = _cursorContinue;\n                            cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n                            cursor.advance = _cursorAdvance;\n                            guardedCallback();\n                            return iterationPromise;\n                        };\n                        resolve(cursor);\n                    }, reject);\n                });\n            }\n            function query(hasGetAll) {\n                return function (request) {\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var trans = request.trans, values = request.values, limit = request.limit, query = request.query;\n                        var nonInfinitLimit = limit === Infinity ? undefined : limit;\n                        var index = query.index, range = query.range;\n                        var store = trans.objectStore(tableName);\n                        var source = index.isPrimaryKey ? store : store.index(index.name);\n                        var idbKeyRange = makeIDBKeyRange(range);\n                        if (limit === 0)\n                            return resolve({ result: [] });\n                        if (hasGetAll) {\n                            var req = values ?\n                                source.getAll(idbKeyRange, nonInfinitLimit) :\n                                source.getAllKeys(idbKeyRange, nonInfinitLimit);\n                            req.onsuccess = function (event) { return resolve({ result: event.target.result }); };\n                            req.onerror = eventRejectHandler(reject);\n                        }\n                        else {\n                            var count_1 = 0;\n                            var req_1 = values || !('openKeyCursor' in source) ?\n                                source.openCursor(idbKeyRange) :\n                                source.openKeyCursor(idbKeyRange);\n                            var result_1 = [];\n                            req_1.onsuccess = function (event) {\n                                var cursor = req_1.result;\n                                if (!cursor)\n                                    return resolve({ result: result_1 });\n                                result_1.push(values ? cursor.value : cursor.primaryKey);\n                                if (++count_1 === limit)\n                                    return resolve({ result: result_1 });\n                                cursor.continue();\n                            };\n                            req_1.onerror = eventRejectHandler(reject);\n                        }\n                    });\n                };\n            }\n            return {\n                name: tableName,\n                schema: tableSchema,\n                mutate: mutate,\n                getMany: function (_a) {\n                    var trans = _a.trans, keys = _a.keys;\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var store = trans.objectStore(tableName);\n                        var length = keys.length;\n                        var result = new Array(length);\n                        var keyCount = 0;\n                        var callbackCount = 0;\n                        var req;\n                        var successHandler = function (event) {\n                            var req = event.target;\n                            if ((result[req._pos] = req.result) != null)\n                                ;\n                            if (++callbackCount === keyCount)\n                                resolve(result);\n                        };\n                        var errorHandler = eventRejectHandler(reject);\n                        for (var i = 0; i < length; ++i) {\n                            var key = keys[i];\n                            if (key != null) {\n                                req = store.get(keys[i]);\n                                req._pos = i;\n                                req.onsuccess = successHandler;\n                                req.onerror = errorHandler;\n                                ++keyCount;\n                            }\n                        }\n                        if (keyCount === 0)\n                            resolve(result);\n                    });\n                },\n                get: function (_a) {\n                    var trans = _a.trans, key = _a.key;\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var store = trans.objectStore(tableName);\n                        var req = store.get(key);\n                        req.onsuccess = function (event) { return resolve(event.target.result); };\n                        req.onerror = eventRejectHandler(reject);\n                    });\n                },\n                query: query(hasGetAll),\n                openCursor: openCursor,\n                count: function (_a) {\n                    var query = _a.query, trans = _a.trans;\n                    var index = query.index, range = query.range;\n                    return new Promise(function (resolve, reject) {\n                        var store = trans.objectStore(tableName);\n                        var source = index.isPrimaryKey ? store : store.index(index.name);\n                        var idbKeyRange = makeIDBKeyRange(range);\n                        var req = idbKeyRange ? source.count(idbKeyRange) : source.count();\n                        req.onsuccess = wrap(function (ev) { return resolve(ev.target.result); });\n                        req.onerror = eventRejectHandler(reject);\n                    });\n                }\n            };\n        }\n        var _a = extractSchema(db, tmpTrans), schema = _a.schema, hasGetAll = _a.hasGetAll;\n        var tables = schema.tables.map(function (tableSchema) { return createDbCoreTable(tableSchema); });\n        var tableMap = {};\n        tables.forEach(function (table) { return tableMap[table.name] = table; });\n        return {\n            stack: \"dbcore\",\n            transaction: db.transaction.bind(db),\n            table: function (name) {\n                var result = tableMap[name];\n                if (!result)\n                    throw new Error(\"Table '\".concat(name, \"' not found\"));\n                return tableMap[name];\n            },\n            MIN_KEY: -Infinity,\n            MAX_KEY: getMaxKey(IdbKeyRange),\n            schema: schema\n        };\n    }\n\n    function createMiddlewareStack(stackImpl, middlewares) {\n        return middlewares.reduce(function (down, _a) {\n            var create = _a.create;\n            return (__assign(__assign({}, down), create(down)));\n        }, stackImpl);\n    }\n    function createMiddlewareStacks(middlewares, idbdb, _a, tmpTrans) {\n        var IDBKeyRange = _a.IDBKeyRange; _a.indexedDB;\n        var dbcore = createMiddlewareStack(createDBCore(idbdb, IDBKeyRange, tmpTrans), middlewares.dbcore);\n        return {\n            dbcore: dbcore\n        };\n    }\n    function generateMiddlewareStacks(db, tmpTrans) {\n        var idbdb = tmpTrans.db;\n        var stacks = createMiddlewareStacks(db._middlewares, idbdb, db._deps, tmpTrans);\n        db.core = stacks.dbcore;\n        db.tables.forEach(function (table) {\n            var tableName = table.name;\n            if (db.core.schema.tables.some(function (tbl) { return tbl.name === tableName; })) {\n                table.core = db.core.table(tableName);\n                if (db[tableName] instanceof db.Table) {\n                    db[tableName].core = table.core;\n                }\n            }\n        });\n    }\n\n    function setApiOnPlace(db, objs, tableNames, dbschema) {\n        tableNames.forEach(function (tableName) {\n            var schema = dbschema[tableName];\n            objs.forEach(function (obj) {\n                var propDesc = getPropertyDescriptor(obj, tableName);\n                if (!propDesc || (\"value\" in propDesc && propDesc.value === undefined)) {\n                    if (obj === db.Transaction.prototype || obj instanceof db.Transaction) {\n                        setProp(obj, tableName, {\n                            get: function () { return this.table(tableName); },\n                            set: function (value) {\n                                defineProperty(this, tableName, { value: value, writable: true, configurable: true, enumerable: true });\n                            }\n                        });\n                    }\n                    else {\n                        obj[tableName] = new db.Table(tableName, schema);\n                    }\n                }\n            });\n        });\n    }\n    function removeTablesApi(db, objs) {\n        objs.forEach(function (obj) {\n            for (var key in obj) {\n                if (obj[key] instanceof db.Table)\n                    delete obj[key];\n            }\n        });\n    }\n    function lowerVersionFirst(a, b) {\n        return a._cfg.version - b._cfg.version;\n    }\n    function runUpgraders(db, oldVersion, idbUpgradeTrans, reject) {\n        var globalSchema = db._dbSchema;\n        if (idbUpgradeTrans.objectStoreNames.contains('$meta') && !globalSchema.$meta) {\n            globalSchema.$meta = createTableSchema(\"$meta\", parseIndexSyntax(\"\")[0], []);\n            db._storeNames.push('$meta');\n        }\n        var trans = db._createTransaction('readwrite', db._storeNames, globalSchema);\n        trans.create(idbUpgradeTrans);\n        trans._completion.catch(reject);\n        var rejectTransaction = trans._reject.bind(trans);\n        var transless = PSD.transless || PSD;\n        newScope(function () {\n            PSD.trans = trans;\n            PSD.transless = transless;\n            if (oldVersion === 0) {\n                keys(globalSchema).forEach(function (tableName) {\n                    createTable(idbUpgradeTrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n                });\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                DexiePromise.follow(function () { return db.on.populate.fire(trans); }).catch(rejectTransaction);\n            }\n            else {\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                return getExistingVersion(db, trans, oldVersion)\n                    .then(function (oldVersion) { return updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans); })\n                    .catch(rejectTransaction);\n            }\n        });\n    }\n    function patchCurrentVersion(db, idbUpgradeTrans) {\n        createMissingTables(db._dbSchema, idbUpgradeTrans);\n        if (idbUpgradeTrans.db.version % 10 === 0 && !idbUpgradeTrans.objectStoreNames.contains('$meta')) {\n            idbUpgradeTrans.db.createObjectStore('$meta').add(Math.ceil((idbUpgradeTrans.db.version / 10) - 1), 'version');\n        }\n        var globalSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n        adjustToExistingIndexNames(db, db._dbSchema, idbUpgradeTrans);\n        var diff = getSchemaDiff(globalSchema, db._dbSchema);\n        var _loop_1 = function (tableChange) {\n            if (tableChange.change.length || tableChange.recreate) {\n                console.warn(\"Unable to patch indexes of table \".concat(tableChange.name, \" because it has changes on the type of index or primary key.\"));\n                return { value: void 0 };\n            }\n            var store = idbUpgradeTrans.objectStore(tableChange.name);\n            tableChange.add.forEach(function (idx) {\n                if (debug)\n                    console.debug(\"Dexie upgrade patch: Creating missing index \".concat(tableChange.name, \".\").concat(idx.src));\n                addIndex(store, idx);\n            });\n        };\n        for (var _i = 0, _a = diff.change; _i < _a.length; _i++) {\n            var tableChange = _a[_i];\n            var state_1 = _loop_1(tableChange);\n            if (typeof state_1 === \"object\")\n                return state_1.value;\n        }\n    }\n    function getExistingVersion(db, trans, oldVersion) {\n        if (trans.storeNames.includes('$meta')) {\n            return trans.table('$meta').get('version').then(function (metaVersion) {\n                return metaVersion != null ? metaVersion : oldVersion;\n            });\n        }\n        else {\n            return DexiePromise.resolve(oldVersion);\n        }\n    }\n    function updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans) {\n        var queue = [];\n        var versions = db._versions;\n        var globalSchema = db._dbSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n        var versToRun = versions.filter(function (v) { return v._cfg.version >= oldVersion; });\n        if (versToRun.length === 0) {\n            return DexiePromise.resolve();\n        }\n        versToRun.forEach(function (version) {\n            queue.push(function () {\n                var oldSchema = globalSchema;\n                var newSchema = version._cfg.dbschema;\n                adjustToExistingIndexNames(db, oldSchema, idbUpgradeTrans);\n                adjustToExistingIndexNames(db, newSchema, idbUpgradeTrans);\n                globalSchema = db._dbSchema = newSchema;\n                var diff = getSchemaDiff(oldSchema, newSchema);\n                diff.add.forEach(function (tuple) {\n                    createTable(idbUpgradeTrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n                });\n                diff.change.forEach(function (change) {\n                    if (change.recreate) {\n                        throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n                    }\n                    else {\n                        var store_1 = idbUpgradeTrans.objectStore(change.name);\n                        change.add.forEach(function (idx) { return addIndex(store_1, idx); });\n                        change.change.forEach(function (idx) {\n                            store_1.deleteIndex(idx.name);\n                            addIndex(store_1, idx);\n                        });\n                        change.del.forEach(function (idxName) { return store_1.deleteIndex(idxName); });\n                    }\n                });\n                var contentUpgrade = version._cfg.contentUpgrade;\n                if (contentUpgrade && version._cfg.version > oldVersion) {\n                    generateMiddlewareStacks(db, idbUpgradeTrans);\n                    trans._memoizedTables = {};\n                    var upgradeSchema_1 = shallowClone(newSchema);\n                    diff.del.forEach(function (table) {\n                        upgradeSchema_1[table] = oldSchema[table];\n                    });\n                    removeTablesApi(db, [db.Transaction.prototype]);\n                    setApiOnPlace(db, [db.Transaction.prototype], keys(upgradeSchema_1), upgradeSchema_1);\n                    trans.schema = upgradeSchema_1;\n                    var contentUpgradeIsAsync_1 = isAsyncFunction(contentUpgrade);\n                    if (contentUpgradeIsAsync_1) {\n                        incrementExpectedAwaits();\n                    }\n                    var returnValue_1;\n                    var promiseFollowed = DexiePromise.follow(function () {\n                        returnValue_1 = contentUpgrade(trans);\n                        if (returnValue_1) {\n                            if (contentUpgradeIsAsync_1) {\n                                var decrementor = decrementExpectedAwaits.bind(null, null);\n                                returnValue_1.then(decrementor, decrementor);\n                            }\n                        }\n                    });\n                    return (returnValue_1 && typeof returnValue_1.then === 'function' ?\n                        DexiePromise.resolve(returnValue_1) : promiseFollowed.then(function () { return returnValue_1; }));\n                }\n            });\n            queue.push(function (idbtrans) {\n                var newSchema = version._cfg.dbschema;\n                deleteRemovedTables(newSchema, idbtrans);\n                removeTablesApi(db, [db.Transaction.prototype]);\n                setApiOnPlace(db, [db.Transaction.prototype], db._storeNames, db._dbSchema);\n                trans.schema = db._dbSchema;\n            });\n            queue.push(function (idbtrans) {\n                if (db.idbdb.objectStoreNames.contains('$meta')) {\n                    if (Math.ceil(db.idbdb.version / 10) === version._cfg.version) {\n                        db.idbdb.deleteObjectStore('$meta');\n                        delete db._dbSchema.$meta;\n                        db._storeNames = db._storeNames.filter(function (name) { return name !== '$meta'; });\n                    }\n                    else {\n                        idbtrans.objectStore('$meta').put(version._cfg.version, 'version');\n                    }\n                }\n            });\n        });\n        function runQueue() {\n            return queue.length ? DexiePromise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) :\n                DexiePromise.resolve();\n        }\n        return runQueue().then(function () {\n            createMissingTables(globalSchema, idbUpgradeTrans);\n        });\n    }\n    function getSchemaDiff(oldSchema, newSchema) {\n        var diff = {\n            del: [],\n            add: [],\n            change: []\n        };\n        var table;\n        for (table in oldSchema) {\n            if (!newSchema[table])\n                diff.del.push(table);\n        }\n        for (table in newSchema) {\n            var oldDef = oldSchema[table], newDef = newSchema[table];\n            if (!oldDef) {\n                diff.add.push([table, newDef]);\n            }\n            else {\n                var change = {\n                    name: table,\n                    def: newDef,\n                    recreate: false,\n                    del: [],\n                    add: [],\n                    change: []\n                };\n                if ((\n                '' + (oldDef.primKey.keyPath || '')) !== ('' + (newDef.primKey.keyPath || '')) ||\n                    (oldDef.primKey.auto !== newDef.primKey.auto)) {\n                    change.recreate = true;\n                    diff.change.push(change);\n                }\n                else {\n                    var oldIndexes = oldDef.idxByName;\n                    var newIndexes = newDef.idxByName;\n                    var idxName = void 0;\n                    for (idxName in oldIndexes) {\n                        if (!newIndexes[idxName])\n                            change.del.push(idxName);\n                    }\n                    for (idxName in newIndexes) {\n                        var oldIdx = oldIndexes[idxName], newIdx = newIndexes[idxName];\n                        if (!oldIdx)\n                            change.add.push(newIdx);\n                        else if (oldIdx.src !== newIdx.src)\n                            change.change.push(newIdx);\n                    }\n                    if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n                        diff.change.push(change);\n                    }\n                }\n            }\n        }\n        return diff;\n    }\n    function createTable(idbtrans, tableName, primKey, indexes) {\n        var store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ?\n            { keyPath: primKey.keyPath, autoIncrement: primKey.auto } :\n            { autoIncrement: primKey.auto });\n        indexes.forEach(function (idx) { return addIndex(store, idx); });\n        return store;\n    }\n    function createMissingTables(newSchema, idbtrans) {\n        keys(newSchema).forEach(function (tableName) {\n            if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n                if (debug)\n                    console.debug('Dexie: Creating missing table', tableName);\n                createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n            }\n        });\n    }\n    function deleteRemovedTables(newSchema, idbtrans) {\n        [].slice.call(idbtrans.db.objectStoreNames).forEach(function (storeName) {\n            return newSchema[storeName] == null && idbtrans.db.deleteObjectStore(storeName);\n        });\n    }\n    function addIndex(store, idx) {\n        store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n    }\n    function buildGlobalSchema(db, idbdb, tmpTrans) {\n        var globalSchema = {};\n        var dbStoreNames = slice(idbdb.objectStoreNames, 0);\n        dbStoreNames.forEach(function (storeName) {\n            var store = tmpTrans.objectStore(storeName);\n            var keyPath = store.keyPath;\n            var primKey = createIndexSpec(nameFromKeyPath(keyPath), keyPath || \"\", true, false, !!store.autoIncrement, keyPath && typeof keyPath !== \"string\", true);\n            var indexes = [];\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var idbindex = store.index(store.indexNames[j]);\n                keyPath = idbindex.keyPath;\n                var index = createIndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== \"string\", false);\n                indexes.push(index);\n            }\n            globalSchema[storeName] = createTableSchema(storeName, primKey, indexes);\n        });\n        return globalSchema;\n    }\n    function readGlobalSchema(db, idbdb, tmpTrans) {\n        db.verno = idbdb.version / 10;\n        var globalSchema = db._dbSchema = buildGlobalSchema(db, idbdb, tmpTrans);\n        db._storeNames = slice(idbdb.objectStoreNames, 0);\n        setApiOnPlace(db, [db._allTables], keys(globalSchema), globalSchema);\n    }\n    function verifyInstalledSchema(db, tmpTrans) {\n        var installedSchema = buildGlobalSchema(db, db.idbdb, tmpTrans);\n        var diff = getSchemaDiff(installedSchema, db._dbSchema);\n        return !(diff.add.length || diff.change.some(function (ch) { return ch.add.length || ch.change.length; }));\n    }\n    function adjustToExistingIndexNames(db, schema, idbtrans) {\n        var storeNames = idbtrans.db.objectStoreNames;\n        for (var i = 0; i < storeNames.length; ++i) {\n            var storeName = storeNames[i];\n            var store = idbtrans.objectStore(storeName);\n            db._hasGetAll = 'getAll' in store;\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var indexName = store.indexNames[j];\n                var keyPath = store.index(indexName).keyPath;\n                var dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n                if (schema[storeName]) {\n                    var indexSpec = schema[storeName].idxByName[dexieName];\n                    if (indexSpec) {\n                        indexSpec.name = indexName;\n                        delete schema[storeName].idxByName[dexieName];\n                        schema[storeName].idxByName[indexName] = indexSpec;\n                    }\n                }\n            }\n        }\n        if (typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n            !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n            _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope &&\n            [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) {\n            db._hasGetAll = false;\n        }\n    }\n    function parseIndexSyntax(primKeyAndIndexes) {\n        return primKeyAndIndexes.split(',').map(function (index, indexNum) {\n            index = index.trim();\n            var name = index.replace(/([&*]|\\+\\+)/g, \"\");\n            var keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n            return createIndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), indexNum === 0);\n        });\n    }\n\n    var Version =  (function () {\n        function Version() {\n        }\n        Version.prototype._parseStoresSpec = function (stores, outSchema) {\n            keys(stores).forEach(function (tableName) {\n                if (stores[tableName] !== null) {\n                    var indexes = parseIndexSyntax(stores[tableName]);\n                    var primKey = indexes.shift();\n                    primKey.unique = true;\n                    if (primKey.multi)\n                        throw new exceptions.Schema(\"Primary key cannot be multi-valued\");\n                    indexes.forEach(function (idx) {\n                        if (idx.auto)\n                            throw new exceptions.Schema(\"Only primary key can be marked as autoIncrement (++)\");\n                        if (!idx.keyPath)\n                            throw new exceptions.Schema(\"Index must have a name and cannot be an empty string\");\n                    });\n                    outSchema[tableName] = createTableSchema(tableName, primKey, indexes);\n                }\n            });\n        };\n        Version.prototype.stores = function (stores) {\n            var db = this.db;\n            this._cfg.storesSource = this._cfg.storesSource ?\n                extend(this._cfg.storesSource, stores) :\n                stores;\n            var versions = db._versions;\n            var storesSpec = {};\n            var dbschema = {};\n            versions.forEach(function (version) {\n                extend(storesSpec, version._cfg.storesSource);\n                dbschema = (version._cfg.dbschema = {});\n                version._parseStoresSpec(storesSpec, dbschema);\n            });\n            db._dbSchema = dbschema;\n            removeTablesApi(db, [db._allTables, db, db.Transaction.prototype]);\n            setApiOnPlace(db, [db._allTables, db, db.Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n            db._storeNames = keys(dbschema);\n            return this;\n        };\n        Version.prototype.upgrade = function (upgradeFunction) {\n            this._cfg.contentUpgrade = promisableChain(this._cfg.contentUpgrade || nop, upgradeFunction);\n            return this;\n        };\n        return Version;\n    }());\n\n    function createVersionConstructor(db) {\n        return makeClassConstructor(Version.prototype, function Version(versionNumber) {\n            this.db = db;\n            this._cfg = {\n                version: versionNumber,\n                storesSource: null,\n                dbschema: {},\n                tables: {},\n                contentUpgrade: null\n            };\n        });\n    }\n\n    function getDbNamesTable(indexedDB, IDBKeyRange) {\n        var dbNamesDB = indexedDB[\"_dbNamesDB\"];\n        if (!dbNamesDB) {\n            dbNamesDB = indexedDB[\"_dbNamesDB\"] = new Dexie$1(DBNAMES_DB, {\n                addons: [],\n                indexedDB: indexedDB,\n                IDBKeyRange: IDBKeyRange,\n            });\n            dbNamesDB.version(1).stores({ dbnames: \"name\" });\n        }\n        return dbNamesDB.table(\"dbnames\");\n    }\n    function hasDatabasesNative(indexedDB) {\n        return indexedDB && typeof indexedDB.databases === \"function\";\n    }\n    function getDatabaseNames(_a) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        return hasDatabasesNative(indexedDB)\n            ? Promise.resolve(indexedDB.databases()).then(function (infos) {\n                return infos\n                    .map(function (info) { return info.name; })\n                    .filter(function (name) { return name !== DBNAMES_DB; });\n            })\n            : getDbNamesTable(indexedDB, IDBKeyRange).toCollection().primaryKeys();\n    }\n    function _onDatabaseCreated(_a, name) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        !hasDatabasesNative(indexedDB) &&\n            name !== DBNAMES_DB &&\n            getDbNamesTable(indexedDB, IDBKeyRange).put({ name: name }).catch(nop);\n    }\n    function _onDatabaseDeleted(_a, name) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        !hasDatabasesNative(indexedDB) &&\n            name !== DBNAMES_DB &&\n            getDbNamesTable(indexedDB, IDBKeyRange).delete(name).catch(nop);\n    }\n\n    function vip(fn) {\n        return newScope(function () {\n            PSD.letThrough = true;\n            return fn();\n        });\n    }\n\n    function idbReady() {\n        var isSafari = !navigator.userAgentData &&\n            /Safari\\//.test(navigator.userAgent) &&\n            !/Chrom(e|ium)\\//.test(navigator.userAgent);\n        if (!isSafari || !indexedDB.databases)\n            return Promise.resolve();\n        var intervalId;\n        return new Promise(function (resolve) {\n            var tryIdb = function () { return indexedDB.databases().finally(resolve); };\n            intervalId = setInterval(tryIdb, 100);\n            tryIdb();\n        }).finally(function () { return clearInterval(intervalId); });\n    }\n\n    var _a;\n    function isEmptyRange(node) {\n        return !(\"from\" in node);\n    }\n    var RangeSet = function (fromOrTree, to) {\n        if (this) {\n            extend(this, arguments.length ? { d: 1, from: fromOrTree, to: arguments.length > 1 ? to : fromOrTree } : { d: 0 });\n        }\n        else {\n            var rv = new RangeSet();\n            if (fromOrTree && (\"d\" in fromOrTree)) {\n                extend(rv, fromOrTree);\n            }\n            return rv;\n        }\n    };\n    props(RangeSet.prototype, (_a = {\n            add: function (rangeSet) {\n                mergeRanges(this, rangeSet);\n                return this;\n            },\n            addKey: function (key) {\n                addRange(this, key, key);\n                return this;\n            },\n            addKeys: function (keys) {\n                var _this = this;\n                keys.forEach(function (key) { return addRange(_this, key, key); });\n                return this;\n            },\n            hasKey: function (key) {\n                var node = getRangeSetIterator(this).next(key).value;\n                return node && cmp(node.from, key) <= 0 && cmp(node.to, key) >= 0;\n            }\n        },\n        _a[iteratorSymbol] = function () {\n            return getRangeSetIterator(this);\n        },\n        _a));\n    function addRange(target, from, to) {\n        var diff = cmp(from, to);\n        if (isNaN(diff))\n            return;\n        if (diff > 0)\n            throw RangeError();\n        if (isEmptyRange(target))\n            return extend(target, { from: from, to: to, d: 1 });\n        var left = target.l;\n        var right = target.r;\n        if (cmp(to, target.from) < 0) {\n            left\n                ? addRange(left, from, to)\n                : (target.l = { from: from, to: to, d: 1, l: null, r: null });\n            return rebalance(target);\n        }\n        if (cmp(from, target.to) > 0) {\n            right\n                ? addRange(right, from, to)\n                : (target.r = { from: from, to: to, d: 1, l: null, r: null });\n            return rebalance(target);\n        }\n        if (cmp(from, target.from) < 0) {\n            target.from = from;\n            target.l = null;\n            target.d = right ? right.d + 1 : 1;\n        }\n        if (cmp(to, target.to) > 0) {\n            target.to = to;\n            target.r = null;\n            target.d = target.l ? target.l.d + 1 : 1;\n        }\n        var rightWasCutOff = !target.r;\n        if (left && !target.l) {\n            mergeRanges(target, left);\n        }\n        if (right && rightWasCutOff) {\n            mergeRanges(target, right);\n        }\n    }\n    function mergeRanges(target, newSet) {\n        function _addRangeSet(target, _a) {\n            var from = _a.from, to = _a.to, l = _a.l, r = _a.r;\n            addRange(target, from, to);\n            if (l)\n                _addRangeSet(target, l);\n            if (r)\n                _addRangeSet(target, r);\n        }\n        if (!isEmptyRange(newSet))\n            _addRangeSet(target, newSet);\n    }\n    function rangesOverlap(rangeSet1, rangeSet2) {\n        var i1 = getRangeSetIterator(rangeSet2);\n        var nextResult1 = i1.next();\n        if (nextResult1.done)\n            return false;\n        var a = nextResult1.value;\n        var i2 = getRangeSetIterator(rangeSet1);\n        var nextResult2 = i2.next(a.from);\n        var b = nextResult2.value;\n        while (!nextResult1.done && !nextResult2.done) {\n            if (cmp(b.from, a.to) <= 0 && cmp(b.to, a.from) >= 0)\n                return true;\n            cmp(a.from, b.from) < 0\n                ? (a = (nextResult1 = i1.next(b.from)).value)\n                : (b = (nextResult2 = i2.next(a.from)).value);\n        }\n        return false;\n    }\n    function getRangeSetIterator(node) {\n        var state = isEmptyRange(node) ? null : { s: 0, n: node };\n        return {\n            next: function (key) {\n                var keyProvided = arguments.length > 0;\n                while (state) {\n                    switch (state.s) {\n                        case 0:\n                            state.s = 1;\n                            if (keyProvided) {\n                                while (state.n.l && cmp(key, state.n.from) < 0)\n                                    state = { up: state, n: state.n.l, s: 1 };\n                            }\n                            else {\n                                while (state.n.l)\n                                    state = { up: state, n: state.n.l, s: 1 };\n                            }\n                        case 1:\n                            state.s = 2;\n                            if (!keyProvided || cmp(key, state.n.to) <= 0)\n                                return { value: state.n, done: false };\n                        case 2:\n                            if (state.n.r) {\n                                state.s = 3;\n                                state = { up: state, n: state.n.r, s: 0 };\n                                continue;\n                            }\n                        case 3:\n                            state = state.up;\n                    }\n                }\n                return { done: true };\n            },\n        };\n    }\n    function rebalance(target) {\n        var _a, _b;\n        var diff = (((_a = target.r) === null || _a === void 0 ? void 0 : _a.d) || 0) - (((_b = target.l) === null || _b === void 0 ? void 0 : _b.d) || 0);\n        var r = diff > 1 ? \"r\" : diff < -1 ? \"l\" : \"\";\n        if (r) {\n            var l = r === \"r\" ? \"l\" : \"r\";\n            var rootClone = __assign({}, target);\n            var oldRootRight = target[r];\n            target.from = oldRootRight.from;\n            target.to = oldRootRight.to;\n            target[r] = oldRootRight[r];\n            rootClone[r] = oldRootRight[l];\n            target[l] = rootClone;\n            rootClone.d = computeDepth(rootClone);\n        }\n        target.d = computeDepth(target);\n    }\n    function computeDepth(_a) {\n        var r = _a.r, l = _a.l;\n        return (r ? (l ? Math.max(r.d, l.d) : r.d) : l ? l.d : 0) + 1;\n    }\n\n    function extendObservabilitySet(target, newSet) {\n        keys(newSet).forEach(function (part) {\n            if (target[part])\n                mergeRanges(target[part], newSet[part]);\n            else\n                target[part] = cloneSimpleObjectTree(newSet[part]);\n        });\n        return target;\n    }\n\n    function obsSetsOverlap(os1, os2) {\n        return os1.all || os2.all || Object.keys(os1).some(function (key) { return os2[key] && rangesOverlap(os2[key], os1[key]); });\n    }\n\n    var cache = {};\n\n    var unsignaledParts = {};\n    var isTaskEnqueued = false;\n    function signalSubscribersLazily(part, optimistic) {\n        extendObservabilitySet(unsignaledParts, part);\n        if (!isTaskEnqueued) {\n            isTaskEnqueued = true;\n            setTimeout(function () {\n                isTaskEnqueued = false;\n                var parts = unsignaledParts;\n                unsignaledParts = {};\n                signalSubscribersNow(parts, false);\n            }, 0);\n        }\n    }\n    function signalSubscribersNow(updatedParts, deleteAffectedCacheEntries) {\n        if (deleteAffectedCacheEntries === void 0) { deleteAffectedCacheEntries = false; }\n        var queriesToSignal = new Set();\n        if (updatedParts.all) {\n            for (var _i = 0, _a = Object.values(cache); _i < _a.length; _i++) {\n                var tblCache = _a[_i];\n                collectTableSubscribers(tblCache, updatedParts, queriesToSignal, deleteAffectedCacheEntries);\n            }\n        }\n        else {\n            for (var key in updatedParts) {\n                var parts = /^idb\\:\\/\\/(.*)\\/(.*)\\//.exec(key);\n                if (parts) {\n                    var dbName = parts[1], tableName = parts[2];\n                    var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n                    if (tblCache)\n                        collectTableSubscribers(tblCache, updatedParts, queriesToSignal, deleteAffectedCacheEntries);\n                }\n            }\n        }\n        queriesToSignal.forEach(function (requery) { return requery(); });\n    }\n    function collectTableSubscribers(tblCache, updatedParts, outQueriesToSignal, deleteAffectedCacheEntries) {\n        var updatedEntryLists = [];\n        for (var _i = 0, _a = Object.entries(tblCache.queries.query); _i < _a.length; _i++) {\n            var _b = _a[_i], indexName = _b[0], entries = _b[1];\n            var filteredEntries = [];\n            for (var _c = 0, entries_1 = entries; _c < entries_1.length; _c++) {\n                var entry = entries_1[_c];\n                if (obsSetsOverlap(updatedParts, entry.obsSet)) {\n                    entry.subscribers.forEach(function (requery) { return outQueriesToSignal.add(requery); });\n                }\n                else if (deleteAffectedCacheEntries) {\n                    filteredEntries.push(entry);\n                }\n            }\n            if (deleteAffectedCacheEntries)\n                updatedEntryLists.push([indexName, filteredEntries]);\n        }\n        if (deleteAffectedCacheEntries) {\n            for (var _d = 0, updatedEntryLists_1 = updatedEntryLists; _d < updatedEntryLists_1.length; _d++) {\n                var _e = updatedEntryLists_1[_d], indexName = _e[0], filteredEntries = _e[1];\n                tblCache.queries.query[indexName] = filteredEntries;\n            }\n        }\n    }\n\n    function dexieOpen(db) {\n        var state = db._state;\n        var indexedDB = db._deps.indexedDB;\n        if (state.isBeingOpened || db.idbdb)\n            return state.dbReadyPromise.then(function () { return state.dbOpenError ?\n                rejection(state.dbOpenError) :\n                db; });\n        state.isBeingOpened = true;\n        state.dbOpenError = null;\n        state.openComplete = false;\n        var openCanceller = state.openCanceller;\n        var nativeVerToOpen = Math.round(db.verno * 10);\n        var schemaPatchMode = false;\n        function throwIfCancelled() {\n            if (state.openCanceller !== openCanceller)\n                throw new exceptions.DatabaseClosed('db.open() was cancelled');\n        }\n        var resolveDbReady = state.dbReadyResolve,\n        upgradeTransaction = null, wasCreated = false;\n        var tryOpenDB = function () { return new DexiePromise(function (resolve, reject) {\n            throwIfCancelled();\n            if (!indexedDB)\n                throw new exceptions.MissingAPI();\n            var dbName = db.name;\n            var req = state.autoSchema || !nativeVerToOpen ?\n                indexedDB.open(dbName) :\n                indexedDB.open(dbName, nativeVerToOpen);\n            if (!req)\n                throw new exceptions.MissingAPI();\n            req.onerror = eventRejectHandler(reject);\n            req.onblocked = wrap(db._fireOnBlocked);\n            req.onupgradeneeded = wrap(function (e) {\n                upgradeTransaction = req.transaction;\n                if (state.autoSchema && !db._options.allowEmptyDB) {\n                    req.onerror = preventDefault;\n                    upgradeTransaction.abort();\n                    req.result.close();\n                    var delreq = indexedDB.deleteDatabase(dbName);\n                    delreq.onsuccess = delreq.onerror = wrap(function () {\n                        reject(new exceptions.NoSuchDatabase(\"Database \".concat(dbName, \" doesnt exist\")));\n                    });\n                }\n                else {\n                    upgradeTransaction.onerror = eventRejectHandler(reject);\n                    var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion;\n                    wasCreated = oldVer < 1;\n                    db.idbdb = req.result;\n                    if (schemaPatchMode) {\n                        patchCurrentVersion(db, upgradeTransaction);\n                    }\n                    runUpgraders(db, oldVer / 10, upgradeTransaction, reject);\n                }\n            }, reject);\n            req.onsuccess = wrap(function () {\n                upgradeTransaction = null;\n                var idbdb = db.idbdb = req.result;\n                var objectStoreNames = slice(idbdb.objectStoreNames);\n                if (objectStoreNames.length > 0)\n                    try {\n                        var tmpTrans = idbdb.transaction(safariMultiStoreFix(objectStoreNames), 'readonly');\n                        if (state.autoSchema)\n                            readGlobalSchema(db, idbdb, tmpTrans);\n                        else {\n                            adjustToExistingIndexNames(db, db._dbSchema, tmpTrans);\n                            if (!verifyInstalledSchema(db, tmpTrans) && !schemaPatchMode) {\n                                console.warn(\"Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this.\");\n                                idbdb.close();\n                                nativeVerToOpen = idbdb.version + 1;\n                                schemaPatchMode = true;\n                                return resolve(tryOpenDB());\n                            }\n                        }\n                        generateMiddlewareStacks(db, tmpTrans);\n                    }\n                    catch (e) {\n                    }\n                connections.push(db);\n                idbdb.onversionchange = wrap(function (ev) {\n                    state.vcFired = true;\n                    db.on(\"versionchange\").fire(ev);\n                });\n                idbdb.onclose = wrap(function (ev) {\n                    db.on(\"close\").fire(ev);\n                });\n                if (wasCreated)\n                    _onDatabaseCreated(db._deps, dbName);\n                resolve();\n            }, reject);\n        }).catch(function (err) {\n            switch (err === null || err === void 0 ? void 0 : err.name) {\n                case \"UnknownError\":\n                    if (state.PR1398_maxLoop > 0) {\n                        state.PR1398_maxLoop--;\n                        console.warn('Dexie: Workaround for Chrome UnknownError on open()');\n                        return tryOpenDB();\n                    }\n                    break;\n                case \"VersionError\":\n                    if (nativeVerToOpen > 0) {\n                        nativeVerToOpen = 0;\n                        return tryOpenDB();\n                    }\n                    break;\n            }\n            return DexiePromise.reject(err);\n        }); };\n        return DexiePromise.race([\n            openCanceller,\n            (typeof navigator === 'undefined' ? DexiePromise.resolve() : idbReady()).then(tryOpenDB)\n        ]).then(function () {\n            throwIfCancelled();\n            state.onReadyBeingFired = [];\n            return DexiePromise.resolve(vip(function () { return db.on.ready.fire(db.vip); })).then(function fireRemainders() {\n                if (state.onReadyBeingFired.length > 0) {\n                    var remainders_1 = state.onReadyBeingFired.reduce(promisableChain, nop);\n                    state.onReadyBeingFired = [];\n                    return DexiePromise.resolve(vip(function () { return remainders_1(db.vip); })).then(fireRemainders);\n                }\n            });\n        }).finally(function () {\n            if (state.openCanceller === openCanceller) {\n                state.onReadyBeingFired = null;\n                state.isBeingOpened = false;\n            }\n        }).catch(function (err) {\n            state.dbOpenError = err;\n            try {\n                upgradeTransaction && upgradeTransaction.abort();\n            }\n            catch (_a) { }\n            if (openCanceller === state.openCanceller) {\n                db._close();\n            }\n            return rejection(err);\n        }).finally(function () {\n            state.openComplete = true;\n            resolveDbReady();\n        }).then(function () {\n            if (wasCreated) {\n                var everything_1 = {};\n                db.tables.forEach(function (table) {\n                    table.schema.indexes.forEach(function (idx) {\n                        if (idx.name)\n                            everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/\").concat(idx.name)] = new RangeSet(-Infinity, [[[]]]);\n                    });\n                    everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/\")] = everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/:dels\")] = new RangeSet(-Infinity, [[[]]]);\n                });\n                globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME).fire(everything_1);\n                signalSubscribersNow(everything_1, true);\n            }\n            return db;\n        });\n    }\n\n    function awaitIterator(iterator) {\n        var callNext = function (result) { return iterator.next(result); }, doThrow = function (error) { return iterator.throw(error); }, onSuccess = step(callNext), onError = step(doThrow);\n        function step(getNext) {\n            return function (val) {\n                var next = getNext(val), value = next.value;\n                return next.done ? value :\n                    (!value || typeof value.then !== 'function' ?\n                        isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) :\n                        value.then(onSuccess, onError));\n            };\n        }\n        return step(callNext)();\n    }\n\n    function extractTransactionArgs(mode, _tableArgs_, scopeFunc) {\n        var i = arguments.length;\n        if (i < 2)\n            throw new exceptions.InvalidArgument(\"Too few arguments\");\n        var args = new Array(i - 1);\n        while (--i)\n            args[i - 1] = arguments[i];\n        scopeFunc = args.pop();\n        var tables = flatten(args);\n        return [mode, tables, scopeFunc];\n    }\n    function enterTransactionScope(db, mode, storeNames, parentTransaction, scopeFunc) {\n        return DexiePromise.resolve().then(function () {\n            var transless = PSD.transless || PSD;\n            var trans = db._createTransaction(mode, storeNames, db._dbSchema, parentTransaction);\n            trans.explicit = true;\n            var zoneProps = {\n                trans: trans,\n                transless: transless\n            };\n            if (parentTransaction) {\n                trans.idbtrans = parentTransaction.idbtrans;\n            }\n            else {\n                try {\n                    trans.create();\n                    trans.idbtrans._explicit = true;\n                    db._state.PR1398_maxLoop = 3;\n                }\n                catch (ex) {\n                    if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                        console.warn('Dexie: Need to reopen db');\n                        db.close({ disableAutoOpen: false });\n                        return db.open().then(function () { return enterTransactionScope(db, mode, storeNames, null, scopeFunc); });\n                    }\n                    return rejection(ex);\n                }\n            }\n            var scopeFuncIsAsync = isAsyncFunction(scopeFunc);\n            if (scopeFuncIsAsync) {\n                incrementExpectedAwaits();\n            }\n            var returnValue;\n            var promiseFollowed = DexiePromise.follow(function () {\n                returnValue = scopeFunc.call(trans, trans);\n                if (returnValue) {\n                    if (scopeFuncIsAsync) {\n                        var decrementor = decrementExpectedAwaits.bind(null, null);\n                        returnValue.then(decrementor, decrementor);\n                    }\n                    else if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n                        returnValue = awaitIterator(returnValue);\n                    }\n                }\n            }, zoneProps);\n            return (returnValue && typeof returnValue.then === 'function' ?\n                DexiePromise.resolve(returnValue).then(function (x) { return trans.active ?\n                    x\n                    : rejection(new exceptions.PrematureCommit(\"Transaction committed too early. See http://bit.ly/2kdckMn\")); })\n                : promiseFollowed.then(function () { return returnValue; })).then(function (x) {\n                if (parentTransaction)\n                    trans._resolve();\n                return trans._completion.then(function () { return x; });\n            }).catch(function (e) {\n                trans._reject(e);\n                return rejection(e);\n            });\n        });\n    }\n\n    function pad(a, value, count) {\n        var result = isArray(a) ? a.slice() : [a];\n        for (var i = 0; i < count; ++i)\n            result.push(value);\n        return result;\n    }\n    function createVirtualIndexMiddleware(down) {\n        return __assign(__assign({}, down), { table: function (tableName) {\n                var table = down.table(tableName);\n                var schema = table.schema;\n                var indexLookup = {};\n                var allVirtualIndexes = [];\n                function addVirtualIndexes(keyPath, keyTail, lowLevelIndex) {\n                    var keyPathAlias = getKeyPathAlias(keyPath);\n                    var indexList = (indexLookup[keyPathAlias] = indexLookup[keyPathAlias] || []);\n                    var keyLength = keyPath == null ? 0 : typeof keyPath === 'string' ? 1 : keyPath.length;\n                    var isVirtual = keyTail > 0;\n                    var virtualIndex = __assign(__assign({}, lowLevelIndex), { name: isVirtual\n                            ? \"\".concat(keyPathAlias, \"(virtual-from:\").concat(lowLevelIndex.name, \")\")\n                            : lowLevelIndex.name, lowLevelIndex: lowLevelIndex, isVirtual: isVirtual, keyTail: keyTail, keyLength: keyLength, extractKey: getKeyExtractor(keyPath), unique: !isVirtual && lowLevelIndex.unique });\n                    indexList.push(virtualIndex);\n                    if (!virtualIndex.isPrimaryKey) {\n                        allVirtualIndexes.push(virtualIndex);\n                    }\n                    if (keyLength > 1) {\n                        var virtualKeyPath = keyLength === 2 ?\n                            keyPath[0] :\n                            keyPath.slice(0, keyLength - 1);\n                        addVirtualIndexes(virtualKeyPath, keyTail + 1, lowLevelIndex);\n                    }\n                    indexList.sort(function (a, b) { return a.keyTail - b.keyTail; });\n                    return virtualIndex;\n                }\n                var primaryKey = addVirtualIndexes(schema.primaryKey.keyPath, 0, schema.primaryKey);\n                indexLookup[\":id\"] = [primaryKey];\n                for (var _i = 0, _a = schema.indexes; _i < _a.length; _i++) {\n                    var index = _a[_i];\n                    addVirtualIndexes(index.keyPath, 0, index);\n                }\n                function findBestIndex(keyPath) {\n                    var result = indexLookup[getKeyPathAlias(keyPath)];\n                    return result && result[0];\n                }\n                function translateRange(range, keyTail) {\n                    return {\n                        type: range.type === 1  ?\n                            2  :\n                            range.type,\n                        lower: pad(range.lower, range.lowerOpen ? down.MAX_KEY : down.MIN_KEY, keyTail),\n                        lowerOpen: true,\n                        upper: pad(range.upper, range.upperOpen ? down.MIN_KEY : down.MAX_KEY, keyTail),\n                        upperOpen: true\n                    };\n                }\n                function translateRequest(req) {\n                    var index = req.query.index;\n                    return index.isVirtual ? __assign(__assign({}, req), { query: {\n                            index: index.lowLevelIndex,\n                            range: translateRange(req.query.range, index.keyTail)\n                        } }) : req;\n                }\n                var result = __assign(__assign({}, table), { schema: __assign(__assign({}, schema), { primaryKey: primaryKey, indexes: allVirtualIndexes, getIndexByKeyPath: findBestIndex }), count: function (req) {\n                        return table.count(translateRequest(req));\n                    }, query: function (req) {\n                        return table.query(translateRequest(req));\n                    }, openCursor: function (req) {\n                        var _a = req.query.index, keyTail = _a.keyTail, isVirtual = _a.isVirtual, keyLength = _a.keyLength;\n                        if (!isVirtual)\n                            return table.openCursor(req);\n                        function createVirtualCursor(cursor) {\n                            function _continue(key) {\n                                key != null ?\n                                    cursor.continue(pad(key, req.reverse ? down.MAX_KEY : down.MIN_KEY, keyTail)) :\n                                    req.unique ?\n                                        cursor.continue(cursor.key.slice(0, keyLength)\n                                            .concat(req.reverse\n                                            ? down.MIN_KEY\n                                            : down.MAX_KEY, keyTail)) :\n                                        cursor.continue();\n                            }\n                            var virtualCursor = Object.create(cursor, {\n                                continue: { value: _continue },\n                                continuePrimaryKey: {\n                                    value: function (key, primaryKey) {\n                                        cursor.continuePrimaryKey(pad(key, down.MAX_KEY, keyTail), primaryKey);\n                                    }\n                                },\n                                primaryKey: {\n                                    get: function () {\n                                        return cursor.primaryKey;\n                                    }\n                                },\n                                key: {\n                                    get: function () {\n                                        var key = cursor.key;\n                                        return keyLength === 1 ?\n                                            key[0] :\n                                            key.slice(0, keyLength);\n                                    }\n                                },\n                                value: {\n                                    get: function () {\n                                        return cursor.value;\n                                    }\n                                }\n                            });\n                            return virtualCursor;\n                        }\n                        return table.openCursor(translateRequest(req))\n                            .then(function (cursor) { return cursor && createVirtualCursor(cursor); });\n                    } });\n                return result;\n            } });\n    }\n    var virtualIndexMiddleware = {\n        stack: \"dbcore\",\n        name: \"VirtualIndexMiddleware\",\n        level: 1,\n        create: createVirtualIndexMiddleware\n    };\n\n    function getObjectDiff(a, b, rv, prfx) {\n        rv = rv || {};\n        prfx = prfx || '';\n        keys(a).forEach(function (prop) {\n            if (!hasOwn(b, prop)) {\n                rv[prfx + prop] = undefined;\n            }\n            else {\n                var ap = a[prop], bp = b[prop];\n                if (typeof ap === 'object' && typeof bp === 'object' && ap && bp) {\n                    var apTypeName = toStringTag(ap);\n                    var bpTypeName = toStringTag(bp);\n                    if (apTypeName !== bpTypeName) {\n                        rv[prfx + prop] = b[prop];\n                    }\n                    else if (apTypeName === 'Object') {\n                        getObjectDiff(ap, bp, rv, prfx + prop + '.');\n                    }\n                    else if (ap !== bp) {\n                        rv[prfx + prop] = b[prop];\n                    }\n                }\n                else if (ap !== bp)\n                    rv[prfx + prop] = b[prop];\n            }\n        });\n        keys(b).forEach(function (prop) {\n            if (!hasOwn(a, prop)) {\n                rv[prfx + prop] = b[prop];\n            }\n        });\n        return rv;\n    }\n\n    function getEffectiveKeys(primaryKey, req) {\n        if (req.type === 'delete')\n            return req.keys;\n        return req.keys || req.values.map(primaryKey.extractKey);\n    }\n\n    var hooksMiddleware = {\n        stack: \"dbcore\",\n        name: \"HooksMiddleware\",\n        level: 2,\n        create: function (downCore) { return (__assign(__assign({}, downCore), { table: function (tableName) {\n                var downTable = downCore.table(tableName);\n                var primaryKey = downTable.schema.primaryKey;\n                var tableMiddleware = __assign(__assign({}, downTable), { mutate: function (req) {\n                        var dxTrans = PSD.trans;\n                        var _a = dxTrans.table(tableName).hook, deleting = _a.deleting, creating = _a.creating, updating = _a.updating;\n                        switch (req.type) {\n                            case 'add':\n                                if (creating.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'put':\n                                if (creating.fire === nop && updating.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'delete':\n                                if (deleting.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'deleteRange':\n                                if (deleting.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return deleteRange(req); }, true);\n                        }\n                        return downTable.mutate(req);\n                        function addPutOrDelete(req) {\n                            var dxTrans = PSD.trans;\n                            var keys = req.keys || getEffectiveKeys(primaryKey, req);\n                            if (!keys)\n                                throw new Error(\"Keys missing\");\n                            req = req.type === 'add' || req.type === 'put' ? __assign(__assign({}, req), { keys: keys }) : __assign({}, req);\n                            if (req.type !== 'delete')\n                                req.values = __spreadArray([], req.values, true);\n                            if (req.keys)\n                                req.keys = __spreadArray([], req.keys, true);\n                            return getExistingValues(downTable, req, keys).then(function (existingValues) {\n                                var contexts = keys.map(function (key, i) {\n                                    var existingValue = existingValues[i];\n                                    var ctx = { onerror: null, onsuccess: null };\n                                    if (req.type === 'delete') {\n                                        deleting.fire.call(ctx, key, existingValue, dxTrans);\n                                    }\n                                    else if (req.type === 'add' || existingValue === undefined) {\n                                        var generatedPrimaryKey = creating.fire.call(ctx, key, req.values[i], dxTrans);\n                                        if (key == null && generatedPrimaryKey != null) {\n                                            key = generatedPrimaryKey;\n                                            req.keys[i] = key;\n                                            if (!primaryKey.outbound) {\n                                                setByKeyPath(req.values[i], primaryKey.keyPath, key);\n                                            }\n                                        }\n                                    }\n                                    else {\n                                        var objectDiff = getObjectDiff(existingValue, req.values[i]);\n                                        var additionalChanges_1 = updating.fire.call(ctx, objectDiff, key, existingValue, dxTrans);\n                                        if (additionalChanges_1) {\n                                            var requestedValue_1 = req.values[i];\n                                            Object.keys(additionalChanges_1).forEach(function (keyPath) {\n                                                if (hasOwn(requestedValue_1, keyPath)) {\n                                                    requestedValue_1[keyPath] = additionalChanges_1[keyPath];\n                                                }\n                                                else {\n                                                    setByKeyPath(requestedValue_1, keyPath, additionalChanges_1[keyPath]);\n                                                }\n                                            });\n                                        }\n                                    }\n                                    return ctx;\n                                });\n                                return downTable.mutate(req).then(function (_a) {\n                                    var failures = _a.failures, results = _a.results, numFailures = _a.numFailures, lastResult = _a.lastResult;\n                                    for (var i = 0; i < keys.length; ++i) {\n                                        var primKey = results ? results[i] : keys[i];\n                                        var ctx = contexts[i];\n                                        if (primKey == null) {\n                                            ctx.onerror && ctx.onerror(failures[i]);\n                                        }\n                                        else {\n                                            ctx.onsuccess && ctx.onsuccess(req.type === 'put' && existingValues[i] ?\n                                                req.values[i] :\n                                                primKey\n                                            );\n                                        }\n                                    }\n                                    return { failures: failures, results: results, numFailures: numFailures, lastResult: lastResult };\n                                }).catch(function (error) {\n                                    contexts.forEach(function (ctx) { return ctx.onerror && ctx.onerror(error); });\n                                    return Promise.reject(error);\n                                });\n                            });\n                        }\n                        function deleteRange(req) {\n                            return deleteNextChunk(req.trans, req.range, 10000);\n                        }\n                        function deleteNextChunk(trans, range, limit) {\n                            return downTable.query({ trans: trans, values: false, query: { index: primaryKey, range: range }, limit: limit })\n                                .then(function (_a) {\n                                var result = _a.result;\n                                return addPutOrDelete({ type: 'delete', keys: result, trans: trans }).then(function (res) {\n                                    if (res.numFailures > 0)\n                                        return Promise.reject(res.failures[0]);\n                                    if (result.length < limit) {\n                                        return { failures: [], numFailures: 0, lastResult: undefined };\n                                    }\n                                    else {\n                                        return deleteNextChunk(trans, __assign(__assign({}, range), { lower: result[result.length - 1], lowerOpen: true }), limit);\n                                    }\n                                });\n                            });\n                        }\n                    } });\n                return tableMiddleware;\n            } })); }\n    };\n    function getExistingValues(table, req, effectiveKeys) {\n        return req.type === \"add\"\n            ? Promise.resolve([])\n            : table.getMany({ trans: req.trans, keys: effectiveKeys, cache: \"immutable\" });\n    }\n\n    function getFromTransactionCache(keys, cache, clone) {\n        try {\n            if (!cache)\n                return null;\n            if (cache.keys.length < keys.length)\n                return null;\n            var result = [];\n            for (var i = 0, j = 0; i < cache.keys.length && j < keys.length; ++i) {\n                if (cmp(cache.keys[i], keys[j]) !== 0)\n                    continue;\n                result.push(clone ? deepClone(cache.values[i]) : cache.values[i]);\n                ++j;\n            }\n            return result.length === keys.length ? result : null;\n        }\n        catch (_a) {\n            return null;\n        }\n    }\n    var cacheExistingValuesMiddleware = {\n        stack: \"dbcore\",\n        level: -1,\n        create: function (core) {\n            return {\n                table: function (tableName) {\n                    var table = core.table(tableName);\n                    return __assign(__assign({}, table), { getMany: function (req) {\n                            if (!req.cache) {\n                                return table.getMany(req);\n                            }\n                            var cachedResult = getFromTransactionCache(req.keys, req.trans[\"_cache\"], req.cache === \"clone\");\n                            if (cachedResult) {\n                                return DexiePromise.resolve(cachedResult);\n                            }\n                            return table.getMany(req).then(function (res) {\n                                req.trans[\"_cache\"] = {\n                                    keys: req.keys,\n                                    values: req.cache === \"clone\" ? deepClone(res) : res,\n                                };\n                                return res;\n                            });\n                        }, mutate: function (req) {\n                            if (req.type !== \"add\")\n                                req.trans[\"_cache\"] = null;\n                            return table.mutate(req);\n                        } });\n                },\n            };\n        },\n    };\n\n    function isCachableContext(ctx, table) {\n        return (ctx.trans.mode === 'readonly' &&\n            !!ctx.subscr &&\n            !ctx.trans.explicit &&\n            ctx.trans.db._options.cache !== 'disabled' &&\n            !table.schema.primaryKey.outbound);\n    }\n\n    function isCachableRequest(type, req) {\n        switch (type) {\n            case 'query':\n                return req.values && !req.unique;\n            case 'get':\n                return false;\n            case 'getMany':\n                return false;\n            case 'count':\n                return false;\n            case 'openCursor':\n                return false;\n        }\n    }\n\n    var observabilityMiddleware = {\n        stack: \"dbcore\",\n        level: 0,\n        name: \"Observability\",\n        create: function (core) {\n            var dbName = core.schema.name;\n            var FULL_RANGE = new RangeSet(core.MIN_KEY, core.MAX_KEY);\n            return __assign(__assign({}, core), { transaction: function (stores, mode, options) {\n                    if (PSD.subscr && mode !== 'readonly') {\n                        throw new exceptions.ReadOnly(\"Readwrite transaction in liveQuery context. Querier source: \".concat(PSD.querier));\n                    }\n                    return core.transaction(stores, mode, options);\n                }, table: function (tableName) {\n                    var table = core.table(tableName);\n                    var schema = table.schema;\n                    var primaryKey = schema.primaryKey, indexes = schema.indexes;\n                    var extractKey = primaryKey.extractKey, outbound = primaryKey.outbound;\n                    var indexesWithAutoIncPK = primaryKey.autoIncrement && indexes.filter(function (index) { return index.compound && index.keyPath.includes(primaryKey.keyPath); });\n                    var tableClone = __assign(__assign({}, table), { mutate: function (req) {\n                            var _a, _b;\n                            var trans = req.trans;\n                            var mutatedParts = req.mutatedParts || (req.mutatedParts = {});\n                            var getRangeSet = function (indexName) {\n                                var part = \"idb://\".concat(dbName, \"/\").concat(tableName, \"/\").concat(indexName);\n                                return (mutatedParts[part] ||\n                                    (mutatedParts[part] = new RangeSet()));\n                            };\n                            var pkRangeSet = getRangeSet(\"\");\n                            var delsRangeSet = getRangeSet(\":dels\");\n                            var type = req.type;\n                            var _c = req.type === \"deleteRange\"\n                                ? [req.range]\n                                : req.type === \"delete\"\n                                    ? [req.keys]\n                                    : req.values.length < 50\n                                        ? [getEffectiveKeys(primaryKey, req).filter(function (id) { return id; }), req.values]\n                                        : [], keys = _c[0], newObjs = _c[1];\n                            var oldCache = req.trans[\"_cache\"];\n                            if (isArray(keys)) {\n                                pkRangeSet.addKeys(keys);\n                                var oldObjs = type === 'delete' || keys.length === newObjs.length ? getFromTransactionCache(keys, oldCache) : null;\n                                if (!oldObjs) {\n                                    delsRangeSet.addKeys(keys);\n                                }\n                                if (oldObjs || newObjs) {\n                                    trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs);\n                                }\n                            }\n                            else if (keys) {\n                                var range = {\n                                    from: (_a = keys.lower) !== null && _a !== void 0 ? _a : core.MIN_KEY,\n                                    to: (_b = keys.upper) !== null && _b !== void 0 ? _b : core.MAX_KEY\n                                };\n                                delsRangeSet.add(range);\n                                pkRangeSet.add(range);\n                            }\n                            else {\n                                pkRangeSet.add(FULL_RANGE);\n                                delsRangeSet.add(FULL_RANGE);\n                                schema.indexes.forEach(function (idx) { return getRangeSet(idx.name).add(FULL_RANGE); });\n                            }\n                            return table.mutate(req).then(function (res) {\n                                if (keys && (req.type === 'add' || req.type === 'put')) {\n                                    pkRangeSet.addKeys(res.results);\n                                    if (indexesWithAutoIncPK) {\n                                        indexesWithAutoIncPK.forEach(function (idx) {\n                                            var idxVals = req.values.map(function (v) { return idx.extractKey(v); });\n                                            var pkPos = idx.keyPath.findIndex(function (prop) { return prop === primaryKey.keyPath; });\n                                            for (var i = 0, len = res.results.length; i < len; ++i) {\n                                                idxVals[i][pkPos] = res.results[i];\n                                            }\n                                            getRangeSet(idx.name).addKeys(idxVals);\n                                        });\n                                    }\n                                }\n                                trans.mutatedParts = extendObservabilitySet(trans.mutatedParts || {}, mutatedParts);\n                                return res;\n                            });\n                        } });\n                    var getRange = function (_a) {\n                        var _b, _c;\n                        var _d = _a.query, index = _d.index, range = _d.range;\n                        return [\n                            index,\n                            new RangeSet((_b = range.lower) !== null && _b !== void 0 ? _b : core.MIN_KEY, (_c = range.upper) !== null && _c !== void 0 ? _c : core.MAX_KEY),\n                        ];\n                    };\n                    var readSubscribers = {\n                        get: function (req) { return [primaryKey, new RangeSet(req.key)]; },\n                        getMany: function (req) { return [primaryKey, new RangeSet().addKeys(req.keys)]; },\n                        count: getRange,\n                        query: getRange,\n                        openCursor: getRange,\n                    };\n                    keys(readSubscribers).forEach(function (method) {\n                        tableClone[method] = function (req) {\n                            var subscr = PSD.subscr;\n                            var isLiveQuery = !!subscr;\n                            var cachable = isCachableContext(PSD, table) && isCachableRequest(method, req);\n                            var obsSet = cachable\n                                ? req.obsSet = {}\n                                : subscr;\n                            if (isLiveQuery) {\n                                var getRangeSet = function (indexName) {\n                                    var part = \"idb://\".concat(dbName, \"/\").concat(tableName, \"/\").concat(indexName);\n                                    return (obsSet[part] ||\n                                        (obsSet[part] = new RangeSet()));\n                                };\n                                var pkRangeSet_1 = getRangeSet(\"\");\n                                var delsRangeSet_1 = getRangeSet(\":dels\");\n                                var _a = readSubscribers[method](req), queriedIndex = _a[0], queriedRanges = _a[1];\n                                if (method === 'query' && queriedIndex.isPrimaryKey && !req.values) {\n                                    delsRangeSet_1.add(queriedRanges);\n                                }\n                                else {\n                                    getRangeSet(queriedIndex.name || \"\").add(queriedRanges);\n                                }\n                                if (!queriedIndex.isPrimaryKey) {\n                                    if (method === \"count\") {\n                                        delsRangeSet_1.add(FULL_RANGE);\n                                    }\n                                    else {\n                                        var keysPromise_1 = method === \"query\" &&\n                                            outbound &&\n                                            req.values &&\n                                            table.query(__assign(__assign({}, req), { values: false }));\n                                        return table[method].apply(this, arguments).then(function (res) {\n                                            if (method === \"query\") {\n                                                if (outbound && req.values) {\n                                                    return keysPromise_1.then(function (_a) {\n                                                        var resultingKeys = _a.result;\n                                                        pkRangeSet_1.addKeys(resultingKeys);\n                                                        return res;\n                                                    });\n                                                }\n                                                var pKeys = req.values\n                                                    ? res.result.map(extractKey)\n                                                    : res.result;\n                                                if (req.values) {\n                                                    pkRangeSet_1.addKeys(pKeys);\n                                                }\n                                                else {\n                                                    delsRangeSet_1.addKeys(pKeys);\n                                                }\n                                            }\n                                            else if (method === \"openCursor\") {\n                                                var cursor_1 = res;\n                                                var wantValues_1 = req.values;\n                                                return (cursor_1 &&\n                                                    Object.create(cursor_1, {\n                                                        key: {\n                                                            get: function () {\n                                                                delsRangeSet_1.addKey(cursor_1.primaryKey);\n                                                                return cursor_1.key;\n                                                            },\n                                                        },\n                                                        primaryKey: {\n                                                            get: function () {\n                                                                var pkey = cursor_1.primaryKey;\n                                                                delsRangeSet_1.addKey(pkey);\n                                                                return pkey;\n                                                            },\n                                                        },\n                                                        value: {\n                                                            get: function () {\n                                                                wantValues_1 && pkRangeSet_1.addKey(cursor_1.primaryKey);\n                                                                return cursor_1.value;\n                                                            },\n                                                        },\n                                                    }));\n                                            }\n                                            return res;\n                                        });\n                                    }\n                                }\n                            }\n                            return table[method].apply(this, arguments);\n                        };\n                    });\n                    return tableClone;\n                } });\n        },\n    };\n    function trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs) {\n        function addAffectedIndex(ix) {\n            var rangeSet = getRangeSet(ix.name || \"\");\n            function extractKey(obj) {\n                return obj != null ? ix.extractKey(obj) : null;\n            }\n            var addKeyOrKeys = function (key) { return ix.multiEntry && isArray(key)\n                ? key.forEach(function (key) { return rangeSet.addKey(key); })\n                : rangeSet.addKey(key); };\n            (oldObjs || newObjs).forEach(function (_, i) {\n                var oldKey = oldObjs && extractKey(oldObjs[i]);\n                var newKey = newObjs && extractKey(newObjs[i]);\n                if (cmp(oldKey, newKey) !== 0) {\n                    if (oldKey != null)\n                        addKeyOrKeys(oldKey);\n                    if (newKey != null)\n                        addKeyOrKeys(newKey);\n                }\n            });\n        }\n        schema.indexes.forEach(addAffectedIndex);\n    }\n\n    function adjustOptimisticFromFailures(tblCache, req, res) {\n        if (res.numFailures === 0)\n            return req;\n        if (req.type === 'deleteRange') {\n            return null;\n        }\n        var numBulkOps = req.keys\n            ? req.keys.length\n            : 'values' in req && req.values\n                ? req.values.length\n                : 1;\n        if (res.numFailures === numBulkOps) {\n            return null;\n        }\n        var clone = __assign({}, req);\n        if (isArray(clone.keys)) {\n            clone.keys = clone.keys.filter(function (_, i) { return !(i in res.failures); });\n        }\n        if ('values' in clone && isArray(clone.values)) {\n            clone.values = clone.values.filter(function (_, i) { return !(i in res.failures); });\n        }\n        return clone;\n    }\n\n    function isAboveLower(key, range) {\n        return range.lower === undefined\n            ? true\n            : range.lowerOpen\n                ? cmp(key, range.lower) > 0\n                : cmp(key, range.lower) >= 0;\n    }\n    function isBelowUpper(key, range) {\n        return range.upper === undefined\n            ? true\n            : range.upperOpen\n                ? cmp(key, range.upper) < 0\n                : cmp(key, range.upper) <= 0;\n    }\n    function isWithinRange(key, range) {\n        return isAboveLower(key, range) && isBelowUpper(key, range);\n    }\n\n    function applyOptimisticOps(result, req, ops, table, cacheEntry, immutable) {\n        if (!ops || ops.length === 0)\n            return result;\n        var index = req.query.index;\n        var multiEntry = index.multiEntry;\n        var queryRange = req.query.range;\n        var primaryKey = table.schema.primaryKey;\n        var extractPrimKey = primaryKey.extractKey;\n        var extractIndex = index.extractKey;\n        var extractLowLevelIndex = (index.lowLevelIndex || index).extractKey;\n        var finalResult = ops.reduce(function (result, op) {\n            var modifedResult = result;\n            var includedValues = [];\n            if (op.type === 'add' || op.type === 'put') {\n                var includedPKs = new RangeSet();\n                for (var i = op.values.length - 1; i >= 0; --i) {\n                    var value = op.values[i];\n                    var pk = extractPrimKey(value);\n                    if (includedPKs.hasKey(pk))\n                        continue;\n                    var key = extractIndex(value);\n                    if (multiEntry && isArray(key)\n                        ? key.some(function (k) { return isWithinRange(k, queryRange); })\n                        : isWithinRange(key, queryRange)) {\n                        includedPKs.addKey(pk);\n                        includedValues.push(value);\n                    }\n                }\n            }\n            switch (op.type) {\n                case 'add': {\n                    var existingKeys_1 = new RangeSet().addKeys(req.values ? result.map(function (v) { return extractPrimKey(v); }) : result);\n                    modifedResult = result.concat(req.values\n                        ? includedValues.filter(function (v) {\n                            var key = extractPrimKey(v);\n                            if (existingKeys_1.hasKey(key))\n                                return false;\n                            existingKeys_1.addKey(key);\n                            return true;\n                        })\n                        : includedValues\n                            .map(function (v) { return extractPrimKey(v); })\n                            .filter(function (k) {\n                            if (existingKeys_1.hasKey(k))\n                                return false;\n                            existingKeys_1.addKey(k);\n                            return true;\n                        }));\n                    break;\n                }\n                case 'put': {\n                    var keySet_1 = new RangeSet().addKeys(op.values.map(function (v) { return extractPrimKey(v); }));\n                    modifedResult = result\n                        .filter(\n                    function (item) { return !keySet_1.hasKey(req.values ? extractPrimKey(item) : item); })\n                        .concat(\n                    req.values\n                        ? includedValues\n                        : includedValues.map(function (v) { return extractPrimKey(v); }));\n                    break;\n                }\n                case 'delete':\n                    var keysToDelete_1 = new RangeSet().addKeys(op.keys);\n                    modifedResult = result.filter(function (item) {\n                        return !keysToDelete_1.hasKey(req.values ? extractPrimKey(item) : item);\n                    });\n                    break;\n                case 'deleteRange':\n                    var range_1 = op.range;\n                    modifedResult = result.filter(function (item) { return !isWithinRange(extractPrimKey(item), range_1); });\n                    break;\n            }\n            return modifedResult;\n        }, result);\n        if (finalResult === result)\n            return result;\n        finalResult.sort(function (a, b) {\n            return cmp(extractLowLevelIndex(a), extractLowLevelIndex(b)) ||\n                cmp(extractPrimKey(a), extractPrimKey(b));\n        });\n        if (req.limit && req.limit < Infinity) {\n            if (finalResult.length > req.limit) {\n                finalResult.length = req.limit;\n            }\n            else if (result.length === req.limit && finalResult.length < req.limit) {\n                cacheEntry.dirty = true;\n            }\n        }\n        return immutable ? Object.freeze(finalResult) : finalResult;\n    }\n\n    function areRangesEqual(r1, r2) {\n        return (cmp(r1.lower, r2.lower) === 0 &&\n            cmp(r1.upper, r2.upper) === 0 &&\n            !!r1.lowerOpen === !!r2.lowerOpen &&\n            !!r1.upperOpen === !!r2.upperOpen);\n    }\n\n    function compareLowers(lower1, lower2, lowerOpen1, lowerOpen2) {\n        if (lower1 === undefined)\n            return lower2 !== undefined ? -1 : 0;\n        if (lower2 === undefined)\n            return 1;\n        var c = cmp(lower1, lower2);\n        if (c === 0) {\n            if (lowerOpen1 && lowerOpen2)\n                return 0;\n            if (lowerOpen1)\n                return 1;\n            if (lowerOpen2)\n                return -1;\n        }\n        return c;\n    }\n    function compareUppers(upper1, upper2, upperOpen1, upperOpen2) {\n        if (upper1 === undefined)\n            return upper2 !== undefined ? 1 : 0;\n        if (upper2 === undefined)\n            return -1;\n        var c = cmp(upper1, upper2);\n        if (c === 0) {\n            if (upperOpen1 && upperOpen2)\n                return 0;\n            if (upperOpen1)\n                return -1;\n            if (upperOpen2)\n                return 1;\n        }\n        return c;\n    }\n    function isSuperRange(r1, r2) {\n        return (compareLowers(r1.lower, r2.lower, r1.lowerOpen, r2.lowerOpen) <= 0 &&\n            compareUppers(r1.upper, r2.upper, r1.upperOpen, r2.upperOpen) >= 0);\n    }\n\n    function findCompatibleQuery(dbName, tableName, type, req) {\n        var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n        if (!tblCache)\n            return [];\n        var queries = tblCache.queries[type];\n        if (!queries)\n            return [null, false, tblCache, null];\n        var indexName = req.query ? req.query.index.name : null;\n        var entries = queries[indexName || ''];\n        if (!entries)\n            return [null, false, tblCache, null];\n        switch (type) {\n            case 'query':\n                var equalEntry = entries.find(function (entry) {\n                    return entry.req.limit === req.limit &&\n                        entry.req.values === req.values &&\n                        areRangesEqual(entry.req.query.range, req.query.range);\n                });\n                if (equalEntry)\n                    return [\n                        equalEntry,\n                        true,\n                        tblCache,\n                        entries,\n                    ];\n                var superEntry = entries.find(function (entry) {\n                    var limit = 'limit' in entry.req ? entry.req.limit : Infinity;\n                    return (limit >= req.limit &&\n                        (req.values ? entry.req.values : true) &&\n                        isSuperRange(entry.req.query.range, req.query.range));\n                });\n                return [superEntry, false, tblCache, entries];\n            case 'count':\n                var countQuery = entries.find(function (entry) {\n                    return areRangesEqual(entry.req.query.range, req.query.range);\n                });\n                return [countQuery, !!countQuery, tblCache, entries];\n        }\n    }\n\n    function subscribeToCacheEntry(cacheEntry, container, requery, signal) {\n        cacheEntry.subscribers.add(requery);\n        signal.addEventListener(\"abort\", function () {\n            cacheEntry.subscribers.delete(requery);\n            if (cacheEntry.subscribers.size === 0) {\n                enqueForDeletion(cacheEntry, container);\n            }\n        });\n    }\n    function enqueForDeletion(cacheEntry, container) {\n        setTimeout(function () {\n            if (cacheEntry.subscribers.size === 0) {\n                delArrayItem(container, cacheEntry);\n            }\n        }, 3000);\n    }\n\n    var cacheMiddleware = {\n        stack: 'dbcore',\n        level: 0,\n        name: 'Cache',\n        create: function (core) {\n            var dbName = core.schema.name;\n            var coreMW = __assign(__assign({}, core), { transaction: function (stores, mode, options) {\n                    var idbtrans = core.transaction(stores, mode, options);\n                    if (mode === 'readwrite') {\n                        var ac_1 = new AbortController();\n                        var signal = ac_1.signal;\n                        var endTransaction = function (wasCommitted) { return function () {\n                            ac_1.abort();\n                            if (mode === 'readwrite') {\n                                var affectedSubscribers_1 = new Set();\n                                for (var _i = 0, stores_1 = stores; _i < stores_1.length; _i++) {\n                                    var storeName = stores_1[_i];\n                                    var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(storeName)];\n                                    if (tblCache) {\n                                        var table = core.table(storeName);\n                                        var ops = tblCache.optimisticOps.filter(function (op) { return op.trans === idbtrans; });\n                                        if (idbtrans._explicit && wasCommitted && idbtrans.mutatedParts) {\n                                            for (var _a = 0, _b = Object.values(tblCache.queries.query); _a < _b.length; _a++) {\n                                                var entries = _b[_a];\n                                                for (var _c = 0, _d = entries.slice(); _c < _d.length; _c++) {\n                                                    var entry = _d[_c];\n                                                    if (obsSetsOverlap(entry.obsSet, idbtrans.mutatedParts)) {\n                                                        delArrayItem(entries, entry);\n                                                        entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                    }\n                                                }\n                                            }\n                                        }\n                                        else if (ops.length > 0) {\n                                            tblCache.optimisticOps = tblCache.optimisticOps.filter(function (op) { return op.trans !== idbtrans; });\n                                            for (var _e = 0, _f = Object.values(tblCache.queries.query); _e < _f.length; _e++) {\n                                                var entries = _f[_e];\n                                                for (var _g = 0, _h = entries.slice(); _g < _h.length; _g++) {\n                                                    var entry = _h[_g];\n                                                    if (entry.res != null &&\n                                                        idbtrans.mutatedParts\n    ) {\n                                                        if (wasCommitted && !entry.dirty) {\n                                                            var freezeResults = Object.isFrozen(entry.res);\n                                                            var modRes = applyOptimisticOps(entry.res, entry.req, ops, table, entry, freezeResults);\n                                                            if (entry.dirty) {\n                                                                delArrayItem(entries, entry);\n                                                                entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                            }\n                                                            else if (modRes !== entry.res) {\n                                                                entry.res = modRes;\n                                                                entry.promise = DexiePromise.resolve({ result: modRes });\n                                                            }\n                                                        }\n                                                        else {\n                                                            if (entry.dirty) {\n                                                                delArrayItem(entries, entry);\n                                                            }\n                                                            entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                                affectedSubscribers_1.forEach(function (requery) { return requery(); });\n                            }\n                        }; };\n                        idbtrans.addEventListener('abort', endTransaction(false), {\n                            signal: signal,\n                        });\n                        idbtrans.addEventListener('error', endTransaction(false), {\n                            signal: signal,\n                        });\n                        idbtrans.addEventListener('complete', endTransaction(true), {\n                            signal: signal,\n                        });\n                    }\n                    return idbtrans;\n                }, table: function (tableName) {\n                    var downTable = core.table(tableName);\n                    var primKey = downTable.schema.primaryKey;\n                    var tableMW = __assign(__assign({}, downTable), { mutate: function (req) {\n                            var trans = PSD.trans;\n                            if (primKey.outbound ||\n                                trans.db._options.cache === 'disabled' ||\n                                trans.explicit ||\n                                trans.idbtrans.mode !== 'readwrite'\n                            ) {\n                                return downTable.mutate(req);\n                            }\n                            var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n                            if (!tblCache)\n                                return downTable.mutate(req);\n                            var promise = downTable.mutate(req);\n                            if ((req.type === 'add' || req.type === 'put') && (req.values.length >= 50 || getEffectiveKeys(primKey, req).some(function (key) { return key == null; }))) {\n                                promise.then(function (res) {\n                                    var reqWithResolvedKeys = __assign(__assign({}, req), { values: req.values.map(function (value, i) {\n                                            var _a;\n                                            if (res.failures[i])\n                                                return value;\n                                            var valueWithKey = ((_a = primKey.keyPath) === null || _a === void 0 ? void 0 : _a.includes('.'))\n                                                ? deepClone(value)\n                                                : __assign({}, value);\n                                            setByKeyPath(valueWithKey, primKey.keyPath, res.results[i]);\n                                            return valueWithKey;\n                                        }) });\n                                    var adjustedReq = adjustOptimisticFromFailures(tblCache, reqWithResolvedKeys, res);\n                                    tblCache.optimisticOps.push(adjustedReq);\n                                    queueMicrotask(function () { return req.mutatedParts && signalSubscribersLazily(req.mutatedParts); });\n                                });\n                            }\n                            else {\n                                tblCache.optimisticOps.push(req);\n                                req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                promise.then(function (res) {\n                                    if (res.numFailures > 0) {\n                                        delArrayItem(tblCache.optimisticOps, req);\n                                        var adjustedReq = adjustOptimisticFromFailures(tblCache, req, res);\n                                        if (adjustedReq) {\n                                            tblCache.optimisticOps.push(adjustedReq);\n                                        }\n                                        req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                    }\n                                });\n                                promise.catch(function () {\n                                    delArrayItem(tblCache.optimisticOps, req);\n                                    req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                });\n                            }\n                            return promise;\n                        }, query: function (req) {\n                            var _a;\n                            if (!isCachableContext(PSD, downTable) || !isCachableRequest(\"query\", req))\n                                return downTable.query(req);\n                            var freezeResults = ((_a = PSD.trans) === null || _a === void 0 ? void 0 : _a.db._options.cache) === 'immutable';\n                            var _b = PSD, requery = _b.requery, signal = _b.signal;\n                            var _c = findCompatibleQuery(dbName, tableName, 'query', req), cacheEntry = _c[0], exactMatch = _c[1], tblCache = _c[2], container = _c[3];\n                            if (cacheEntry && exactMatch) {\n                                cacheEntry.obsSet = req.obsSet;\n                            }\n                            else {\n                                var promise = downTable.query(req).then(function (res) {\n                                    var result = res.result;\n                                    if (cacheEntry)\n                                        cacheEntry.res = result;\n                                    if (freezeResults) {\n                                        for (var i = 0, l = result.length; i < l; ++i) {\n                                            Object.freeze(result[i]);\n                                        }\n                                        Object.freeze(result);\n                                    }\n                                    else {\n                                        res.result = deepClone(result);\n                                    }\n                                    return res;\n                                }).catch(function (error) {\n                                    if (container && cacheEntry)\n                                        delArrayItem(container, cacheEntry);\n                                    return Promise.reject(error);\n                                });\n                                cacheEntry = {\n                                    obsSet: req.obsSet,\n                                    promise: promise,\n                                    subscribers: new Set(),\n                                    type: 'query',\n                                    req: req,\n                                    dirty: false,\n                                };\n                                if (container) {\n                                    container.push(cacheEntry);\n                                }\n                                else {\n                                    container = [cacheEntry];\n                                    if (!tblCache) {\n                                        tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)] = {\n                                            queries: {\n                                                query: {},\n                                                count: {},\n                                            },\n                                            objs: new Map(),\n                                            optimisticOps: [],\n                                            unsignaledParts: {}\n                                        };\n                                    }\n                                    tblCache.queries.query[req.query.index.name || ''] = container;\n                                }\n                            }\n                            subscribeToCacheEntry(cacheEntry, container, requery, signal);\n                            return cacheEntry.promise.then(function (res) {\n                                return {\n                                    result: applyOptimisticOps(res.result, req, tblCache === null || tblCache === void 0 ? void 0 : tblCache.optimisticOps, downTable, cacheEntry, freezeResults),\n                                };\n                            });\n                        } });\n                    return tableMW;\n                } });\n            return coreMW;\n        },\n    };\n\n    function vipify(target, vipDb) {\n        return new Proxy(target, {\n            get: function (target, prop, receiver) {\n                if (prop === 'db')\n                    return vipDb;\n                return Reflect.get(target, prop, receiver);\n            }\n        });\n    }\n\n    var Dexie$1 =  (function () {\n        function Dexie(name, options) {\n            var _this = this;\n            this._middlewares = {};\n            this.verno = 0;\n            var deps = Dexie.dependencies;\n            this._options = options = __assign({\n                addons: Dexie.addons, autoOpen: true,\n                indexedDB: deps.indexedDB, IDBKeyRange: deps.IDBKeyRange, cache: 'cloned' }, options);\n            this._deps = {\n                indexedDB: options.indexedDB,\n                IDBKeyRange: options.IDBKeyRange\n            };\n            var addons = options.addons;\n            this._dbSchema = {};\n            this._versions = [];\n            this._storeNames = [];\n            this._allTables = {};\n            this.idbdb = null;\n            this._novip = this;\n            var state = {\n                dbOpenError: null,\n                isBeingOpened: false,\n                onReadyBeingFired: null,\n                openComplete: false,\n                dbReadyResolve: nop,\n                dbReadyPromise: null,\n                cancelOpen: nop,\n                openCanceller: null,\n                autoSchema: true,\n                PR1398_maxLoop: 3,\n                autoOpen: options.autoOpen,\n            };\n            state.dbReadyPromise = new DexiePromise(function (resolve) {\n                state.dbReadyResolve = resolve;\n            });\n            state.openCanceller = new DexiePromise(function (_, reject) {\n                state.cancelOpen = reject;\n            });\n            this._state = state;\n            this.name = name;\n            this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", \"close\", { ready: [promisableChain, nop] });\n            this.on.ready.subscribe = override(this.on.ready.subscribe, function (subscribe) {\n                return function (subscriber, bSticky) {\n                    Dexie.vip(function () {\n                        var state = _this._state;\n                        if (state.openComplete) {\n                            if (!state.dbOpenError)\n                                DexiePromise.resolve().then(subscriber);\n                            if (bSticky)\n                                subscribe(subscriber);\n                        }\n                        else if (state.onReadyBeingFired) {\n                            state.onReadyBeingFired.push(subscriber);\n                            if (bSticky)\n                                subscribe(subscriber);\n                        }\n                        else {\n                            subscribe(subscriber);\n                            var db_1 = _this;\n                            if (!bSticky)\n                                subscribe(function unsubscribe() {\n                                    db_1.on.ready.unsubscribe(subscriber);\n                                    db_1.on.ready.unsubscribe(unsubscribe);\n                                });\n                        }\n                    });\n                };\n            });\n            this.Collection = createCollectionConstructor(this);\n            this.Table = createTableConstructor(this);\n            this.Transaction = createTransactionConstructor(this);\n            this.Version = createVersionConstructor(this);\n            this.WhereClause = createWhereClauseConstructor(this);\n            this.on(\"versionchange\", function (ev) {\n                if (ev.newVersion > 0)\n                    console.warn(\"Another connection wants to upgrade database '\".concat(_this.name, \"'. Closing db now to resume the upgrade.\"));\n                else\n                    console.warn(\"Another connection wants to delete database '\".concat(_this.name, \"'. Closing db now to resume the delete request.\"));\n                _this.close({ disableAutoOpen: false });\n            });\n            this.on(\"blocked\", function (ev) {\n                if (!ev.newVersion || ev.newVersion < ev.oldVersion)\n                    console.warn(\"Dexie.delete('\".concat(_this.name, \"') was blocked\"));\n                else\n                    console.warn(\"Upgrade '\".concat(_this.name, \"' blocked by other connection holding version \").concat(ev.oldVersion / 10));\n            });\n            this._maxKey = getMaxKey(options.IDBKeyRange);\n            this._createTransaction = function (mode, storeNames, dbschema, parentTransaction) { return new _this.Transaction(mode, storeNames, dbschema, _this._options.chromeTransactionDurability, parentTransaction); };\n            this._fireOnBlocked = function (ev) {\n                _this.on(\"blocked\").fire(ev);\n                connections\n                    .filter(function (c) { return c.name === _this.name && c !== _this && !c._state.vcFired; })\n                    .map(function (c) { return c.on(\"versionchange\").fire(ev); });\n            };\n            this.use(cacheExistingValuesMiddleware);\n            this.use(cacheMiddleware);\n            this.use(observabilityMiddleware);\n            this.use(virtualIndexMiddleware);\n            this.use(hooksMiddleware);\n            var vipDB = new Proxy(this, {\n                get: function (_, prop, receiver) {\n                    if (prop === '_vip')\n                        return true;\n                    if (prop === 'table')\n                        return function (tableName) { return vipify(_this.table(tableName), vipDB); };\n                    var rv = Reflect.get(_, prop, receiver);\n                    if (rv instanceof Table)\n                        return vipify(rv, vipDB);\n                    if (prop === 'tables')\n                        return rv.map(function (t) { return vipify(t, vipDB); });\n                    if (prop === '_createTransaction')\n                        return function () {\n                            var tx = rv.apply(this, arguments);\n                            return vipify(tx, vipDB);\n                        };\n                    return rv;\n                }\n            });\n            this.vip = vipDB;\n            addons.forEach(function (addon) { return addon(_this); });\n        }\n        Dexie.prototype.version = function (versionNumber) {\n            if (isNaN(versionNumber) || versionNumber < 0.1)\n                throw new exceptions.Type(\"Given version is not a positive number\");\n            versionNumber = Math.round(versionNumber * 10) / 10;\n            if (this.idbdb || this._state.isBeingOpened)\n                throw new exceptions.Schema(\"Cannot add version when database is open\");\n            this.verno = Math.max(this.verno, versionNumber);\n            var versions = this._versions;\n            var versionInstance = versions.filter(function (v) { return v._cfg.version === versionNumber; })[0];\n            if (versionInstance)\n                return versionInstance;\n            versionInstance = new this.Version(versionNumber);\n            versions.push(versionInstance);\n            versions.sort(lowerVersionFirst);\n            versionInstance.stores({});\n            this._state.autoSchema = false;\n            return versionInstance;\n        };\n        Dexie.prototype._whenReady = function (fn) {\n            var _this = this;\n            return (this.idbdb && (this._state.openComplete || PSD.letThrough || this._vip)) ? fn() : new DexiePromise(function (resolve, reject) {\n                if (_this._state.openComplete) {\n                    return reject(new exceptions.DatabaseClosed(_this._state.dbOpenError));\n                }\n                if (!_this._state.isBeingOpened) {\n                    if (!_this._state.autoOpen) {\n                        reject(new exceptions.DatabaseClosed());\n                        return;\n                    }\n                    _this.open().catch(nop);\n                }\n                _this._state.dbReadyPromise.then(resolve, reject);\n            }).then(fn);\n        };\n        Dexie.prototype.use = function (_a) {\n            var stack = _a.stack, create = _a.create, level = _a.level, name = _a.name;\n            if (name)\n                this.unuse({ stack: stack, name: name });\n            var middlewares = this._middlewares[stack] || (this._middlewares[stack] = []);\n            middlewares.push({ stack: stack, create: create, level: level == null ? 10 : level, name: name });\n            middlewares.sort(function (a, b) { return a.level - b.level; });\n            return this;\n        };\n        Dexie.prototype.unuse = function (_a) {\n            var stack = _a.stack, name = _a.name, create = _a.create;\n            if (stack && this._middlewares[stack]) {\n                this._middlewares[stack] = this._middlewares[stack].filter(function (mw) {\n                    return create ? mw.create !== create :\n                        name ? mw.name !== name :\n                            false;\n                });\n            }\n            return this;\n        };\n        Dexie.prototype.open = function () {\n            var _this = this;\n            return usePSD(globalPSD,\n            function () { return dexieOpen(_this); });\n        };\n        Dexie.prototype._close = function () {\n            var state = this._state;\n            var idx = connections.indexOf(this);\n            if (idx >= 0)\n                connections.splice(idx, 1);\n            if (this.idbdb) {\n                try {\n                    this.idbdb.close();\n                }\n                catch (e) { }\n                this.idbdb = null;\n            }\n            if (!state.isBeingOpened) {\n                state.dbReadyPromise = new DexiePromise(function (resolve) {\n                    state.dbReadyResolve = resolve;\n                });\n                state.openCanceller = new DexiePromise(function (_, reject) {\n                    state.cancelOpen = reject;\n                });\n            }\n        };\n        Dexie.prototype.close = function (_a) {\n            var _b = _a === void 0 ? { disableAutoOpen: true } : _a, disableAutoOpen = _b.disableAutoOpen;\n            var state = this._state;\n            if (disableAutoOpen) {\n                if (state.isBeingOpened) {\n                    state.cancelOpen(new exceptions.DatabaseClosed());\n                }\n                this._close();\n                state.autoOpen = false;\n                state.dbOpenError = new exceptions.DatabaseClosed();\n            }\n            else {\n                this._close();\n                state.autoOpen = this._options.autoOpen ||\n                    state.isBeingOpened;\n                state.openComplete = false;\n                state.dbOpenError = null;\n            }\n        };\n        Dexie.prototype.delete = function (closeOptions) {\n            var _this = this;\n            if (closeOptions === void 0) { closeOptions = { disableAutoOpen: true }; }\n            var hasInvalidArguments = arguments.length > 0 && typeof arguments[0] !== 'object';\n            var state = this._state;\n            return new DexiePromise(function (resolve, reject) {\n                var doDelete = function () {\n                    _this.close(closeOptions);\n                    var req = _this._deps.indexedDB.deleteDatabase(_this.name);\n                    req.onsuccess = wrap(function () {\n                        _onDatabaseDeleted(_this._deps, _this.name);\n                        resolve();\n                    });\n                    req.onerror = eventRejectHandler(reject);\n                    req.onblocked = _this._fireOnBlocked;\n                };\n                if (hasInvalidArguments)\n                    throw new exceptions.InvalidArgument(\"Invalid closeOptions argument to db.delete()\");\n                if (state.isBeingOpened) {\n                    state.dbReadyPromise.then(doDelete);\n                }\n                else {\n                    doDelete();\n                }\n            });\n        };\n        Dexie.prototype.backendDB = function () {\n            return this.idbdb;\n        };\n        Dexie.prototype.isOpen = function () {\n            return this.idbdb !== null;\n        };\n        Dexie.prototype.hasBeenClosed = function () {\n            var dbOpenError = this._state.dbOpenError;\n            return dbOpenError && (dbOpenError.name === 'DatabaseClosed');\n        };\n        Dexie.prototype.hasFailed = function () {\n            return this._state.dbOpenError !== null;\n        };\n        Dexie.prototype.dynamicallyOpened = function () {\n            return this._state.autoSchema;\n        };\n        Object.defineProperty(Dexie.prototype, \"tables\", {\n            get: function () {\n                var _this = this;\n                return keys(this._allTables).map(function (name) { return _this._allTables[name]; });\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Dexie.prototype.transaction = function () {\n            var args = extractTransactionArgs.apply(this, arguments);\n            return this._transaction.apply(this, args);\n        };\n        Dexie.prototype._transaction = function (mode, tables, scopeFunc) {\n            var _this = this;\n            var parentTransaction = PSD.trans;\n            if (!parentTransaction || parentTransaction.db !== this || mode.indexOf('!') !== -1)\n                parentTransaction = null;\n            var onlyIfCompatible = mode.indexOf('?') !== -1;\n            mode = mode.replace('!', '').replace('?', '');\n            var idbMode, storeNames;\n            try {\n                storeNames = tables.map(function (table) {\n                    var storeName = table instanceof _this.Table ? table.name : table;\n                    if (typeof storeName !== 'string')\n                        throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n                    return storeName;\n                });\n                if (mode == \"r\" || mode === READONLY)\n                    idbMode = READONLY;\n                else if (mode == \"rw\" || mode == READWRITE)\n                    idbMode = READWRITE;\n                else\n                    throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n                if (parentTransaction) {\n                    if (parentTransaction.mode === READONLY && idbMode === READWRITE) {\n                        if (onlyIfCompatible) {\n                            parentTransaction = null;\n                        }\n                        else\n                            throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n                    }\n                    if (parentTransaction) {\n                        storeNames.forEach(function (storeName) {\n                            if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                                if (onlyIfCompatible) {\n                                    parentTransaction = null;\n                                }\n                                else\n                                    throw new exceptions.SubTransaction(\"Table \" + storeName +\n                                        \" not included in parent transaction.\");\n                            }\n                        });\n                    }\n                    if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n                        parentTransaction = null;\n                    }\n                }\n            }\n            catch (e) {\n                return parentTransaction ?\n                    parentTransaction._promise(null, function (_, reject) { reject(e); }) :\n                    rejection(e);\n            }\n            var enterTransaction = enterTransactionScope.bind(null, this, idbMode, storeNames, parentTransaction, scopeFunc);\n            return (parentTransaction ?\n                parentTransaction._promise(idbMode, enterTransaction, \"lock\") :\n                PSD.trans ?\n                    usePSD(PSD.transless, function () { return _this._whenReady(enterTransaction); }) :\n                    this._whenReady(enterTransaction));\n        };\n        Dexie.prototype.table = function (tableName) {\n            if (!hasOwn(this._allTables, tableName)) {\n                throw new exceptions.InvalidTable(\"Table \".concat(tableName, \" does not exist\"));\n            }\n            return this._allTables[tableName];\n        };\n        return Dexie;\n    }());\n\n    var symbolObservable = typeof Symbol !== \"undefined\" && \"observable\" in Symbol\n        ? Symbol.observable\n        : \"@@observable\";\n    var Observable =  (function () {\n        function Observable(subscribe) {\n            this._subscribe = subscribe;\n        }\n        Observable.prototype.subscribe = function (x, error, complete) {\n            return this._subscribe(!x || typeof x === \"function\" ? { next: x, error: error, complete: complete } : x);\n        };\n        Observable.prototype[symbolObservable] = function () {\n            return this;\n        };\n        return Observable;\n    }());\n\n    var domDeps;\n    try {\n        domDeps = {\n            indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n            IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n        };\n    }\n    catch (e) {\n        domDeps = { indexedDB: null, IDBKeyRange: null };\n    }\n\n    function liveQuery(querier) {\n        var hasValue = false;\n        var currentValue;\n        var observable = new Observable(function (observer) {\n            var scopeFuncIsAsync = isAsyncFunction(querier);\n            function execute(ctx) {\n                var wasRootExec = beginMicroTickScope();\n                try {\n                    if (scopeFuncIsAsync) {\n                        incrementExpectedAwaits();\n                    }\n                    var rv = newScope(querier, ctx);\n                    if (scopeFuncIsAsync) {\n                        rv = rv.finally(decrementExpectedAwaits);\n                    }\n                    return rv;\n                }\n                finally {\n                    wasRootExec && endMicroTickScope();\n                }\n            }\n            var closed = false;\n            var abortController;\n            var accumMuts = {};\n            var currentObs = {};\n            var subscription = {\n                get closed() {\n                    return closed;\n                },\n                unsubscribe: function () {\n                    if (closed)\n                        return;\n                    closed = true;\n                    if (abortController)\n                        abortController.abort();\n                    if (startedListening)\n                        globalEvents.storagemutated.unsubscribe(mutationListener);\n                },\n            };\n            observer.start && observer.start(subscription);\n            var startedListening = false;\n            var doQuery = function () { return execInGlobalContext(_doQuery); };\n            function shouldNotify() {\n                return obsSetsOverlap(currentObs, accumMuts);\n            }\n            var mutationListener = function (parts) {\n                extendObservabilitySet(accumMuts, parts);\n                if (shouldNotify()) {\n                    doQuery();\n                }\n            };\n            var _doQuery = function () {\n                if (closed ||\n                    !domDeps.indexedDB)\n                 {\n                    return;\n                }\n                accumMuts = {};\n                var subscr = {};\n                if (abortController)\n                    abortController.abort();\n                abortController = new AbortController();\n                var ctx = {\n                    subscr: subscr,\n                    signal: abortController.signal,\n                    requery: doQuery,\n                    querier: querier,\n                    trans: null\n                };\n                var ret = execute(ctx);\n                Promise.resolve(ret).then(function (result) {\n                    hasValue = true;\n                    currentValue = result;\n                    if (closed || ctx.signal.aborted) {\n                        return;\n                    }\n                    accumMuts = {};\n                    currentObs = subscr;\n                    if (!objectIsEmpty(currentObs) && !startedListening) {\n                        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, mutationListener);\n                        startedListening = true;\n                    }\n                    execInGlobalContext(function () { return !closed && observer.next && observer.next(result); });\n                }, function (err) {\n                    hasValue = false;\n                    if (!['DatabaseClosedError', 'AbortError'].includes(err === null || err === void 0 ? void 0 : err.name)) {\n                        if (!closed)\n                            execInGlobalContext(function () {\n                                if (closed)\n                                    return;\n                                observer.error && observer.error(err);\n                            });\n                    }\n                });\n            };\n            setTimeout(doQuery, 0);\n            return subscription;\n        });\n        observable.hasValue = function () { return hasValue; };\n        observable.getValue = function () { return currentValue; };\n        return observable;\n    }\n\n    var Dexie = Dexie$1;\n    props(Dexie, __assign(__assign({}, fullNameExceptions), {\n        delete: function (databaseName) {\n            var db = new Dexie(databaseName, { addons: [] });\n            return db.delete();\n        },\n        exists: function (name) {\n            return new Dexie(name, { addons: [] }).open().then(function (db) {\n                db.close();\n                return true;\n            }).catch('NoSuchDatabaseError', function () { return false; });\n        },\n        getDatabaseNames: function (cb) {\n            try {\n                return getDatabaseNames(Dexie.dependencies).then(cb);\n            }\n            catch (_a) {\n                return rejection(new exceptions.MissingAPI());\n            }\n        },\n        defineClass: function () {\n            function Class(content) {\n                extend(this, content);\n            }\n            return Class;\n        }, ignoreTransaction: function (scopeFunc) {\n            return PSD.trans ?\n                usePSD(PSD.transless, scopeFunc) :\n                scopeFunc();\n        }, vip: vip, async: function (generatorFn) {\n            return function () {\n                try {\n                    var rv = awaitIterator(generatorFn.apply(this, arguments));\n                    if (!rv || typeof rv.then !== 'function')\n                        return DexiePromise.resolve(rv);\n                    return rv;\n                }\n                catch (e) {\n                    return rejection(e);\n                }\n            };\n        }, spawn: function (generatorFn, args, thiz) {\n            try {\n                var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n                if (!rv || typeof rv.then !== 'function')\n                    return DexiePromise.resolve(rv);\n                return rv;\n            }\n            catch (e) {\n                return rejection(e);\n            }\n        },\n        currentTransaction: {\n            get: function () { return PSD.trans || null; }\n        }, waitFor: function (promiseOrFunction, optionalTimeout) {\n            var promise = DexiePromise.resolve(typeof promiseOrFunction === 'function' ?\n                Dexie.ignoreTransaction(promiseOrFunction) :\n                promiseOrFunction)\n                .timeout(optionalTimeout || 60000);\n            return PSD.trans ?\n                PSD.trans.waitFor(promise) :\n                promise;\n        },\n        Promise: DexiePromise,\n        debug: {\n            get: function () { return debug; },\n            set: function (value) {\n                setDebug(value);\n            }\n        },\n        derive: derive, extend: extend, props: props, override: override,\n        Events: Events, on: globalEvents, liveQuery: liveQuery, extendObservabilitySet: extendObservabilitySet,\n        getByKeyPath: getByKeyPath, setByKeyPath: setByKeyPath, delByKeyPath: delByKeyPath, shallowClone: shallowClone, deepClone: deepClone, getObjectDiff: getObjectDiff, cmp: cmp, asap: asap$1,\n        minKey: minKey,\n        addons: [],\n        connections: connections,\n        errnames: errnames,\n        dependencies: domDeps, cache: cache,\n        semVer: DEXIE_VERSION, version: DEXIE_VERSION.split('.')\n            .map(function (n) { return parseInt(n); })\n            .reduce(function (p, c, i) { return p + (c / Math.pow(10, i * 2)); }) }));\n    Dexie.maxKey = getMaxKey(Dexie.dependencies.IDBKeyRange);\n\n    if (typeof dispatchEvent !== 'undefined' && typeof addEventListener !== 'undefined') {\n        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (updatedParts) {\n            if (!propagatingLocally) {\n                var event_1;\n                event_1 = new CustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, {\n                    detail: updatedParts\n                });\n                propagatingLocally = true;\n                dispatchEvent(event_1);\n                propagatingLocally = false;\n            }\n        });\n        addEventListener(STORAGE_MUTATED_DOM_EVENT_NAME, function (_a) {\n            var detail = _a.detail;\n            if (!propagatingLocally) {\n                propagateLocally(detail);\n            }\n        });\n    }\n    function propagateLocally(updateParts) {\n        var wasMe = propagatingLocally;\n        try {\n            propagatingLocally = true;\n            globalEvents.storagemutated.fire(updateParts);\n            signalSubscribersNow(updateParts, true);\n        }\n        finally {\n            propagatingLocally = wasMe;\n        }\n    }\n    var propagatingLocally = false;\n\n    var bc;\n    var createBC = function () { };\n    if (typeof BroadcastChannel !== 'undefined') {\n        createBC = function () {\n            bc = new BroadcastChannel(STORAGE_MUTATED_DOM_EVENT_NAME);\n            bc.onmessage = function (ev) { return ev.data && propagateLocally(ev.data); };\n        };\n        createBC();\n        if (typeof bc.unref === 'function') {\n            bc.unref();\n        }\n        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (changedParts) {\n            if (!propagatingLocally) {\n                bc.postMessage(changedParts);\n            }\n        });\n    }\n\n    if (typeof addEventListener !== 'undefined') {\n        addEventListener('pagehide', function (event) {\n            if (!Dexie$1.disableBfCache && event.persisted) {\n                if (debug)\n                    console.debug('Dexie: handling persisted pagehide');\n                bc === null || bc === void 0 ? void 0 : bc.close();\n                for (var _i = 0, connections_1 = connections; _i < connections_1.length; _i++) {\n                    var db = connections_1[_i];\n                    db.close({ disableAutoOpen: false });\n                }\n            }\n        });\n        addEventListener('pageshow', function (event) {\n            if (!Dexie$1.disableBfCache && event.persisted) {\n                if (debug)\n                    console.debug('Dexie: handling persisted pageshow');\n                createBC();\n                propagateLocally({ all: new RangeSet(-Infinity, [[]]) });\n            }\n        });\n    }\n\n    function add(value) {\n        return new PropModification({ add: value });\n    }\n\n    function remove(value) {\n        return new PropModification({ remove: value });\n    }\n\n    function replacePrefix(a, b) {\n        return new PropModification({ replacePrefix: [a, b] });\n    }\n\n    DexiePromise.rejectionMapper = mapError;\n    setDebug(debug);\n\n    var namedExports = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        Dexie: Dexie$1,\n        liveQuery: liveQuery,\n        Entity: Entity,\n        cmp: cmp,\n        PropModification: PropModification,\n        replacePrefix: replacePrefix,\n        add: add,\n        remove: remove,\n        'default': Dexie$1,\n        RangeSet: RangeSet,\n        mergeRanges: mergeRanges,\n        rangesOverlap: rangesOverlap\n    });\n\n    __assign(Dexie$1, namedExports, { default: Dexie$1 });\n\n    return Dexie$1;\n\n}));\n//# sourceMappingURL=dexie.js.map\n","// Making the module version consumable via require - to prohibit\n// multiple occurrancies of the same module in the same app\n// (dual package hazard, https://nodejs.org/api/packages.html#dual-package-hazard)\nimport _Dexie from \"./dist/dexie.js\";\nconst DexieSymbol = Symbol.for(\"Dexie\");\nconst Dexie = globalThis[DexieSymbol] || (globalThis[DexieSymbol] = _Dexie);\nif (_Dexie.semVer !== Dexie.semVer) {\n    throw new Error(`Two different versions of Dexie loaded in the same app: ${_Dexie.semVer} and ${Dexie.semVer}`);\n}\nconst { liveQuery, mergeRanges, rangesOverlap, RangeSet, cmp, Entity,\n    PropModification, replacePrefix, add, remove } = Dexie;\nexport { liveQuery, mergeRanges, rangesOverlap, RangeSet, cmp, Dexie, Entity,\n    PropModification, replacePrefix, add, remove };\nexport default Dexie;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { LoggerError } from './Errors';\nimport { openDB } from 'idb'; // IndexedDB support\nimport Dexie from 'dexie'; // Dexie.js for IndexedDB\n// import { browser_ext } from \"$lib/common/environment\";\n// import { initSQLite, saveToSQLite } from \"./LoggerSQLite\"; // SQLite integration\n\nconst isBrowser = typeof window !== 'undefined';\n\n// Define log levels\nenum LogLevel {\n\tDEBUG = 0,\n\tDEBUG_TRACE = 1,\n\tINFO = 2,\n\tINFO_TRACE = 3,\n\tWARN = 4,\n\tERROR = 5,\n\tERROR_TRACE = 6,\n\tTRACE = 7\n}\n\nenum LogLevelDirection {\n\tNONE = 0,\n\tCONTAINS = 1,\n\tLESSTHAN = 2,\n\tGREATERTHAN = 3,\n\tEQUAL = 4,\n\tGREATERTHANOREQUAL = 5,\n\tLESSTHANOREQUAL = 6\n}\n\n// Color styles for browser console logs\nconst COLORS = {\n\tDEBUG: 'color: purple; font-weight: bold;',\n\tDEBUG_TRACE: 'color: purple; font-weight: bold;',\n\tINFO: 'color: green; font-weight: bold;',\n\tINFO_TRACE: 'color: green; font-weight: bold;',\n\tWARN: 'color: orange; font-weight: bold;',\n\tERROR: 'color: red; font-weight: bold;',\n\tERROR_TRACE: 'color: red; font-weight: bold;',\n\tTRACE: 'color: blue; font-weight: bold;'\n};\n\nconst MAX_STORED_LOGS = 500; // Maximum number of logs to keep in storage\nconst STORAGE_KEY = 'yakklLogs'; // Key for localStorage\n\n// TBD - Add id and persona to the log entry??? Not sure\n// Add these interfaces\nexport interface LogEntry {\n\ttimestamp: string;\n\tlabel: string;\n\tmessage: string;\n\tcallerInfo: string;\n\tstack?: string;\n\targs?: any[];\n}\n\n/**\n * Logger class with structured logging, log levels, and optional regex filtering.\n */\nclass Logger {\n\tprivate static instance: Logger | null = null;\n\tprivate logLevel: LogLevel;\n\tprivate logLevelDirection: LogLevelDirection;\n\tprivate logsIncluded: string[] = [];\n\tprivate logRegEx: RegExp = /^(DEBUG|DEBUG_TRACE|INFO|INFO_TRACE|WARN|ERROR|ERROR_TRACE|TRACE)$/;\n\tprivate logFilterEnabled: boolean = false;\n\tprivate stackIndex = 4;\n\tprivate backend: string = 'localStorage'; // Default logging backend. 'console' should always display and the other values will only get used if persist is true\n\tprivate minLogLevel: LogLevel = LogLevel.ERROR;\n\n\tconstructor(\n\t\tlevel: LogLevel = LogLevel.DEBUG,\n\t\tdirection: LogLevelDirection = LogLevelDirection.LESSTHAN,\n\t\tlogsIncluded: string[] = [\n\t\t\t'DEBUG',\n\t\t\t'DEBUG_TRACE',\n\t\t\t'INFO',\n\t\t\t'INFO_TRACE',\n\t\t\t'WARN',\n\t\t\t'ERROR',\n\t\t\t'ERROR_TRACE',\n\t\t\t'TRACE'\n\t\t]\n\t) {\n\t\tthis.logLevel = level;\n\t\tthis.logLevelDirection = direction;\n\t\tthis.logsIncluded = logsIncluded;\n\t}\n\n\t// Add singleton getter\n\tpublic static getInstance(): Logger {\n\t\tif (!Logger.instance) {\n\t\t\tLogger.instance = new Logger();\n\t\t}\n\t\treturn Logger.instance;\n\t}\n\n\t// Add setter for minimum log level\n\tsetMinimumLogLevel(level: LogLevel): void {\n\t\tthis.minLogLevel = level;\n\t}\n\n\tsetLevel(\n\t\tlevel: keyof typeof LogLevel,\n\t\tdirection: keyof typeof LogLevelDirection,\n\t\tlogsIncluded: string[] = [\n\t\t\t'DEBUG',\n\t\t\t'DEBUG_TRACE',\n\t\t\t'INFO',\n\t\t\t'INFO_TRACE',\n\t\t\t'WARN',\n\t\t\t'ERROR',\n\t\t\t'ERROR_TRACE',\n\t\t\t'TRACE'\n\t\t]\n\t): void {\n\t\tthis.logLevel = LogLevel[level];\n\t\tthis.logLevelDirection = LogLevelDirection[direction];\n\t\tthis.logsIncluded = logsIncluded;\n\t}\n\n\t/**\n\t * Enables or disables regex-based log filtering.\n\t */\n\tsetLogFilterEnabled(enabled: boolean): void {\n\t\tthis.logFilterEnabled = enabled;\n\t}\n\n\t/**\n\t * Sets a regex pattern to filter log messages.\n\t */\n\tsetLogFilterRegex(pattern: string): void {\n\t\ttry {\n\t\t\tthis.logRegEx = new RegExp(pattern, 'i'); // Case-insensitive\n\t\t} catch (error: any) {\n\t\t\tthis.error('Invalid regex pattern:', false, error);\n\t\t}\n\t}\n\n\tsetStackIndex(index: number): void {\n\t\tif (index < 0) throw new Error('Stack index must be a positive number');\n\t\tthis.stackIndex = index;\n\t}\n\n\t/**\n\t * Updates the logging backend dynamically.\n\t */\n\tsetBackend(backendType: string): void {\n\t\tthis.backend = backendType;\n\t}\n\n\tgetMinimumLogLevel(): LogLevel {\n\t\treturn this.minLogLevel;\n\t}\n\n\tprivate getTimestamp(): string {\n\t\treturn new Date().toISOString();\n\t}\n\n\tprivate getCallerInfo(): string {\n\t\tconst stack = new Error().stack;\n\t\tif (!stack) return 'Unknown Caller';\n\t\tconst stackLines = stack.split('\\n').length;\n\t\tconst adjustedIndex = Math.min(this.stackIndex, stackLines - 1) ?? this.stackIndex;\n\t\tconst callerLine = stack.split('\\n')[adjustedIndex]?.trim();\n\t\treturn callerLine || 'Unknown Caller';\n\t}\n\n\tprivate normalizeInput(input: unknown): { message: string; stack?: string } {\n\t\tif (input instanceof Error) {\n\t\t\treturn { message: input.message, stack: input.stack };\n\t\t} else if (typeof input === 'string') {\n\t\t\treturn { message: input };\n\t\t} else if (input === null || input === undefined) {\n\t\t\treturn { message: String(input) };\n\t\t} else {\n\t\t\treturn { message: JSON.stringify(input, null, 2) };\n\t\t}\n\t}\n\n\tprivate persistLog(entry: LogEntry): void {\n\t\ttry {\n\t\t\tswitch (this.backend) {\n\t\t\t\tcase 'indexedDB':\n\t\t\t\t\tthis.persistLogIndexedDB(entry);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'dexie':\n\t\t\t\t\tthis.persistLogDexie(entry);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sqlite':\n\t\t\t\t\tthis.persistLogSQLite(entry);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'background':\n\t\t\t\t\tthis.persistLogBackground(entry);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'localStorage':\n\t\t\t\tdefault:\n\t\t\t\t\tthis.persistLogLocalStorage(entry);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tthis.error('Failed to persist log:', false, error);\n\t\t}\n\t}\n\n\tprivate persistLogLocalStorage(log: LogEntry): void {\n\t\ttry {\n\t\t\t// Do not store at this time. localStorage could fail for local environment reasons.\n\t\t\treturn;\n\n\t\t\tif (typeof localStorage !== 'undefined') {\n\t\t\t\tconst logs = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');\n\n\t\t\t\t// Ensure args are serializable\n\t\t\t\tif (log.args) {\n\t\t\t\t\tlog.args = log.args.map((arg) => {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// Test if the arg can be properly serialized\n\t\t\t\t\t\t\tJSON.parse(JSON.stringify(arg));\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t} catch {\n\t\t\t\t\t\t\t// If not serializable, convert to string representation\n\t\t\t\t\t\t\treturn String(arg);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tlogs.push(log);\n\t\t\t\twhile (logs.length > MAX_STORED_LOGS) {\n\t\t\t\t\tlogs.shift();\n\t\t\t\t}\n\t\t\t\tlocalStorage.setItem(STORAGE_KEY, JSON.stringify(logs));\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tthis.error('Failed to persist to localStorage:', error);\n\t\t}\n\t}\n\n\tprivate persistLogIndexedDB(log: LogEntry): void {\n\t\tconst dbPromise = openDB(STORAGE_KEY, 1, {\n\t\t\tupgrade(db) {\n\t\t\t\tif (!db.objectStoreNames.contains('logs')) {\n\t\t\t\t\tdb.createObjectStore('logs', {\n\t\t\t\t\t\tkeyPath: 'id',\n\t\t\t\t\t\tautoIncrement: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Ensure args are serializable\n\t\tif (log.args) {\n\t\t\tlog.args = log.args.map((arg) => {\n\t\t\t\ttry {\n\t\t\t\t\tJSON.parse(JSON.stringify(arg));\n\t\t\t\t\treturn arg;\n\t\t\t\t} catch {\n\t\t\t\t\treturn String(arg);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tdbPromise.then(async (db) => {\n\t\t\tconst tx = db.transaction('logs', 'readwrite');\n\t\t\tconst store = tx.objectStore('logs');\n\t\t\tawait store.add(log);\n\n\t\t\t// Keep only latest logs\n\t\t\tconst allLogs = await store.getAll();\n\t\t\twhile (allLogs.length > MAX_STORED_LOGS) {\n\t\t\t\tawait store.delete(allLogs[0].id);\n\t\t\t\tallLogs.shift();\n\t\t\t}\n\t\t\tawait tx.done;\n\t\t});\n\t}\n\n\tprivate persistLogDexie(log: LogEntry): void {\n\t\tconst dexieDB = new Dexie(STORAGE_KEY);\n\t\tdexieDB.version(1).stores({\n\t\t\tlogs: '++id, timestamp, label, message, args'\n\t\t});\n\n\t\t// Ensure args are serializable\n\t\tif (log.args) {\n\t\t\tlog.args = log.args.map((arg) => {\n\t\t\t\ttry {\n\t\t\t\t\tJSON.parse(JSON.stringify(arg));\n\t\t\t\t\treturn arg;\n\t\t\t\t} catch {\n\t\t\t\t\treturn String(arg);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tdexieDB.table('logs').add(log);\n\n\t\t// Keep only latest logs\n\t\tdexieDB\n\t\t\t.table('logs')\n\t\t\t.count()\n\t\t\t.then((count) => {\n\t\t\t\tif (count > MAX_STORED_LOGS) {\n\t\t\t\t\tdexieDB\n\t\t\t\t\t\t.table('logs')\n\t\t\t\t\t\t.orderBy('id')\n\t\t\t\t\t\t.first((firstLog) => {\n\t\t\t\t\t\t\tif (firstLog) {\n\t\t\t\t\t\t\t\tdexieDB.table('logs').delete(firstLog.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tprivate persistLogSQLite(log: LogEntry): void {\n\t\t// saveToSQLite(log);\n\t\t// Keep only the latest MAX_STORED_LOGS entries\n\t\t// const db = initSQLite();\n\t\t// db.transaction((tx) => {\n\t\t//   tx.executeSql(\"SELECT COUNT(*) FROM logs\", [], (tx, result) => {\n\t\t//     const count = result.rows.item(0)[\"COUNT(*)\"];\n\t\t//     if (count > MAX_STORED_LOGS) {\n\t\t//       tx.executeSql(\"DELETE FROM logs WHERE id = (SELECT MIN(id) FROM logs)\");\n\t\t//     }\n\t\t//   });\n\t\t//   tx.executeSql(\"INSERT INTO logs (timestamp, label, message) VALUES (?, ?, ?)\", [log.timestamp, log.label, log.message]);\n\t\t// });\n\t}\n\n\tprivate persistLogBackground(log: LogEntry): void {\n\t\t// if (!browser_ext) return;\n\t\t// browser_ext.runtime.sendMessage({ type: \"LOG_MESSAGE\", key: STORAGE_KEY, maxStored: MAX_STORED_LOGS, log: log });\n\t}\n\n\t// Add utility methods for persistent logs\n\tclearPersistedLogs(): void {\n\t\tswitch (this.backend) {\n\t\t\tcase 'indexedDB':\n\t\t\t\topenDB(STORAGE_KEY, 1).then((db) => {\n\t\t\t\t\tdb.transaction('logs', 'readwrite').objectStore('logs').clear();\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 'dexie':\n\t\t\t\tconst dexieDB = new Dexie(STORAGE_KEY);\n\t\t\t\tdexieDB.version(1).stores({ logs: '++id, message, timestamp' });\n\t\t\t\tdexieDB.table('logs').clear();\n\t\t\t\tbreak;\n\t\t\tcase 'sqlite':\n\t\t\t\t//   const db = initSQLite();\n\t\t\t\t//   db.transaction((tx) => {\n\t\t\t\t//     tx.executeSql(\"DELETE FROM logs\");\n\t\t\t\t//   });\n\t\t\t\tbreak;\n\t\t\tcase 'background':\n\t\t\t\t// if (!browser_ext) return;\n\t\t\t\t// browser_ext.runtime.sendMessage({ type: \"CLEAR_LOGS\", key: STORAGE_KEY });\n\t\t\t\tbreak;\n\n\t\t\tcase 'localStorage':\n\t\t\tdefault:\n\t\t\t\tlocalStorage.removeItem(STORAGE_KEY);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tgetPersistedLogs(): LogEntry[] {\n\t\ttry {\n\t\t\tswitch (this.backend) {\n\t\t\t\tcase 'indexedDB':\n\t\t\t\t\topenDB(STORAGE_KEY, 1).then((db) => {\n\t\t\t\t\t\treturn db.transaction('logs', 'readonly').objectStore('logs').getAll();\n\t\t\t\t\t});\n\t\t\t\tcase 'dexie':\n\t\t\t\t\t// const dexieDB = new Dexie(STORAGE_KEY);\n\t\t\t\t\t// dexieDB.version(1).stores({ logs: \"++id, message, timestamp\" });\n\t\t\t\t\t// return dexieDB.table(\"logs\").toArray();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sqlite':\n\t\t\t\t\t//   const db = initSQLite();\n\t\t\t\t\t//   return new Promise((resolve, reject) => {\n\t\t\t\t\t//     db.transaction((tx) => {\n\t\t\t\t\t//       tx.executeSql(\"SELECT * FROM logs\", [], (tx, result) => {\n\t\t\t\t\t//         const logs: LogEntry[] = [];\n\t\t\t\t\t//         for (let i = 0; i < result.rows.length; i++) {\n\t\t\t\t\t//           logs.push(result.rows.item(i));\n\t\t\t\t\t//         }\n\t\t\t\t\t//         resolve(logs);\n\t\t\t\t\t//       }, (tx, error) => {\n\t\t\t\t\t//         reject(error);\n\t\t\t\t\t//       });\n\t\t\t\t\t//     });\n\t\t\t\t\t//   });\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'background':\n\t\t\t\t\t// Send to request a background script to fetch logs by sending to a more local listener for the logs\n\t\t\t\t\t// return browser_ext.runtime.sendMessage({ type: \"GET_LOGS\", key: STORAGE_KEY });\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'localstorage':\n\t\t\t\tdefault:\n\t\t\t\t\treturn JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');\n\t\t\t}\n\t\t} catch {\n\t\t\tthis.error('Failed to retrieve persisted logs');\n\t\t\treturn [];\n\t\t}\n\t}\n\n\t/**\n\t * Generic logging function.\n\t */\n\tprivate log(\n\t\tlevel: LogLevel,\n\t\tlabel: string,\n\t\tcolor: string,\n\t\tinput: unknown,\n\t\tincludeStack = false,\n\t\tpersist = false,\n\t\t...args: any[]\n\t): void {\n\t\ttry {\n\t\t\t// Environment check that works in both Vite and pure TS environments\n\t\t\tconst isProduction = this.isProductionEnvironment();\n\n\t\t\t// Check if we should log based on environment and level\n\t\t\tif (isProduction) {\n\t\t\t\t// In production, only log WARN and above\n\t\t\t\tif (level < this.minLogLevel) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Always log to console first\n\t\t\tconst { message, stack } = this.normalizeInput(input);\n\t\t\tconst timestamp = this.getTimestamp();\n\t\t\tconst callerInfo = this.getCallerInfo();\n\n\t\t\t// Force console output for debugging\n\t\t\tconsole.log(\n\t\t\t\t`%c[${label}] ${timestamp}`,\n\t\t\t\tcolor,\n\t\t\t\tmessage,\n\t\t\t\t...(args || []),\n\t\t\t\t'\\nCaller:',\n\t\t\t\tcallerInfo,\n\t\t\t\tstack ? '\\nStack:' + stack : ''\n\t\t\t);\n\n\t\t\tif (persist) {\n\t\t\t\tconst entry: LogEntry = {\n\t\t\t\t\ttimestamp,\n\t\t\t\t\tlabel,\n\t\t\t\t\tmessage,\n\t\t\t\t\tcallerInfo,\n\t\t\t\t\tstack: includeStack ? stack : undefined,\n\t\t\t\t\targs\n\t\t\t\t};\n\t\t\t\tthis.persistLog(entry);\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tif (!this.isProductionEnvironment() || level >= LogLevel.WARN) {\n\t\t\t\tthis.error('Logging failed:', false, error);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate isProductionEnvironment(): boolean {\n\t\t// Check various ways to determine if we're in production\n\t\tif (typeof __PROD__ !== 'undefined') {\n\t\t\treturn __PROD__;\n\t\t}\n\n\t\t// For background scripts or environments without Vite\n\t\tif (typeof process !== 'undefined' && process.env) {\n\t\t\treturn process.env.NODE_ENV === 'production';\n\t\t}\n\n\t\t// Fallback for browser environments\n\t\tif (typeof window !== 'undefined' && window.location) {\n\t\t\t// You might want to adjust this based on your production URL patterns\n\t\t\treturn (\n\t\t\t\t!window.location.hostname.includes('localhost') &&\n\t\t\t\t!window.location.hostname.includes('127.0.0.1')\n\t\t\t);\n\t\t}\n\n\t\t// Default to development if we can't determine\n\t\treturn false;\n\t}\n\n\tdebug(input: unknown, persist: boolean = false, ...args: any[]): void {\n\t\tthis.log(LogLevel.DEBUG, 'DEBUG', COLORS.DEBUG, input, false, persist, ...args);\n\t}\n\n\tdebugStack(input: unknown, persist: boolean = false, ...args: any[]): void {\n\t\tthis.log(LogLevel.DEBUG_TRACE, 'DEBUG_TRACE', COLORS.DEBUG, input, true, persist, ...args);\n\t}\n\n\tinfo(input: unknown, persist: boolean = false, ...args: any[]): void {\n\t\tthis.log(LogLevel.INFO, 'INFO', COLORS.INFO, input, false, persist, ...args);\n\t}\n\n\tinfoStack(input: unknown, persist: boolean = false, ...args: any[]): void {\n\t\tthis.log(LogLevel.INFO_TRACE, 'INFO_TRACE', COLORS.INFO, input, false, persist, ...args);\n\t}\n\n\twarn(input: unknown, persist: boolean = false, ...args: any[]): void {\n\t\tthis.log(LogLevel.WARN, 'WARN', COLORS.WARN, input, false, persist, ...args);\n\t}\n\n\terror(input: unknown, persist: boolean = false, ...args: any[]): void {\n\t\tthis.log(LogLevel.ERROR, 'ERROR', COLORS.ERROR, input, false, persist, ...args);\n\t}\n\n\terrorStack(error: unknown, persist: boolean = false, ...args: any[]): void {\n\t\tthis.log(LogLevel.ERROR_TRACE, 'ERROR_TRACE', COLORS.ERROR, false, persist, ...args);\n\t}\n\n\ttrace(input: unknown, persist: boolean = false, ...args: any[]): void {\n\t\tthis.log(LogLevel.TRACE, 'TRACE', COLORS.TRACE, input, false, persist, ...args);\n\t}\n}\n\n// Singleton instance\nconst log = Logger.getInstance();\n\nexport { log, Logger, LogLevel, LogLevelDirection };\n"],"names":["getDefaultExportFromCjs","x","__esModule","Object","prototype","hasOwnProperty","call","browser","exports","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","this","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","nextTick","args","Array","arguments","i","push","Item","array","apply","title","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","browserExports","process$1","instanceOfAny","object","constructors","some","c","idbProxyableTypes","cursorAdvanceMethods","getIdbProxyableTypes","IDBDatabase","IDBObjectStore","IDBIndex","IDBCursor","IDBTransaction","getCursorAdvanceMethods","advance","continue","continuePrimaryKey","transactionDoneMap","WeakMap","transformCache","reverseTransformCache","promisifyRequest","request","promise","Promise","resolve","reject","unlisten","removeEventListener","success","error","wrap","result","addEventListener","set","cacheDonePromiseForTransaction","tx","has","done","complete","DOMException","idbProxyTraps","get","target","prop","receiver","objectStoreNames","objectStore","value","replaceTraps","callback","wrapFunction","func","includes","unwrap","transformCachableValue","Proxy","IDBRequest","newValue","openDB","blocked","upgrade","blocking","terminated","indexedDB","open","openPromise","event","oldVersion","newVersion","transaction","then","db","catch","readMethods","writeMethods","cachedMethods","Map","getMethod","targetFuncName","replace","useIndex","isWrite","method","async","storeName","store","index","shift","all","oldTraps","advanceMethodProps","methodMap","advanceResults","ittrProxiedCursorToOriginalProxy","cursorIteratorTraps","cachedFunc","iterate","cursor","openCursor","proxiedCursor","delete","isIteratorProp","Symbol","asyncIterator","global","factory","module","extendStatics","d","b","setPrototypeOf","__proto__","p","__extends","TypeError","String","__","constructor","create","__assign","assign","t","s","n","__spreadArray","to","from","pack","l","ar","slice","_global","globalThis","self","window","keys","isArray","extend","obj","extension","forEach","key","getProto","getPrototypeOf","_hasOwn","hasOwn","props","proto","Reflect","ownKeys","setProp","defineProperty","functionOrGetSet","options","configurable","writable","derive","Child","Parent","bind","getOwnPropertyDescriptor","getPropertyDescriptor","pd","_slice","start","end","override","origFunc","overridedFactory","assert","asap$1","fn","setImmediate","arrayToObject","extractor","reduce","item","nameAndValue","getByKeyPath","keyPath","rv","val","period","indexOf","innerObj","substr","setByKeyPath","isFrozen","currentKeyPath","remainingKeyPath","isNaN","parseInt","splice","delByKeyPath","map","kp","shallowClone","m","flatten","a","intrinsicTypeNames","split","num","filter","intrinsicTypes","Set","cloneSimpleObjectTree","o","k","v","objectIsEmpty","circularRefs","deepClone","any","innerDeepClone","toString","toStringTag","iteratorSymbol","iterator","getIteratorOf","delArrayItem","NO_CHAR_ARRAY","getArrayOf","arrayLike","it","next","isAsyncFunction","dexieErrorNames","idbDomErrorNames","errorList","defaultTexts","VersionChanged","DatabaseClosed","Abort","TransactionInactive","MissingAPI","DexieError","msg","message","getMultiErrorMessage","failures","join","ModifyError","successCount","failedKeys","BulkError","pos","failuresByPos","errnames","BaseException","exceptions","fullName","msgOrInner","inner","Syntax","SyntaxError","Type","Range","RangeError","exceptionMap","mapError","domError","stack","fullNameExceptions","nop","mirror","pureFunctionChain","f1","f2","callBoth","on1","on2","hookCreatingChain","res","onsuccess","onerror","res2","hookDeletingChain","hookUpdatingChain","modifications","reverseStoppableEventChain","promisableChain","thiz","debug","location","test","href","setDebug","INTERNAL","ZONE_ECHO_LIMIT","_a$1","globalP","crypto","subtle","nativeP","digest","Uint8Array","resolvedNativePromise","nativePromiseProto","resolvedGlobalPromise","nativePromiseThen","NativePromise","patchGlobalPromise","schedulePhysicalTick","queueMicrotask","physicalTick","asap","microtickQueue","needsNewPhysicalTick","isOutsideMicroTick","unhandledErrors","rejectingErrors","rejectionMapper","globalPSD","id","ref","unhandleds","onunhandled","pgp","finalize","PSD","numScheduledCalls","tickFinalizers","DexiePromise","_listeners","_lib","psd","_PSD","_state","_value","handleRejection","executePromiseTask","thenProp","microTaskId","totalEchoes","onFulfilled","onRejected","_this","possibleAwait","cleanup","decrementExpectedAwaits","propagateToListener","Listener","nativeAwaitCompatibleWrap","_consoleTask","_then","type","handler","err","PromiseReject","finally","onFinally","ms","Infinity","handle","Timeout","snapShot","zone","values","onPossibleParallellAsync","remaining","race","newPSD","newScope","usePSD","scheduler","follow","zoneProps","run_at_end_of_this_or_next_physical_tick","allSettled","possiblePromises","results","status","reason","AggregateError","failure","withResolvers","shouldExecuteTick","beginMicroTickScope","propagateAllListeners","endMicroTickScope","ex","addPossiblyUnhandledError","finalizePhysicalTick","listener","cb","callListener","ret","markErrorAsHandled","wasRootExec","callbacks","unhandledErrs","finalizers","finalizer","errorCatcher","outerScope","switchToZone","task","awaits","echoes","taskCounter","zoneStack","zoneEchoes","zone_id_counter","a1","a2","parent","PromiseProp","incrementExpectedAwaits","possiblePromise","rejection","zoneEnterEcho","targetZone","zoneLeaveEcho","pop","bEnteringZone","currentZone","GlobalPromise","targetEnv","a3","outerZone","execInGlobalContext","enqueueNativeMicroTask","tempTransaction","mode","storeNames","idbdb","openComplete","letThrough","_vip","dbOpenError","isBeingOpened","autoOpen","dbReadyPromise","trans","_createTransaction","_dbSchema","PR1398_maxLoop","InvalidState","isOpen","console","warn","close","disableAutoOpen","_promise","idbtrans","commit","_a","_completion","DEXIE_VERSION","maxString","fromCharCode","minKey","INVALID_KEY_ARGUMENT","STRING_EXPECTED","connections","DBNAMES_DB","READONLY","READWRITE","combine","filter1","filter2","AnyRange","lower","lowerOpen","upper","upperOpen","workaroundForUndefinedPrimKey","Entity","cmp","ta","tb","NaN","compareUint8Arrays","getUint8Array","compareArrays","al","bl","ArrayBuffer","isView","tsTag","buffer","byteOffset","byteLength","Table","_trans","writeLocked","_tx","tableName","createTask","checkTableInTransaction","schema","NotFound","_novip","transless","trace","keyOrCrit","where","first","core","hook","reading","fire","indexOrCrit","WhereClause","keyPaths","equals","compoundIndex","indexes","primKey","ix","compound","every","sort","_maxKey","keyPathsInValidOrder","JSON","stringify","idxByName","prevIndex","prevFilterFn","multi","idx","filterFunction","toCollection","and","count","thenShortcut","offset","limit","numRows","each","toArray","Collection","orderBy","reverse","mapToClass","mappedClass","_super","class_1","enumerable","table","inheritedProps","getOwnPropertyNames","propName","add","readHook","_","unsubscribe","defineClass","Class","content","auto","objToAdd","mutate","numFailures","lastResult","update","keyOrObject","InvalidArgument","modify","put","clear","range","bulkGet","getMany","bulkAdd","objects","keysOrOptions","wantResults","allKeys","numObjects","objectsToAdd","bulkPut","objectsToPut","bulkUpdate","keysAndChanges","coreTable","entry","changeSpecs","changes","offsetMap","cache","objs","resultKeys","resultObjs","_i","_b","Constraint","numEntries","updates","mappedOffset","Number","bulkDelete","numKeys","Events","ctx","evs","eventName","subscriber","subscribe","addEventType","chainFunction","defaultFunction","addConfiguredEvents","context","subscribers","cfg","fireEvent","makeClassConstructor","createTableConstructor","tableSchema","_allTables","creating","updating","deleting","isPlainKeyRange","ignoreLimitFilter","algorithm","or","justLimit","replayFilter","addFilter","addReplayFilter","isLimitFilter","curr","addMatchFilter","isMatch","getIndexOrStore","coreSchema","isPrimKey","primaryKey","getIndexByKeyPath","Schema","keysOnly","unique","query","iter","coreTrans","valueMapper","set_1","union","stop","fail","_iterate","cursorPromise","mappedFn","wrappedFn","advancer","PropModification","spec","execute","term","BigInt","remove","subtrahend_1","_c","prefixToReplace","replacePrefix","startsWith","substring","_read","_ctx","_write","_addAlgorithm","clone","raw","Math","min","sortBy","parts","lastPart","lastIndex","getval","order","sorter","aVal","bVal","valueMapper_1","a_1","offsetLeft","rowsLeft","until","bIncludeStopEntry","last","indexName","_ondirectionchange","desc","eachKey","eachUniqueKey","eachPrimaryKey","primaryKeys","uniqueKeys","firstKey","lastKey","distinct","strKey","found","modifyer","anythingModified","origVal","outbound","extractKey","modifyChunkSize","_options","totalFailures","applyMutateResult","expectedCount","criteria","deleteCallback","nextChunk","addValues","putValues","putKeys","deleteKeys","origValue","ctx_1","changeSpec","isAdditionalChunk","coreRange","createCollectionConstructor","whereClause","keyRangeGenerator","keyRange","whereCtx","readingHook","simpleCompare","simpleCompareReverse","collectionOrWhereClause","T","collection","emptyCollection","rangeEqual","upperFactory","toUpperCase","toLowerCase","lowerFactory","nextCasing","lowerKey","upperNeedle","lowerNeedle","llp","lwrKeyChar","addIgnoreCaseAlgorithm","match","needles","suffix","compare","upperNeedles","lowerNeedles","direction","nextKeySuffix","needlesLen","initDirection","needleBounds","needle","nb","createRange","firstPossibleNeedle","lowestPossibleCasing","casing","between","includeLower","includeUpper","_cmp","above","aboveOrEqual","below","belowOrEqual","str","startsWithIgnoreCase","equalsIgnoreCase","anyOfIgnoreCase","startsWithAnyOfIgnoreCase","anyOf","_ascending","_descending","notEqual","inAnyRange","includeLowers","includeUppers","noneOf","ranges","ascending","descending","_min","max","_max","addRange","newRange","sortDirection","rangeSorter","rangePos","keyIsBeyondCurrentEntry","keyIsBeforeCurrentEntry","keyWithinCurrentRange","checkKey","startsWithAnyOf","createWhereClauseConstructor","orCollection","_IDBKeyRange","_deps","IDBKeyRange","eventRejectHandler","preventDefault","stopPropagation","DEXIE_STORAGE_MUTATED_EVENT_NAME","STORAGE_MUTATED_DOM_EVENT_NAME","globalEvents","Transaction","_lock","_reculock","lockOwnerFor","_unlock","_blockedFuncs","_locked","fnAndPSD","OpenFailed","active","durability","chromeTransactionDurability","ev","_reject","onabort","oncomplete","_resolve","storagemutated","bWriteLock","ReadOnly","_root","waitFor","promiseLike","root","_waitingFor","_waitingQueue","spin","_spinCount","currentWaitPromise","abort","memoizedTables","_memoizedTables","transactionBoundTable","createTransactionConstructor","dbschema","wasActive","createIndexSpec","src","nameFromKeyPath","createTableSchema","safariMultiStoreFix","getMaxKey","IdbKeyRange","only","getKeyExtractor","getSinglePathKeyExtractor","arrayify","_id_counter","getKeyPathAlias","createDBCore","tmpTrans","extractSchema","tables","autoIncrement","indexByKeyPath","isPrimaryKey","indexNames","multiEntry","hasGetAll","navigator","userAgent","makeIDBKeyRange","idbRange","upperBound","lowerBound","bound","createDbCoreTable","isAddOrPut","req","reqs","errorHandler","args1","args2","source","openKeyCursor","___id","_cursorContinue","_cursorContinuePrimaryKey","_cursorAdvance","doThrowCursorIsNotStarted","doThrowCursorIsStopped","gotOne","iterationPromise","resolveIteration","rejectIteration","guardedCallback","nonInfinitLimit","idbKeyRange","getAll","getAllKeys","count_1","req_1","result_1","keyCount","callbackCount","successHandler","_pos","tableMap","MIN_KEY","MAX_KEY","createMiddlewareStack","stackImpl","middlewares","down","createMiddlewareStacks","dbcore","generateMiddlewareStacks","stacks","_middlewares","tbl","setApiOnPlace","tableNames","propDesc","removeTablesApi","lowerVersionFirst","_cfg","runUpgraders","idbUpgradeTrans","globalSchema","contains","$meta","parseIndexSyntax","_storeNames","rejectTransaction","createTable","populate","getExistingVersion","updateTablesAndIndexes","patchCurrentVersion","createMissingTables","createObjectStore","ceil","buildGlobalSchema","adjustToExistingIndexNames","diff","getSchemaDiff","_loop_1","tableChange","change","recreate","addIndex","state_1","metaVersion","_versions","versToRun","oldSchema","newSchema","tuple","Upgrade","store_1","deleteIndex","del","idxName","contentUpgrade","upgradeSchema_1","contentUpgradeIsAsync_1","returnValue_1","promiseFollowed","decrementor","deleteRemovedTables","deleteObjectStore","runQueue","oldDef","newDef","def","oldIndexes","newIndexes","oldIdx","newIdx","createIndex","dbStoreNames","j","idbindex","readGlobalSchema","verno","verifyInstalledSchema","installedSchema","ch","_hasGetAll","dexieName","indexSpec","WorkerGlobalScope","primKeyAndIndexes","indexNum","trim","Version","_parseStoresSpec","stores","outSchema","storesSource","storesSpec","upgradeFunction","createVersionConstructor","versionNumber","getDbNamesTable","dbNamesDB","Dexie$1","addons","dbnames","hasDatabasesNative","databases","getDatabaseNames","infos","info","_onDatabaseCreated","_onDatabaseDeleted","vip","idbReady","isSafari","userAgentData","intervalId","tryIdb","setInterval","clearInterval","isEmptyRange","node","RangeSet","fromOrTree","rangeSet","mergeRanges","addKey","addKeys","hasKey","getRangeSetIterator","left","right","r","rebalance","rightWasCutOff","newSet","_addRangeSet","rangesOverlap","rangeSet1","rangeSet2","i1","nextResult1","i2","nextResult2","state","keyProvided","up","rootClone","oldRootRight","computeDepth","extendObservabilitySet","part","obsSetsOverlap","os1","os2","unsignaledParts","isTaskEnqueued","signalSubscribersLazily","optimistic","signalSubscribersNow","updatedParts","deleteAffectedCacheEntries","queriesToSignal","tblCache","collectTableSubscribers","exec","dbName","requery","outQueriesToSignal","updatedEntryLists","entries","queries","filteredEntries","entries_1","obsSet","_d","updatedEntryLists_1","_e","dexieOpen","openCanceller","nativeVerToOpen","round","schemaPatchMode","throwIfCancelled","resolveDbReady","dbReadyResolve","upgradeTransaction","wasCreated","tryOpenDB","autoSchema","onblocked","_fireOnBlocked","onupgradeneeded","allowEmptyDB","delreq","deleteDatabase","NoSuchDatabase","oldVer","pow","onversionchange","vcFired","onclose","onReadyBeingFired","ready","fireRemainders","remainders_1","_close","everything_1","awaitIterator","callNext","doThrow","throw","onSuccess","step","onError","getNext","extractTransactionArgs","_tableArgs_","scopeFunc","enterTransactionScope","parentTransaction","explicit","_explicit","scopeFuncIsAsync","returnValue","PrematureCommit","pad","createVirtualIndexMiddleware","indexLookup","allVirtualIndexes","addVirtualIndexes","keyTail","lowLevelIndex","keyPathAlias","indexList","keyLength","isVirtual","virtualIndex","virtualKeyPath","findBestIndex","translateRange","translateRequest","createVirtualCursor","_continue","virtualCursor","virtualIndexMiddleware","level","getObjectDiff","prfx","ap","bp","apTypeName","bpTypeName","getEffectiveKeys","hooksMiddleware","downCore","downTable","tableMiddleware","dxTrans","addPutOrDelete","deleteRange","getExistingValues","existingValues","contexts","existingValue","generatedPrimaryKey","objectDiff","additionalChanges_1","requestedValue_1","deleteNextChunk","effectiveKeys","getFromTransactionCache","cacheExistingValuesMiddleware","cachedResult","isCachableContext","subscr","isCachableRequest","observabilityMiddleware","FULL_RANGE","querier","indexesWithAutoIncPK","tableClone","mutatedParts","getRangeSet","pkRangeSet","delsRangeSet","newObjs","oldCache","oldObjs","trackAffectedIndexes","idxVals","pkPos","findIndex","getRange","readSubscribers","isLiveQuery","cachable","pkRangeSet_1","delsRangeSet_1","queriedIndex","queriedRanges","keysPromise_1","resultingKeys","pKeys","cursor_1","wantValues_1","pkey","addAffectedIndex","addKeyOrKeys","oldKey","newKey","adjustOptimisticFromFailures","numBulkOps","isAboveLower","isBelowUpper","isWithinRange","applyOptimisticOps","ops","cacheEntry","immutable","queryRange","extractPrimKey","extractIndex","extractLowLevelIndex","finalResult","op","modifedResult","includedValues","includedPKs","pk","existingKeys_1","keySet_1","keysToDelete_1","range_1","dirty","freeze","areRangesEqual","r1","r2","compareLowers","lower1","lower2","lowerOpen1","lowerOpen2","compareUppers","upper1","upper2","upperOpen1","upperOpen2","isSuperRange","findCompatibleQuery","equalEntry","find","superEntry","countQuery","subscribeToCacheEntry","container","signal","size","enqueForDeletion","cacheMiddleware","coreMW","ac_1","AbortController","endTransaction","wasCommitted","affectedSubscribers_1","stores_1","optimisticOps","_f","_g","_h","freezeResults","modRes","tableMW","reqWithResolvedKeys","valueWithKey","adjustedReq","exactMatch","vipify","vipDb","Dexie","deps","dependencies","cancelOpen","bSticky","db_1","use","vipDB","addon","versionInstance","_whenReady","unuse","mw","closeOptions","hasInvalidArguments","doDelete","backendDB","hasBeenClosed","hasFailed","dynamicallyOpened","_transaction","onlyIfCompatible","idbMode","SubTransaction","enterTransaction","InvalidTable","symbolObservable","observable","Observable","_subscribe","domDeps","mozIndexedDB","webkitIndexedDB","msIndexedDB","webkitIDBKeyRange","liveQuery","hasValue","currentValue","observer","closed","abortController","accumMuts","currentObs","subscription","startedListening","mutationListener","doQuery","_doQuery","shouldNotify","aborted","getValue","databaseName","exists","ignoreTransaction","generatorFn","spawn","currentTransaction","promiseOrFunction","optionalTimeout","semVer","maxKey","dispatchEvent","propagatingLocally","event_1","CustomEvent","detail","propagateLocally","updateParts","wasMe","bc","createBC","BroadcastChannel","onmessage","data","unref","changedParts","postMessage","disableBfCache","persisted","connections_1","namedExports","default","DexieSymbol","for","_Dexie","LogLevel","LogLevelDirection","COLORS","DEBUG","INFO","WARN","ERROR","TRACE","MAX_STORED_LOGS","STORAGE_KEY","_Logger","logsIncluded","__publicField","logLevel","logLevelDirection","getInstance","instance","setMinimumLogLevel","minLogLevel","setLevel","setLogFilterEnabled","enabled","logFilterEnabled","setLogFilterRegex","pattern","logRegEx","RegExp","setStackIndex","stackIndex","setBackend","backendType","backend","getMinimumLogLevel","getTimestamp","Date","toISOString","getCallerInfo","stackLines","adjustedIndex","callerLine","normalizeInput","input","persistLog","persistLogIndexedDB","persistLogDexie","persistLogSQLite","persistLogBackground","persistLogLocalStorage","log","localStorage","logs","parse","getItem","arg","setItem","dbPromise","allLogs","dexieDB","firstLog","clearPersistedLogs","removeItem","getPersistedLogs","label","color","includeStack","persist","isProduction","isProductionEnvironment","timestamp","callerInfo","debugStack","infoStack","errorStack","Logger"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}