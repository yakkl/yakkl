import{c as check_target,l as legacy_api}from"./BXFaAXnq.js";import{p as push,h as tag,o as onMount,t as template_effect,a as pop,i as state,c as child,F as FILENAME,e as set,s as sibling,g as get,r as reset,b as strict_equals}from"./BaS8d5lg.js";import{a as add_locations}from"./3AhEABF_.js";import{d as delegate}from"./DiU70Is3.js";import{a as append,f as from_html,d as from_svg}from"./Cm3jf07C.js";import{c as create_ownership_validator}from"./COgMMZ9C.js";import{i as if_block}from"./Q1yPWpQ-.js";import{w as wrap_snippet}from"./d5hrMixo.js";import{r as remove_input_defaults}from"./DTBsVM-c.js";import{s as set_class}from"./DX_EEhpR.js";import{b as bind_value}from"./B6q982nR.js";import{p as prop}from"./BYboeQtC.js";import{s as setup_stores,a as store_get,b as store_set}from"./CViNpZsE.js";import{v as validate_store}from"./Dv9a3G0k.js";import{C as getYakklCurrentlySelected,v as getProfile,x as isEncryptedData,z as decryptData,w as digestMessage,G as isProfileData,R as encryptData,ak as setYakklCurrentlySelectedStorage,al as profileStore,am as setProfileStorage,H as yakklMiscStore}from"./Cb2naUpm.js";import{d as deepCopy}from"./CnIbzB-6.js";import{l as log}from"./WDN37msH.js";import"./CgCfpVku.js";import{M as Modal}from"./UU1vCwIM.js";Pincode[FILENAME]="src/lib/components/Pincode.svelte";function resetForm(_,pincodeOriginal,pincodeNew){set(pincodeOriginal,"");set(pincodeNew,"")}function togglePinVisibilityOriginal(__1,eyeOpenOriginal,toggleVisibility){set(eyeOpenOriginal,!get(eyeOpenOriginal));toggleVisibility("pincodeOriginal","number")}function togglePinVisibilityNew(__2,eyeOpenNew,toggleVisibility){set(eyeOpenNew,!get(eyeOpenNew));toggleVisibility("pincodeNew","number")}var root_2=add_locations(from_svg(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-gray-500"><path d="M12 15a3 3 0 100-6 3 3 0 000 6z"></path><path fill-rule="evenodd" d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 010-1.113zM17.25 12a5.25 5.25 0 11-10.5 0 5.25 5.25 0 0110.5 0z" clip-rule="evenodd"></path></svg>`),Pincode[FILENAME],[[134,6,[[140,7],[141,7]]]]);var root_3=add_locations(from_svg(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-gray-500"><path d="M3.53 2.47a.75.75 0 00-1.06 1.06l18 18a.75.75 0 101.06-1.06l-18-18zM22.676 12.553a11.249 11.249 0 01-2.631 4.31l-3.099-3.099a5.25 5.25 0 00-6.71-6.71L7.759 4.577a11.217 11.217 0 014.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113z"></path><path d="M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0115.75 12zM12.53 15.713l-4.243-4.244a3.75 3.75 0 004.243 4.243z"></path><path d="M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 00-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 016.75 12z"></path></svg>`),Pincode[FILENAME],[[148,6,[[154,7],[157,7],[160,7]]]]);var root_4=add_locations(from_svg(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-gray-500"><path d="M12 15a3 3 0 100-6 3 3 0 000 6z"></path><path fill-rule="evenodd" d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 010-1.113zM17.25 12a5.25 5.25 0 11-10.5 0 5.25 5.25 0 0110.5 0z" clip-rule="evenodd"></path></svg>`),Pincode[FILENAME],[[186,6,[[192,7],[193,7]]]]);var root_5=add_locations(from_svg(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-gray-500"><path d="M3.53 2.47a.75.75 0 00-1.06 1.06l18 18a.75.75 0 101.06-1.06l-18-18zM22.676 12.553a11.249 11.249 0 01-2.631 4.31l-3.099-3.099a5.25 5.25 0 00-6.71-6.71L7.759 4.577a11.217 11.217 0 014.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113z"></path><path d="M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0115.75 12zM12.53 15.713l-4.243-4.244a3.75 3.75 0 004.243 4.243z"></path><path d="M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 00-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 016.75 12z"></path></svg>`),Pincode[FILENAME],[[200,6,[[206,7],[209,7],[212,7]]]]);var root_1=add_locations(from_html(`<div class="p-6 text-primary-light dark:text-primary-dark"><p class="mb-4 text-secondary-light dark:text-secondary-dark">Please verify your current pincode and then enter your new pincode. Thank you.</p> <div class="relative mb-4"><input id="pincodeOriginal" type="password" inputmode="numeric" minlength="8" maxlength="8" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="CURRENT - 8 Digit Pin Code" autocomplete="off" required/> <button type="button" class="absolute top-1/2 right-3 transform -translate-y-1/2 focus:outline-none"><!></button></div> <div class="relative"><input id="pincodeNew" type="password" inputmode="numeric" minlength="8" maxlength="8" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="NEW - 8 Digit Pin Code" autocomplete="off" required/> <button type="button" class="absolute top-1/2 right-3 transform -translate-y-1/2 focus:outline-none"><!></button></div> <div class="mt-6 flex justify-end space-x-4"><button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Cancel</button> <button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Reset</button> <button type="button" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Change</button></div></div>`),Pincode[FILENAME],[[111,2,[[112,3],[115,3,[[116,4],[128,4]]],[167,3,[[168,4],[180,4]]],[219,3,[[220,4],[225,4],[230,4]]]]]]);var root=add_locations(from_html(`<div><!></div>`),Pincode[FILENAME],[[109,0]]);function Pincode($$anchor,$$props){check_target(new.target);push($$props,true,Pincode);var $$ownership_validator=create_ownership_validator($$props);const[$$stores,$$cleanup]=setup_stores();const $yakklMiscStore=()=>(validate_store(yakklMiscStore,"yakklMiscStore"),store_get(yakklMiscStore,"$yakklMiscStore",$$stores));let show=prop($$props,"show",15,false),className=prop($$props,"className",3,"z-[999]"),onVerified=prop($$props,"onVerified",3,()=>{});let pincodeOriginal=tag(state(""),"pincodeOriginal");let pincodeNew=tag(state(""),"pincodeNew");let eyeOpenOriginal=tag(state(false),"eyeOpenOriginal");let eyeOpenNew=tag(state(false),"eyeOpenNew");let currentlySelected;onMount(async()=>{currentlySelected=await getYakklCurrentlySelected();set(pincodeOriginal,"");set(pincodeNew,"");show(false)});async function handleChange(){var _a;try{if(get(pincodeOriginal).length<8||get(pincodeNew).length<8){alert("Please enter a valid pincode. 8 numbers. Don't enter the same number in all 8 digits.");return}if(strict_equals(get(pincodeOriginal),get(pincodeNew))){alert("Please enter a different pincode to update.");return}let profile=await getProfile();if(!profile){throw"No profile found"}if(isEncryptedData(profile.data)){await decryptData(profile.data,$yakklMiscStore()).then(result=>{profile.data=result})}const digestedOriginalPincode=await digestMessage(get(pincodeOriginal));if(isProfileData(profile.data)&&strict_equals((_a=profile.data)==null?void 0:_a.pincode,digestedOriginalPincode,false)){alert("Invalid current pincode");return}if(isProfileData(profile.data)){profile.data.pincode=await digestMessage(get(pincodeNew));await encryptData(profile.data,$yakklMiscStore()).then(result=>{profile.data=result})}currentlySelected.data.profile=await deepCopy(profile);await setYakklCurrentlySelectedStorage(currentlySelected);store_set(profileStore,await deepCopy(profile));setProfileStorage(profile);onVerified()(get(pincodeOriginal),get(pincodeNew));set(pincodeOriginal,"");set(pincodeNew,"");show(false)}catch(e){log.error(e)}}function closeModal(){set(pincodeOriginal,"");set(pincodeNew,"");show(false)}function toggleVisibility(id,type){try{const element=document.getElementById(id);if(strict_equals(element.type,"password")){element.type=type}else{element.type="password"}}catch(e){log.error(e)}}var div=root();var node=child(div);{$$ownership_validator.binding("show",Modal,show);Modal(node,{title:"Pincode Change",onClose:closeModal,get show(){return show()},set show($$value){show($$value)},children:wrap_snippet(Pincode,($$anchor2,$$slotProps)=>{var div_1=root_1();var div_2=sibling(child(div_1),2);var input=child(div_2);remove_input_defaults(input);var button=sibling(input,2);button.__click=[togglePinVisibilityOriginal,eyeOpenOriginal,toggleVisibility];var node_1=child(button);{var consequent=$$anchor3=>{var svg=root_2();append($$anchor3,svg)};var alternate=$$anchor3=>{var svg_1=root_3();append($$anchor3,svg_1)};if_block(node_1,$$render=>{if(get(eyeOpenOriginal))$$render(consequent);else $$render(alternate,false)})}reset(button);reset(div_2);var div_3=sibling(div_2,2);var input_1=child(div_3);remove_input_defaults(input_1);var button_1=sibling(input_1,2);button_1.__click=[togglePinVisibilityNew,eyeOpenNew,toggleVisibility];var node_2=child(button_1);{var consequent_1=$$anchor3=>{var svg_2=root_4();append($$anchor3,svg_2)};var alternate_1=$$anchor3=>{var svg_3=root_5();append($$anchor3,svg_3)};if_block(node_2,$$render=>{if(get(eyeOpenNew))$$render(consequent_1);else $$render(alternate_1,false)})}reset(button_1);reset(div_3);var div_4=sibling(div_3,2);var button_2=child(div_4);button_2.__click=closeModal;var button_3=sibling(button_2,2);button_3.__click=[resetForm,pincodeOriginal,pincodeNew];var button_4=sibling(button_3,2);button_4.__click=handleChange;reset(div_4);reset(div_1);bind_value(input,()=>get(pincodeOriginal),$$value=>set(pincodeOriginal,$$value));bind_value(input_1,()=>get(pincodeNew),$$value=>set(pincodeNew,$$value));append($$anchor2,div_1)}),$$slots:{default:true}})}reset(div);template_effect(()=>set_class(div,1,`relative ${className()??""}`));append($$anchor,div);var $$pop=pop({...legacy_api()});$$cleanup();return $$pop}delegate(["click"]);export{Pincode as P};
//# sourceMappingURL=6DEL-W02.js.map
